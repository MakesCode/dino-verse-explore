import{jsx as a,Fragment as ee,jsxs as d}from"react/jsx-runtime";import{c as P}from"react/compiler-runtime";import{c as Z,n as Ne,T as ye,m as be,r as te,L as Pe,u as z,_ as oe,Z as Ee,Q as Ie,e as ze,a as de,g as De,b as Re,d as me,h as ue,f as pe,p as he,v as Q,i as fe,z as Fe,F as Y,j as _e,k as $e,B as ve,C as ae,P as se,s as ne,S as ie,l as ke,o as Le}from"./ssr-_oDTT3uX.js";import{Plus as je,MoreHorizontal as Te,Search as ge,ChevronLeft as Me,ChevronRight as Oe,User as J,Building as W,Users as re,CheckCircle as qe,Home as Ge,AlertTriangle as Ve,Euro as Be}from"lucide-react";import{useState as Ue,useEffect as Ke,useMemo as Qe}from"react";import{useNavigate as le,useSearch as He}from"@tanstack/react-router";import{useDispatch as ce}from"react-redux";import{useQuery as B,useMutation as we,queryOptions as Ae,keepPreviousData as Ze}from"@tanstack/react-query";import{G as w}from"./RentalApproval-Bbii3zj-.js";import{createColumnHelper as Je,useReactTable as We,getCoreRowModel as Xe,flexRender as xe}from"@tanstack/react-table";import"@tanstack/react-query-devtools";import"clsx";import"react-dom";import"class-variance-authority";import"date-fns";import"date-fns/locale";import"@reduxjs/toolkit";import"h3";import"node:async_hooks";import"js-cookie";import"react-hook-form";import"framer-motion";import"@googlemaps/js-api-loader";import"zod";import"@tanstack/react-router-with-query";import"axios";import"node:stream";import"react-dom/server";import"node:stream/web";const Ye=Z("rentalApprovals/initUsecase",async(t,{dispatch:e,extra:s})=>{const{rentalApprovalApi:n}=s;try{return(await n.postInit({data:{},params:{subscriptionId:t.params.subscriptionId}})).payload}catch(i){throw e(Ne({typeMessage:ye.errorApi})),i}}),et=t=>be({mutationKey:["init"],mutationFn:async e=>await t?.(Ye(e)).unwrap()}),tt=()=>{const t=P(13),e=ce(),s=le();let n;t[0]!==e?(n=et(e),t[0]=e,t[1]=n):n=t[1];const i=n;let m;t[2]!==e?(m=te({data:{},params:{}},e),t[2]=e,t[3]=m):m=t[3];const r=m,{data:p}=B(r);let u;t[4]!==s||t[5]!==i?(u={...i,onSuccess(o,y,x){s({to:"/creategli/$ID_rentalapproval",params:{ID_rentalapproval:o.id}})}},t[4]=s,t[5]=i,t[6]=u):u=t[6];const c=we(u);let h;t[7]!==p?.id||t[8]!==c?(h=async()=>{await c.mutateAsync({data:{},params:{subscriptionId:p?.id}})},t[7]=p?.id,t[8]=c,t[9]=h):h=t[9];const f=h;let g;return t[10]!==f||t[11]!==c.isPending?(g={handleInit:f,isLoading:c.isPending},t[10]=f,t[11]=c.isPending,t[12]=g):g=t[12],g},at=()=>{const t=P(6),{handleInit:e,isLoading:s}=tt();let n;t[0]!==s?(n=s?a(Pe,{}):a(je,{className:"h-4 w-4 mr-2"}),t[0]=s,t[1]=n):n=t[1];let i;return t[2]!==e||t[3]!==s||t[4]!==n?(i=a(ee,{children:d(z,{size:"sm",onClick:e,disabled:s,children:[n,"Nouvelle demande"]})}),t[2]=e,t[3]=s,t[4]=n,t[5]=i):i=t[5],i},st=Z("rentalApprovals/retrieveRentalApprovalsUsecase",async({params:t},{dispatch:e,extra:s})=>{const{rentalApprovalApi:n}=s;try{return(await n.getRentalApprovals({data:{},params:t})).payload}catch(i){throw i}}),nt=(t,e)=>Ae({queryKey:["rentalApprovals","subscription",t.params.subscriptionId,t.params?.limite,t.params?.pageIndex,t.params?.search,t.params?.status,t.params?.groupe],queryFn:async()=>await e?.(st(t)).unwrap()}),it=(t,e)=>{const s=P(4),[n,i]=Ue(t);let m,r;return s[0]!==e||s[1]!==t?(m=()=>{const p=setTimeout(()=>{i(t)},e);return()=>{clearTimeout(p)}},r=[t,e],s[0]=e,s[1]=t,s[2]=m,s[3]=r):(m=s[2],r=s[3]),Ke(m,r),n};var H=(t=>(t[t.Ongoing=1]="Ongoing",t[t.Active=2]="Active",t[t.Archived=3]="Archived",t))(H||{});const rt=t=>{const e=P(43);let s;e[0]!==t?(s=t===void 0?{}:t,e[0]=t,e[1]=s):s=e[1];const{defaultPageSize:n}=s,i=n===void 0?10:n,m=le();let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r={strict:!1},e[2]=r):r=e[2];const p=He(r),u=p.q||"",c=p.p||0,h=p.l||i,f=p.st||1;let g;e[3]!==p.sst||e[4]!==u||e[5]!==c||e[6]!==h||e[7]!==f?(g={q:u,p:c,l:h,sst:p.sst,st:f},e[3]=p.sst,e[4]=u,e[5]=c,e[6]=h,e[7]=f,e[8]=g):g=e[8];const o=g,y=it(o.q||"",300);let x;e[9]!==o||e[10]!==m?(x=S=>{const Ce={...o,...S},Se=Object.entries(Ce).reduce(lt,{});m({search:Se,replace:!0})},e[9]=o,e[10]=m,e[11]=x):x=e[11];const v=x;let b;e[12]!==v?(b=S=>{v({q:S,p:0})},e[12]=v,e[13]=b):b=e[13];const A=b;let F;e[14]!==v?(F=S=>{v({sst:S,p:0})},e[14]=v,e[15]=F):F=e[15];const j=F;let _;e[16]!==v?(_=S=>{v({st:S,p:0})},e[16]=v,e[17]=_):_=e[17];const T=_;let $;e[18]!==v?($=S=>{v({p:S})},e[18]=v,e[19]=$):$=e[19];const M=$;let D;e[20]!==v?(D=S=>{v({l:S,p:0})},e[20]=v,e[21]=D):D=e[21];const k=D;let R;e[22]!==m?(R=()=>{m({search:{},replace:!0})},e[22]=m,e[23]=R):R=e[23];const L=R,C=o.p||0,E=o.q||"",U=C>0&&E===y;let O;const q=U?E:y,G=o.l||i;let l;e[24]!==C||e[25]!==o.sst||e[26]!==o.st||e[27]!==q||e[28]!==G?(l={search:q,pageIndex:C,limite:G,status:o.sst,groupe:o.st},e[24]=C,e[25]=o.sst,e[26]=o.st,e[27]=q,e[28]=G,e[29]=l):l=e[29],O=l;const N=O,X=o.l||i;let K;return e[30]!==N||e[31]!==C||e[32]!==y||e[33]!==o||e[34]!==L||e[35]!==E||e[36]!==T||e[37]!==M||e[38]!==k||e[39]!==A||e[40]!==j||e[41]!==X?(K={filters:o,search:E,status:o.sst,groupe:o.st,pageIndex:C,pageSize:X,debouncedSearch:y,setSearch:A,setStatus:j,setGroupe:T,setPageIndex:M,setPageSize:k,resetFilters:L,apiParams:N},e[30]=N,e[31]=C,e[32]=y,e[33]=o,e[34]=L,e[35]=E,e[36]=T,e[37]=M,e[38]=k,e[39]=A,e[40]=j,e[41]=X,e[42]=K):K=e[42],K};function lt(t,e){const[s,n]=e;return n!=null&&n!==""&&(t[s]=n),t}const ct=Z("rentalapprovals/archiveProjectUsecase",async(t,{dispatch:e,extra:s})=>{const{rentalApprovalApi:n,queryClient:i}=s;try{await n.postArchiveProject(t),i.invalidateQueries({queryKey:["rentalApprovals","subscription",t.params.subscriptionId],exact:!1});return}catch(m){throw e(Ne({typeMessage:ye.errorApi})),m}}),ot=t=>be({mutationKey:["archiveProject"],mutationFn:async e=>await t?.(ct(e)).unwrap()}),dt=t=>{switch(t){case w.Initialized:return{text:"Initialisé",variant:"gray"};case w.Draft:return{text:"En cours",variant:"outline"};case w.PendingDocument:return{text:"Document en attente",variant:"yellow"};case w.Pending:return{text:"En attente",variant:"blue"};case w.Approved:return{text:"Approuvé",variant:"green"};case w.Rejected:return{text:"Rejeté",variant:"red"};case w.Cancelled:return{text:"Annulé",variant:"faintred"};case w.Active:return{text:"Actif",variant:"forest"};case w.FinishedScheduled:return{text:"Fin programmée",variant:"peach"};case w.Finished:return{text:"Terminé",variant:"ocean"};default:return{text:"Inconnu",variant:"default"}}},I=Je(),mt=[{label:"Tous",value:void 0},{label:"En cours",value:w.Draft},{label:"Document en attente",value:w.PendingDocument},{label:"En attente",value:w.Pending},{label:"Approuvé",value:w.Approved},{label:"Rejeté",value:w.Rejected},{label:"Annulé",value:w.Cancelled},{label:"Actif",value:w.Active},{label:"Fin programmée",value:w.FinishedScheduled},{label:"Terminé",value:w.Finished}],ut=t=>{const e=P(7),{address:s}=t,n=s?.length>50?s.substring(0,50)+"...":s;let i;e[0]!==n?(i=a(ae,{asChild:!0,children:a("div",{className:"max-w-xs cursor-help",children:a("div",{className:"text-sm text-gray-900 font-medium truncate",children:n})})}),e[0]=n,e[1]=i):i=e[1];let m;e[2]!==s?(m=a(se,{side:"top",className:"max-w-sm p-3",children:a("div",{className:"text-sm whitespace-pre-wrap",children:s})}),e[2]=s,e[3]=m):m=e[3];let r;return e[4]!==i||e[5]!==m?(r=a(ne,{children:d(ie,{children:[i,m]})}),e[4]=i,e[5]=m,e[6]=r):r=e[6],r},pt=t=>{const e=P(27),{owners:s}=t;if(!s||s?.length===0){let A;return e[0]===Symbol.for("react.memo_cache_sentinel")?(A=a("span",{className:"text-gray-400",children:"-"}),e[0]=A):A=e[0],A}const n=s?.[0],i=s?.length-1,m=vt;let r;e[1]!==n.naturalEntity?(r=n.naturalEntity?a(J,{className:"h-3 w-3 text-blue-500 flex-shrink-0"}):a(W,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),e[1]=n.naturalEntity,e[2]=r):r=e[2];let p;e[3]!==n?(p=m(n),e[3]=n,e[4]=p):p=e[4];let u;e[5]!==p?(u=a("div",{className:"truncate text-sm font-medium",children:p}),e[5]=p,e[6]=u):u=e[6];let c;e[7]!==i?(c=i>0&&d("div",{className:"flex items-center gap-1 mt-0.5",children:[a(re,{className:"h-3 w-3 text-gray-400"}),d("span",{className:"text-xs text-gray-500",children:["+",i," autre",i>1?"s":""]})]}),e[7]=i,e[8]=c):c=e[8];let h;e[9]!==u||e[10]!==c?(h=d("div",{className:"min-w-0 flex-1",children:[u,c]}),e[9]=u,e[10]=c,e[11]=h):h=e[11];let f;e[12]!==r||e[13]!==h?(f=a(ae,{asChild:!0,children:d("div",{className:"flex items-center gap-2 cursor-help max-w-[200px]",children:[r,h]})}),e[12]=r,e[13]=h,e[14]=f):f=e[14];const g=s?.length>1?"s":"";let o;e[15]!==g?(o=d("div",{className:"font-medium mb-2",children:["Propriétaire",g]}),e[15]=g,e[16]=o):o=e[16];let y;e[17]!==s?(y=s?.map(gt),e[17]=s,e[18]=y):y=e[18];let x;e[19]!==y?(x=a("div",{className:"space-y-2 max-w-sm",children:y}),e[19]=y,e[20]=x):x=e[20];let v;e[21]!==x||e[22]!==o?(v=a(se,{side:"right",className:"p-3",children:d("div",{children:[o,x]})}),e[21]=x,e[22]=o,e[23]=v):v=e[23];let b;return e[24]!==v||e[25]!==f?(b=a(ne,{children:d(ie,{children:[f,v]})}),e[24]=v,e[25]=f,e[26]=b):b=e[26],b},ht=t=>{const e=P(27),{tenants:s}=t;if(!s||s?.length===0){let A;return e[0]===Symbol.for("react.memo_cache_sentinel")?(A=a("span",{}),e[0]=A):A=e[0],A}const n=s?.[0],i=s?.length-1,m=xt;let r;e[1]!==n.tenant?.naturalEntity?(r=n.tenant?.naturalEntity?a(J,{className:"h-3 w-3 text-purple-500 flex-shrink-0"}):a(W,{className:"h-3 w-3 text-orange-500 flex-shrink-0"}),e[1]=n.tenant?.naturalEntity,e[2]=r):r=e[2];let p;e[3]!==n?(p=m(n),e[3]=n,e[4]=p):p=e[4];let u;e[5]!==p?(u=a("div",{className:"truncate text-sm font-medium",children:p}),e[5]=p,e[6]=u):u=e[6];let c;e[7]!==i?(c=i>0&&d("div",{className:"flex items-center gap-1 mt-0.5",children:[a(re,{className:"h-3 w-3 text-gray-400"}),d("span",{className:"text-xs text-gray-500",children:["+",i," autre",i>1?"s":""]})]}),e[7]=i,e[8]=c):c=e[8];let h;e[9]!==u||e[10]!==c?(h=d("div",{className:"min-w-0 flex-1",children:[u,c]}),e[9]=u,e[10]=c,e[11]=h):h=e[11];let f;e[12]!==r||e[13]!==h?(f=a(ae,{asChild:!0,children:d("div",{className:"flex items-center gap-2 cursor-help max-w-[200px]",children:[r,h]})}),e[12]=r,e[13]=h,e[14]=f):f=e[14];const g=s?.length>1?"s":"";let o;e[15]!==g?(o=d("div",{className:"font-medium mb-2",children:["Locataire",g]}),e[15]=g,e[16]=o):o=e[16];let y;e[17]!==s?(y=s?.map(Nt),e[17]=s,e[18]=y):y=e[18];let x;e[19]!==y?(x=a("div",{className:"space-y-2 max-w-sm",children:y}),e[19]=y,e[20]=x):x=e[20];let v;e[21]!==x||e[22]!==o?(v=a(se,{side:"right",className:"p-3",children:d("div",{children:[o,x]})}),e[21]=x,e[22]=o,e[23]=v):v=e[23];let b;return e[24]!==v||e[25]!==f?(b=a(ne,{children:d(ie,{children:[f,v]})}),e[24]=v,e[25]=f,e[26]=b):b=e[26],b},ft=()=>{const t=le(),e=ce(),{search:s,status:n,pageIndex:i,pageSize:m,groupe:r,setSearch:p,setStatus:u,setPageIndex:c,setPageSize:h,resetFilters:f,setGroupe:g,apiParams:o}=rt({defaultPageSize:10}),y=te({data:{},params:{}},e),{data:x,isLoading:v}=B(y),b=nt({data:{},params:{subscriptionId:x?.id||"",...o}},e),{data:A,isLoading:F,isFetching:j,isError:_}=B({...b,enabled:!!x?.id,placeholderData:Ze}),T=ot(e),$=we(T),M=async l=>{await $.mutateAsync({data:{},params:{rentalApprovalId:l,subscriptionId:x?.id||""}})},D=Qe(()=>[I.accessor("references.rentalApprovalRef",{id:"rentalApprovalRef",header:"Référence",cell:({getValue:l})=>{const N=l();return a("span",{className:"text-sm ",children:N||"-"})},enableSorting:!1,size:140}),I.accessor("owners",{id:"owners",header:"Propriétaire(s)",cell:({getValue:l})=>{const N=l();return a(pt,{owners:N})},enableSorting:!1,size:200}),I.accessor("tenants",{id:"tenants",header:"Locataire(s)",cell:({getValue:l})=>{const N=l();return a(ht,{tenants:N})},enableSorting:!1,size:200}),I.accessor("realEstateLot.address.fullAddress",{id:"address",header:"Adresse du lot",cell:({getValue:l})=>a(ut,{address:l()}),enableSorting:!1,size:220}),I.accessor("createDate",{id:"createDate",header:"Date de demande",cell:({getValue:l})=>a("span",{className:"text-sm",children:new Date(l()).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),enableSorting:!1,size:150}),I.accessor("businessData.rentAmount",{id:"rentAmount",header:"Loyer CC",cell:({getValue:l})=>{const N=l();return a("span",{className:"font-medium",children:N?`${N.toFixed(2)} €`:""})},enableSorting:!1,size:120}),I.accessor("status",{id:"status",header:"Statut de la demande",cell:({getValue:l})=>{const N=dt(l());return a("div",{className:"text-center",children:a(oe,{variant:N.variant,children:N.text})})},enableSorting:!1,size:150}),I.display({id:"actions",header:"Actions",cell:({row:l})=>a("div",{className:"text-center",children:d(Ee,{children:[a(Ie,{asChild:!0,children:a(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a(Te,{className:"h-4 w-4"})})}),d(ze,{align:"end",children:[a(de,{onClick:N=>{N.stopPropagation(),t({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:l.original.id}})},children:"Voir détails"}),a(De,{}),a(de,{className:"",onClick:async N=>{N.stopPropagation(),await M(l.original.id)},children:l.original.isArchived?"Désarchiver":"Archivé"})]})]})}),size:80})],[t]),k=We({data:A?.data??[],columns:D,manualPagination:!0,manualSorting:!0,manualFiltering:!0,getCoreRowModel:Xe()}),R=v||F,L=A&&A?.data?.length>0,C=A?.rowCount||0,E=Math.ceil(C/m),U=i<E-1,O=i>0,q=i*m+1,G=Math.min((i+1)*m,C);return d("div",{className:" w-full",children:[a("div",{className:"border-b",children:a("div",{className:" px-6 py-6",children:d("div",{className:"flex items-center justify-between",children:[d("div",{children:[a("h1",{className:"text-2xl font-semibold text-foreground",children:"Garanties GLI"}),a("p",{className:"text-sm text-muted-foreground mt-1",children:"Gérez vos demandes de GLI"})]}),a("div",{className:"flex items-center gap-3",children:a(at,{})})]})})}),d("div",{className:"  px-6 py-6",children:[a("div",{className:"flex items-center gap-1 mb-6",children:[{id:"1",label:"En cours",count:7,value:H.Ongoing},{id:"2",label:"Actives",count:12,value:H.Active},{id:"3",label:"Archivées",count:45,value:H.Archived}].map(l=>d(z,{variant:r===l.value?"default":"ghost",size:"sm",onClick:()=>g(l.value),className:"justify-start",children:[l.label,a(oe,{variant:"ocean",className:"ml-2",children:l.count})]},l.id))}),d("div",{className:"flex items-center justify-between mb-6",children:[d("div",{className:"flex items-center gap-3",children:[d("div",{className:"relative",children:[a(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a(Re,{placeholder:"Rechercher...",className:"pl-9 w-80",value:s,onChange:l=>p(l.target.value)})]}),d(me,{value:n?.toString()||"all",onValueChange:l=>u(l==="all"?void 0:Number(l)),children:[a(ue,{className:"w-48",children:a(pe,{placeholder:"Statut"})}),a(he,{children:mt.map(l=>a(Q,{value:l.value?.toString()||"all",children:l.label},l.value?.toString()||"all"))})]}),d(me,{value:m.toString(),onValueChange:l=>h(Number(l)),children:[a(ue,{className:"w-32",children:a(pe,{})}),d(he,{children:[a(Q,{value:"10",children:"10 par page"}),a(Q,{value:"25",children:"25 par page"}),a(Q,{value:"50",children:"50 par page"})]})]}),(s||n)&&a(z,{variant:"outline",size:"sm",onClick:f,children:"Réinitialiser"})]}),L&&d("div",{className:"text-sm text-muted-foreground",children:[q,"-",G," sur ",C," résultats"]})]}),R?a("div",{className:"text-center py-12",children:a("p",{children:"Chargement..."})}):_?a("div",{className:"text-center py-12",children:a("p",{className:"text-red-600",children:"Erreur lors du chargement des données"})}):d(ee,{children:[d("div",{className:"relative shadow-[0_0.7px_0_0_rgba(0,0,0,0.1)] shadow-bottom-only rounded-md",children:[j&&!R&&a("div",{className:"absolute top-0 left-0 right-0 z-20",children:a("div",{className:"h-1 bg-gradient-to-r from-primary via-accent to-primary animate-pulse",children:a("div",{className:"h-full bg-gradient-to-r from-transparent via-background to-transparent opacity-30"})})}),d("div",{className:"overflow-x-auto",children:[a(fe,{className:"table-no-hover table-fixed",children:a(Fe,{className:"bg-primary/10 table-header-no-hover",children:k.getHeaderGroups().map(l=>a(Y,{children:l.headers.map(N=>a(_e,{className:"font-medium",style:{width:`${N.getSize()}px`},children:N.isPlaceholder?null:xe(N.column.columnDef.header,N.getContext())},N.id))},l.id))})}),a("div",{className:"max-h-[300px] 2xl:max-h-[500px] 3xl:max-h-[900px] overflow-y-auto",children:a(fe,{className:"table-no-hover table-fixed",children:a($e,{children:L?k.getRowModel().rows.map(l=>a(Y,{className:"cursor-pointer",onClick:()=>{t({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:l.original.id}})},children:l.getVisibleCells().map(N=>a(ve,{style:{width:`${N.column.getSize()}px`},className:"overflow-hidden",children:xe(N.column.columnDef.cell,N.getContext())},N.id))},l.id)):a(Y,{className:"hover:bg-transparent",children:a(ve,{colSpan:D.length,className:"h-24 text-center",children:a("div",{className:"w-full",children:d("div",{className:"text-center py-12",children:[a("div",{className:"w-12 h-12 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:a(ge,{className:"h-6 w-6 text-muted-foreground"})}),a("h3",{className:"font-medium mb-1",children:"Aucun résultat"}),a("p",{className:"text-sm text-muted-foreground",children:s||n?"Aucune garantie GLI ne correspond à vos critères":"Aucune garantie GLI trouvée"})]})})})})})})})]})]}),d("div",{className:"flex items-center justify-between mt-6",children:[a("div",{className:"text-sm text-muted-foreground",children:C>0?d(ee,{children:["Page ",i+1," sur ",Math.max(1,E)," - ",C," résultat",C>1?"s":""]}):"Aucun résultat"}),d("div",{className:"flex items-center gap-2",children:[a(z,{variant:"outline",size:"sm",onClick:()=>c(0),disabled:!O||C===0,children:"Premier"}),d(z,{variant:"outline",size:"sm",onClick:()=>c(i-1),disabled:!O||C===0,children:[a(Me,{className:"h-4 w-4"}),"Précédent"]}),d(z,{variant:"outline",size:"sm",onClick:()=>c(i+1),disabled:!U||C===0,children:["Suivant",a(Oe,{className:"h-4 w-4"})]}),a(z,{variant:"outline",size:"sm",onClick:()=>c(Math.max(0,E-1)),disabled:!U||C===0,children:"Dernier"})]})]})]})]})]})};function vt(t){return t.naturalEntity?`${t.naturalEntity.firstName} ${t.naturalEntity.lastName}`:t.legalEntity?t.legalEntity.name:"Propriétaire inconnu"}function gt(t,e){return d("div",{className:"flex items-center gap-2",children:[t.naturalEntity?a(J,{className:"h-3 w-3"}):a(W,{className:"h-3 w-3"}),a("span",{className:"text-sm",children:t.naturalEntity?`${t.naturalEntity.firstName} ${t.naturalEntity.lastName}`:t.legalEntity?.name||"Inconnu"})]},t.id)}function xt(t){return t.tenant?.naturalEntity?`${t.tenant.naturalEntity.firstName} ${t.tenant.naturalEntity.lastName}`:t.tenant?.legalEntity?t.tenant.legalEntity.name:"Locataire inconnu"}function Nt(t,e){return d("div",{className:"flex items-center gap-2",children:[t.tenant?.naturalEntity?a(J,{className:"h-3 w-3"}):a(W,{className:"h-3 w-3"}),a("span",{className:"text-sm",children:t.tenant?.naturalEntity?`${t.tenant.naturalEntity.firstName} ${t.tenant.naturalEntity.lastName}`:t.tenant?.legalEntity?.name||"Inconnu"})]},t.id)}const yt=Z("subscriptions/retrieveKpiUsecase",async(t,{dispatch:e,extra:s})=>{const{subscriptionApi:n}=s;try{return(await n.getKpi(t)).payload}catch(i){throw i}}),bt=(t,e)=>Ae({queryKey:["kpi"],queryFn:async()=>await e?.(yt(t)).unwrap(),enabled:!!t.params.subscriptionId});function wt(t){const e=P(21),{stats:s}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=a(re,{size:16,className:"text-[#8B5CF6]"}),e[0]=n):n=e[0];let i;e[1]!==s.totalCandidates?(i=a(V,{icon:n,value:s.totalCandidates,title:"Total candidats",color:"#8B5CF6"}),e[1]=s.totalCandidates,e[2]=i):i=e[2];let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=a(qe,{size:16,className:"text-[#3B82F6]"}),e[3]=m):m=e[3];let r;e[4]!==s.validatedFiles?(r=a(V,{icon:m,value:s.validatedFiles,title:"Dossiers validés",color:"#3B82F6"}),e[4]=s.validatedFiles,e[5]=r):r=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=a(Ge,{size:16,className:"text-[#10B981]"}),e[6]=p):p=e[6];let u;e[7]!==s.guaranteedTenants?(u=a(V,{icon:p,value:s.guaranteedTenants,title:"Locataires garantis",color:"#10B981"}),e[7]=s.guaranteedTenants,e[8]=u):u=e[8];let c;e[9]===Symbol.for("react.memo_cache_sentinel")?(c=a(Ve,{size:16,className:"text-[#EF4444]"}),e[9]=c):c=e[9];let h;e[10]!==s.openClaims?(h=a(V,{icon:c,value:s.openClaims,title:"Sinistres ouverts",color:"#EF4444"}),e[10]=s.openClaims,e[11]=h):h=e[11];let f;e[12]===Symbol.for("react.memo_cache_sentinel")?(f=a(Be,{size:16,className:"text-[#F59E0B]"}),e[12]=f):f=e[12];let g;e[13]!==s.averageRent?(g=a(V,{icon:f,value:s.averageRent,title:"Loyer moyen garanti (€)",color:"#F59E0B"}),e[13]=s.averageRent,e[14]=g):g=e[14];let o;return e[15]!==g||e[16]!==i||e[17]!==r||e[18]!==u||e[19]!==h?(o=a("div",{className:"p-4 bg-white",children:d("div",{className:"flex flex-wrap gap-3",children:[i,r,u,h,g]})}),e[15]=g,e[16]=i,e[17]=r,e[18]=u,e[19]=h,e[20]=o):o=e[20],o}function V(t){const e=P(15),{icon:s,value:n,title:i,color:m}=t,r=`${m}10`;let p;e[0]!==r?(p={backgroundColor:r},e[0]=r,e[1]=p):p=e[1];let u;e[2]!==s||e[3]!==p?(u=a("div",{style:p,className:"p-2 rounded-md",children:s}),e[2]=s,e[3]=p,e[4]=u):u=e[4];let c;e[5]!==n?(c=a("div",{className:"text-xl font-semibold text-gray-800",children:n}),e[5]=n,e[6]=c):c=e[6];let h;e[7]!==i?(h=a("div",{className:"text-xs text-gray-500",children:i}),e[7]=i,e[8]=h):h=e[8];let f;e[9]!==c||e[10]!==h?(f=d("div",{children:[c,h]}),e[9]=c,e[10]=h,e[11]=f):f=e[11];let g;return e[12]!==u||e[13]!==f?(g=a("div",{className:"flex-1 min-w-[150px] bg-white border border-gray-100 rounded-md shadow-sm p-3",children:d("div",{className:"flex items-center space-x-3",children:[u,f]})}),e[12]=u,e[13]=f,e[14]=g):g=e[14],g}const Xt=function(){const e=P(15),s=ce();let n;e[0]!==s?(n=te({data:{},params:{}},s),e[0]=s,e[1]=n):n=e[1];const i=n,{data:m}=B(i);let r;e[2]!==m?.id||e[3]!==s?(r=bt({data:{},params:{subscriptionId:m?.id}},s),e[2]=m?.id,e[3]=s,e[4]=r):r=e[4];const p=r,{data:u}=B(p);let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=a(ke,{}),e[5]=c):c=e[5];const h=u?.averageGuaranteedRentAmount??0,f=u?.activeRentalApprovalCount??0,g=u?.claimCount??0,o=u?.rentalApprovalCount??0,y=u?.approvedRentalApprovalCount??0;let x;e[6]!==h||e[7]!==f||e[8]!==g||e[9]!==o||e[10]!==y?(x=a("div",{className:"",children:a(wt,{stats:{averageRent:h,guaranteedTenants:f,openClaims:g,totalCandidates:o,validatedFiles:y}})}),e[6]=h,e[7]=f,e[8]=g,e[9]=o,e[10]=y,e[11]=x):x=e[11];let v;e[12]===Symbol.for("react.memo_cache_sentinel")?(v=a("div",{className:"w-full",children:a(ft,{})}),e[12]=v):v=e[12];let b;return e[13]!==x?(b=d(Le,{children:[c,a("div",{className:"flex flex-1 flex-col",children:d("div",{className:"@container/main flex flex-1 flex-col gap-2",children:[x,v]})})]}),e[13]=x,e[14]=b):b=e[14],b};export{Xt as component,wt as default};
