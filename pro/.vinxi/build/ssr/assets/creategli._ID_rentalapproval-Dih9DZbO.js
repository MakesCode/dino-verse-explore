import{jsx as r,jsxs as p,Fragment as Fe}from"react/jsx-runtime";import{c as B}from"react/compiler-runtime";import{useNavigate as ua}from"@tanstack/react-router";import{c as me,n as we,T as De,m as be,a5 as It,b as pa,u as Y,N as st,O as T,R as lt,U as xt,q as yt,Y as St,a6 as Ut,H as Ct,K as gt,r as He,a7 as ma,g as Lt,a8 as fa,a9 as ha,aa as kt,_ as ot,$ as ya,W as ga,X as va,a0 as ba,a1 as Na,a3 as wa,a2 as Da,a4 as Ia,ab as Jt,ac as wt,ad as Aa,ae as zt,af as $t,ag as Qt,ah as Vt,ai as $e,aj as Bt,l as xa,o as Sa,ak as Ca,al as Ea,am as Fa,an as Ra,ao as Ma,ap as Ta,aq as Pa,L as Oa}from"./ssr-_oDTT3uX.js";import mt,{useState as Ee,useRef as qa,useEffect as At,useCallback as Ft}from"react";import{Search as Ua,Loader2 as La,X as ka,Pencil as _t,Phone as ft,Mail as ht,User as rt,Building2 as Gt,Trash as Kt,Calendar as _a,Plus as ea,Home as Se,Key as Ce,Shield as ta,UserPlus as Ga,PaperclipIcon as Rt,UploadIcon as Ht,XIcon as Xt}from"lucide-react";import{useDispatch as Xe}from"react-redux";import{queryOptions as aa,useMutation as ve,useQuery as he,useQueryClient as Et,useIsMutating as Dt}from"@tanstack/react-query";import{a as ct,r as dt,b as Ka,D as Be,A as na,c as ja,u as ra,G as ut}from"./useMergeDocuments-DajAzfUt.js";import{motion as Pt,AnimatePresence as Ot}from"framer-motion";import{z as N}from"zod";import{c as sa,P as k,a as Ne,b as nt,d as Mt,R as pt,G as Tt}from"./RentalApproval-Bbii3zj-.js";import{createAction as za}from"@reduxjs/toolkit";import"@tanstack/react-query-devtools";import"clsx";import"react-dom";import"class-variance-authority";import"date-fns";import"date-fns/locale";import"h3";import"node:async_hooks";import"js-cookie";import"@tanstack/react-table";import"react-hook-form";import"@googlemaps/js-api-loader";import"@tanstack/react-router-with-query";import"axios";import"node:stream";import"react-dom/server";import"node:stream/web";const $a=me("rentalApprovals/registerOwnersUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.putOwners(a)).payload}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),la=a=>be({mutationKey:["registerOwner"],mutationFn:async e=>await a?.($a(e)).unwrap()});var je=(a=>(a[a.Natural=1]="Natural",a[a.Legal=2]="Legal",a))(je||{});function Qa(a,e){const t=B(4),[n,s]=Ee(a);let c,o;return t[0]!==e||t[1]!==a?(c=()=>{const i=setTimeout(()=>{s(a)},e);return()=>{clearTimeout(i)}},o=[a,e],t[0]=e,t[1]=a,t[2]=c,t[3]=o):(c=t[2],o=t[3]),At(c,o),n}function Va(a,e){const t=B(4);let n,s;t[0]!==e||t[1]!==a?(n=()=>{const c=o=>{!a.current||a.current.contains(o.target)||e()};return document.addEventListener("mousedown",c),document.addEventListener("touchstart",c),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("touchstart",c)}},s=[a,e],t[0]=e,t[1]=a,t[2]=n,t[3]=s):(n=t[2],s=t[3]),At(n,s)}const Ba=mt.forwardRef((a,e)=>{const t=B(78);let n,s,c,o,i,u,l,d,f,h,m,b,D,g,x;t[0]!==a?({className:s,value:m,onChange:i,onDebouncedChange:l,debounceDelay:b,loading:D,onClear:u,clearable:g,children:n,dropdownClassName:c,showDropdown:x,onDropdownChange:d,onFocus:f,onBlur:o,...h}=a,t[0]=a,t[1]=n,t[2]=s,t[3]=c,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=d,t[9]=f,t[10]=h,t[11]=m,t[12]=b,t[13]=D,t[14]=g,t[15]=x):(n=t[1],s=t[2],c=t[3],o=t[4],i=t[5],u=t[6],l=t[7],d=t[8],f=t[9],h=t[10],m=t[11],b=t[12],D=t[13],g=t[14],x=t[15]);const I=m===void 0?"":m,S=b===void 0?300:b,C=D===void 0?!1:D,F=g===void 0?!0:g,v=x===void 0?!1:x,[y,P]=Ee(I),[O,R]=Ee(!1),U=qa(null),A=Qa(y,S);let M;t[16]!==y||t[17]!==I?(M=()=>{I!==y&&P(I)},t[16]=y,t[17]=I,t[18]=M):M=t[18];let L;t[19]!==I?(L=[I],t[19]=I,t[20]=L):L=t[20],At(M,L);let K;t[21]!==A||t[22]!==l||t[23]!==I?(K=()=>{l&&A!==I&&l(A)},t[21]=A,t[22]=l,t[23]=I,t[24]=K):K=t[24];let z;t[25]!==A||t[26]!==l?(z=[A,l],t[25]=A,t[26]=l,t[27]=z):z=t[27],At(K,z);const Q=d?v:O;let $;t[28]!==d?($=()=>{d?d(!1):R(!1)},t[28]=d,t[29]=$):$=t[29],Va(U,$);let _;t[30]!==n||t[31]!==i||t[32]!==d?(_=ce=>{const fe=ce.target.value;P(fe),i?.(fe),n&&fe.length>0&&(d?d(!0):R(!0))},t[30]=n,t[31]=i,t[32]=d,t[33]=_):_=t[33];const E=_;let q;t[34]!==n||t[35]!==y||t[36]!==d||t[37]!==f?(q=ce=>{n&&y.length>0&&(d?d(!0):R(!0)),f?.(ce)},t[34]=n,t[35]=y,t[36]=d,t[37]=f,t[38]=q):q=t[38];const J=q;let ee;t[39]!==o?(ee=ce=>{o?.(ce)},t[39]=o,t[40]=ee):ee=t[40];const H=ee;let V;t[41]!==i||t[42]!==u||t[43]!==d?(V=()=>{P(""),i?.(""),u?.(),d?d(!1):R(!1)},t[41]=i,t[42]=u,t[43]=d,t[44]=V):V=t[44];const X=V,le=F&&y.length>0&&!C;let ye;t[45]===Symbol.for("react.memo_cache_sentinel")?(ye=r(Ua,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t[45]=ye):ye=t[45];const G=le&&"pr-9",re=C&&"pr-9";let de;t[46]!==s||t[47]!==G||t[48]!==re?(de=It("pl-9",G,re,s),t[46]=s,t[47]=G,t[48]=re,t[49]=de):de=t[49];let Z;t[50]!==H||t[51]!==J||t[52]!==E||t[53]!==y||t[54]!==h||t[55]!==e||t[56]!==de?(Z=r(pa,{ref:e,className:de,value:y,onChange:E,onFocus:J,onBlur:H,...h}),t[50]=H,t[51]=J,t[52]=E,t[53]=y,t[54]=h,t[55]=e,t[56]=de,t[57]=Z):Z=t[57];let ue;t[58]!==C?(ue=C&&r(La,{className:"h-4 w-4 animate-spin text-muted-foreground"}),t[58]=C,t[59]=ue):ue=t[59];let pe;t[60]!==X||t[61]!==le?(pe=le&&r(Y,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:X,children:r(ka,{className:"h-3 w-3"})}),t[60]=X,t[61]=le,t[62]=pe):pe=t[62];let ie;t[63]!==ue||t[64]!==pe?(ie=p("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[ue,pe]}),t[63]=ue,t[64]=pe,t[65]=ie):ie=t[65];let se;t[66]!==Z||t[67]!==ie?(se=p("div",{className:"relative",children:[ye,Z,ie]}),t[66]=Z,t[67]=ie,t[68]=se):se=t[68];let te;t[69]!==n||t[70]!==c||t[71]!==Q?(te=Q&&n&&r(Pt.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.1},className:It("absolute top-full z-50 mt-1 w-full rounded-md border bg-popover p-0 text-popover-foreground shadow-md outline-none",c),children:n}),t[69]=n,t[70]=c,t[71]=Q,t[72]=te):te=t[72];let ae;t[73]!==te?(ae=r(Ot,{children:te}),t[73]=te,t[74]=ae):ae=t[74];let oe;return t[75]!==se||t[76]!==ae?(oe=p("div",{ref:U,className:"relative w-full",children:[se,ae]}),t[75]=se,t[76]=ae,t[77]=oe):oe=t[77],oe}),Ha=a=>{const e=B(11),{data:t,onDataChange:n,id:s,onOpenChange:c,openModal:o}=a;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new st(N.object({name:N.string().superRefine(T({label:"Nom de la compagny",inputProps:{required:!1}})),email:N.string().email("Format e-mail invalide").superRefine(T({label:"Adresse e-mail",inputProps:{required:!1}})),phone:N.object({phoneNumber:N.string().min(6,"Numéro requis"),countryCode:N.string().min(1,"Pays requis")}).superRefine(T({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}}))})),e[0]=i):i=e[0];let u;e[1]!==n?(u=f=>{n(f)},e[1]=n,e[2]=u):u=e[2];let l;e[3]!==t||e[4]!==s||e[5]!==u?(l=r(lt,{schema:i,onSubmit:u,withSubmit:!0,defaultValues:t,id:s}),e[3]=t,e[4]=s,e[5]=u,e[6]=l):l=e[6];let d;return e[7]!==c||e[8]!==o||e[9]!==l?(d=r(xt,{open:o,onOpenChange:c,title:"Ajouter une personne morale",mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",content:l}),e[7]=c,e[8]=o,e[9]=l,e[10]=d):d=e[10],d},Xa=a=>{const e=B(11),{data:t,onDataChange:n,id:s,onOpenChange:c,openModal:o}=a;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new st(N.object({firstName:N.string().superRefine(T({label:"Prenom",inputProps:{required:!1}})),lastName:N.string().superRefine(T({label:"Nom",inputProps:{required:!1}})),email:N.string().email("Format e-mail invalide").superRefine(T({label:"Adresse e-mail",inputProps:{required:!1}})),phone:N.object({phoneNumber:N.string().min(6,"Numéro requis"),countryCode:N.string().min(1,"Pays requis")}).superRefine(T({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}}))})),e[0]=i):i=e[0];let u;e[1]!==n?(u=f=>{n(f)},e[1]=n,e[2]=u):u=e[2];let l;e[3]!==t||e[4]!==s||e[5]!==u?(l=r(lt,{schema:i,withSubmit:!0,onSubmit:u,defaultValues:t,id:s}),e[3]=t,e[4]=s,e[5]=u,e[6]=l):l=e[6];let d;return e[7]!==c||e[8]!==o||e[9]!==l?(d=r(xt,{open:o,onOpenChange:c,title:"Ajouter un propriétaire",mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",content:l}),e[7]=c,e[8]=o,e[9]=l,e[10]=d):d=e[10],d},Ya=a=>{const e=B(29),{owner:t,onRemove:n,onChange:s}=a,c=t.type===je.Natural,o=t.naturalEntity,i=t.legalEntity;let u;e[0]!==c?(u=c?r(rt,{className:"h-4 w-4 text-primary"}):r(Gt,{className:"h-5 w-5 text-primary"}),e[0]=c,e[1]=u):u=e[1];const l=c?`${o?.firstName??""} ${o?.lastName??""}`:i?.name??"Entité légale";let d;e[2]!==u||e[3]!==l?(d=p(St,{className:"flex items-center gap-2 text-base font-medium",children:[u,l]}),e[2]=u,e[3]=l,e[4]=d):d=e[4];const f=c?o?.externalId:i?.externalId;let h;e[5]!==f?(h=p(Ut,{className:"text-xs",children:["ID: ",f]}),e[5]=f,e[6]=h):h=e[6];let m;e[7]!==d||e[8]!==h?(m=p("div",{children:[d,h]}),e[7]=d,e[8]=h,e[9]=m):m=e[9];let b;e[10]!==s||e[11]!==t.clientId?(b=!!t.clientId&&r(Y,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:s,type:"button",children:r(_t,{className:"h-3 w-3"})}),e[10]=s,e[11]=t.clientId,e[12]=b):b=e[12];let D;e[13]===Symbol.for("react.memo_cache_sentinel")?(D=r(Kt,{className:"h-3 w-3"}),e[13]=D):D=e[13];let g;e[14]!==n?(g=r(Y,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:text-destructive",onClick:n,type:"button",children:D}),e[14]=n,e[15]=g):g=e[15];let x;e[16]!==b||e[17]!==g?(x=p("div",{className:"flex gap-1",children:[b,g]}),e[16]=b,e[17]=g,e[18]=x):x=e[18];let I;e[19]!==x||e[20]!==m?(I=r(Ct,{className:"pb-3",children:p("div",{className:"flex items-center justify-between",children:[m,x]})}),e[19]=x,e[20]=m,e[21]=I):I=e[21];let S;e[22]!==c||e[23]!==i||e[24]!==o?(S=r(yt,{className:"space-y-2 text-sm text-muted-foreground",children:c?p(Fe,{children:[o?.phone?.phoneFormated&&p("div",{className:"flex items-center gap-2",children:[r(ft,{className:"h-3 w-3"}),o.phone.phoneFormated]}),o?.email&&p("div",{className:"flex items-center gap-2",children:[r(ht,{className:"h-3 w-3"}),o.email]})]}):p(Fe,{children:[i?.phone?.phoneFormated&&p("div",{className:"flex items-center gap-2",children:[r(ft,{className:"h-3 w-3"}),i.phone.phoneFormated]}),i?.email&&p("div",{className:"flex items-center gap-2",children:[r(ht,{className:"h-3 w-3"}),i.email]})]})}),e[22]=c,e[23]=i,e[24]=o,e[25]=S):S=e[25];let C;return e[26]!==I||e[27]!==S?(C=p(gt,{className:"w-full max-w-sm transition-all hover:shadow-md hover:bg-accent/40 focus-within:ring-2 focus-within:ring-primary",children:[I,S]}),e[26]=I,e[27]=S,e[28]=C):C=e[28],C},Za=me("rentalApprovals/searchEntitiesUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.getEntities(a)).payload}catch(s){throw s}}),Wa=(a,e)=>aa({queryKey:["entities",a.params?.search],queryFn:async()=>await e?.(Za(a)).unwrap(),enabled:!!(a.params.subscriptionId||a.params.search)}),Ja=me("rentalApprovals/lastOwnersUsecase",async(a,{extra:e})=>{const{rentalApprovalApi:t}=e;try{return(await t.getLastOwners(a)).payload}catch(n){throw n}}),en=(a,e)=>aa({queryKey:["entities","owners","last",a.params?.subscriptionId,a.params?.count??5],queryFn:async()=>await e?.(Ja(a)).unwrap(),enabled:!!a.params?.subscriptionId}),Yt=a=>{const e=B(11),{item:t,onClick:n}=a;let s;e[0]!==t||e[1]!==n?(s=()=>n?.(t),e[0]=t,e[1]=n,e[2]=s):s=e[2];const c=s;if(t.type===je.Natural&&t.naturalEntity){let i;return e[3]!==c||e[4]!==t.naturalEntity?(i=r(tn,{naturalEntity:t.naturalEntity,onClick:c}),e[3]=c,e[4]=t.naturalEntity,e[5]=i):i=e[5],i}if(t.type===je.Legal&&t.legalEntity){let i;return e[6]!==c||e[7]!==t.legalEntity?(i=r(an,{legalEntity:t.legalEntity,onClick:c}),e[6]=c,e[7]=t.legalEntity,e[8]=i):i=e[8],i}let o;return e[9]!==t.id?(o=r(gt,{className:"mb-2 border-dashed",children:p(yt,{className:"py-3 text-xs text-muted-foreground",children:["Type d'entité non reconnu (ID: ",t.id,")"]})}),e[9]=t.id,e[10]=o):o=e[10],o},tn=a=>{const e=B(26),{naturalEntity:t,onClick:n}=a;let s;e[0]!==n?(s=b=>(b.key==="Enter"||b.key===" ")&&n(),e[0]=n,e[1]=s):s=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=r(rt,{className:"h-4 w-4 text-primary"}),e[2]=c):c=e[2];let o;e[3]!==t.firstName||e[4]!==t.lastName?(o=p(St,{className:"flex items-center gap-2 text-sm font-medium",children:[c,p("span",{children:[t.firstName," ",t.lastName]})]}),e[3]=t.firstName,e[4]=t.lastName,e[5]=o):o=e[5];let i;e[6]!==t.externalId?(i=p(Ut,{className:"text-xs",children:["ID: ",t.externalId]}),e[6]=t.externalId,e[7]=i):i=e[7];let u;e[8]!==o||e[9]!==i?(u=p(Ct,{className:"pb-2",children:[o,i]}),e[8]=o,e[9]=i,e[10]=u):u=e[10];let l;e[11]!==t.birthDate?(l=t.birthDate&&p("div",{className:"flex items-center gap-2",children:[r(_a,{className:"h-3 w-3"}),new Date(t.birthDate).toLocaleDateString("fr-FR")]}),e[11]=t.birthDate,e[12]=l):l=e[12];let d;e[13]!==t.phone?(d=t?.phone?.phoneFormated&&p("div",{className:"flex items-center gap-2",children:[r(ft,{className:"h-3 w-3"}),t.phone.phoneFormated]}),e[13]=t.phone,e[14]=d):d=e[14];let f;e[15]!==t.email?(f=t.email&&p("div",{className:"flex items-center gap-2",children:[r(ht,{className:"h-3 w-3"}),t.email]}),e[15]=t.email,e[16]=f):f=e[16];let h;e[17]!==l||e[18]!==d||e[19]!==f?(h=p(yt,{className:"space-y-1.5 text-xs text-muted-foreground",children:[l,d,f]}),e[17]=l,e[18]=d,e[19]=f,e[20]=h):h=e[20];let m;return e[21]!==n||e[22]!==s||e[23]!==u||e[24]!==h?(m=p(gt,{role:"button",tabIndex:0,onClick:n,onKeyDown:s,className:"mb-2 cursor-pointer transition-all hover:shadow-md hover:bg-accent/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:[u,h]}),e[21]=n,e[22]=s,e[23]=u,e[24]=h,e[25]=m):m=e[25],m},an=a=>{const e=B(22),{legalEntity:t,onClick:n}=a;let s;e[0]!==n?(s=m=>(m.key==="Enter"||m.key===" ")&&n(),e[0]=n,e[1]=s):s=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=r(Gt,{className:"h-4 w-4 text-primary"}),e[2]=c):c=e[2];let o;e[3]!==t.name?(o=p(St,{className:"flex items-center gap-2 text-sm font-medium",children:[c,r("span",{children:t.name})]}),e[3]=t.name,e[4]=o):o=e[4];let i;e[5]!==t.externalId?(i=p(Ut,{className:"text-xs",children:["ID: ",t.externalId]}),e[5]=t.externalId,e[6]=i):i=e[6];let u;e[7]!==o||e[8]!==i?(u=p(Ct,{className:"pb-2",children:[o,i]}),e[7]=o,e[8]=i,e[9]=u):u=e[9];let l;e[10]!==t.phone?(l=t?.phone?.phoneFormated&&p("div",{className:"flex items-center gap-2",children:[r(ft,{className:"h-3 w-3"}),t.phone.phoneFormated]}),e[10]=t.phone,e[11]=l):l=e[11];let d;e[12]!==t.email?(d=t.email&&p("div",{className:"flex items-center gap-2",children:[r(ht,{className:"h-3 w-3"}),t.email]}),e[12]=t.email,e[13]=d):d=e[13];let f;e[14]!==l||e[15]!==d?(f=p(yt,{className:"space-y-1.5 text-xs text-muted-foreground",children:[l,d]}),e[14]=l,e[15]=d,e[16]=f):f=e[16];let h;return e[17]!==n||e[18]!==s||e[19]!==u||e[20]!==f?(h=p(gt,{role:"button",tabIndex:0,onClick:n,onKeyDown:s,className:"mb-2 cursor-pointer transition-all hover:shadow-md hover:bg-accent/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:[u,f]}),e[17]=n,e[18]=s,e[19]=u,e[20]=f,e[21]=h):h=e[21],h},nn=a=>{const e=B(35),{onDataChange:t,id:n}=a,s=Xe();let c;e[0]!==s?(c=la(s),e[0]=s,e[1]=c):c=e[1];const o=c;let i;e[2]!==t?(i=()=>{t({})},e[2]=t,e[3]=i):i=e[3];let u;e[4]!==o||e[5]!==i?(u={...o,onSuccess:i},e[4]=o,e[5]=i,e[6]=u):u=e[6];const l=ve(u),d=ct();let f;e[7]!==s?(f=He({data:{},params:{}},s),e[7]=s,e[8]=f):f=e[8];const h=f,{data:m}=he(h),b=Et();let D;e[9]!==s||e[10]!==d.ID_rentalapproval||e[11]!==m?.id?(D=dt({data:{},params:{rentalApprovalId:d.ID_rentalapproval,subscriptionId:m?.id}},s),e[9]=s,e[10]=d.ID_rentalapproval,e[11]=m?.id,e[12]=D):D=e[12];const g=D,x=!!d.ID_rentalapproval&&!!m?.id;let I;e[13]!==g||e[14]!==x?(I={...g,enabled:x},e[13]=g,e[14]=x,e[15]=I):I=e[15];const{data:S}=he(I);let C;e[16]!==S?.owners?(C=S?.owners.map(sn)??[],e[16]=S?.owners,e[17]=C):C=e[17];const F=C,[v,y]=Ee(F);let P;e[18]!==l||e[19]!==d.ID_rentalapproval||e[20]!==b||e[21]!==m?.id||e[22]!==g.queryKey?(P=async L=>{await l.mutateAsync({data:{owners:L},params:{rentalApprovalId:d.ID_rentalapproval,subscriptionId:m?.id}}),b.invalidateQueries({queryKey:g.queryKey})},e[18]=l,e[19]=d.ID_rentalapproval,e[20]=b,e[21]=m?.id,e[22]=g.queryKey,e[23]=P):P=e[23];const O=P;let R;e[24]!==O||e[25]!==v?(R=async L=>{L.preventDefault(),await O(v)},e[24]=O,e[25]=v,e[26]=R):R=e[26];let U;e[27]!==n||e[28]!==R?(U=r("form",{id:n,onSubmit:R}),e[27]=n,e[28]=R,e[29]=U):U=e[29];let A;e[30]!==v?(A=r(rn,{owners:v,setOwners:y}),e[30]=v,e[31]=A):A=e[31];let M;return e[32]!==U||e[33]!==A?(M=p(Fe,{children:[U,A]}),e[32]=U,e[33]=A,e[34]=M):M=e[34],M},rn=a=>{const e=B(106),{owners:t,setOwners:n}=a;let s;e[0]===Symbol.for("react.memo_cache_sentinel")?(s={openLegalForm:!1,openNaturalForm:!1,selectId:""},e[0]=s):s=e[0];const[c,o]=Ee(s),[i,u]=Ee(""),[l,d]=Ee(!1),[f,h]=Ee("openNaturalForm"),m=Xe();let b;e[1]!==m?(b=He({data:{},params:{}},m),e[1]=m,e[2]=b):b=e[2];const D=b,{data:g}=he(D);let x;e[3]!==m||e[4]!==i||e[5]!==g?.id?(x=Wa({data:{},params:{search:i,subscriptionId:g?.id}},m),e[3]=m,e[4]=i,e[5]=g?.id,e[6]=x):x=e[6];const I=x,S=!!g?.id&&i.length>0;let C;e[7]!==I||e[8]!==S?(C={...I,enabled:S},e[7]=I,e[8]=S,e[9]=C):C=e[9];const{data:F,isFetching:v}=he(C);let y;e[10]!==m||e[11]!==g?.id?(y=en({data:{},params:{subscriptionId:g?.id,count:5}},m),e[10]=m,e[11]=g?.id,e[12]=y):y=e[12];const P=y,O=!!g?.id&&l&&i.length===0;let R;e[13]!==P||e[14]!==O?(R={...P,enabled:O},e[13]=P,e[14]=O,e[15]=R):R=e[15];const{data:U,isFetching:A}=he(R);let M;e[16]===Symbol.for("react.memo_cache_sentinel")?(M=w=>{o(j=>({...j,[w]:!j[w],selectId:j[w]?"":j.selectId}))},e[16]=M):M=e[16];const L=M;let K;e[17]!==t||e[18]!==n?(K=w=>{const j={ownerId:w.id,type:w.type,naturalEntity:w.type===je.Natural?{firstName:w.naturalEntity?.firstName,lastName:w.naturalEntity?.lastName,title:w.naturalEntity?.title,birthDate:w.naturalEntity?.birthDate,email:w.naturalEntity?.email,externalId:w.naturalEntity?.externalId,phone:w.naturalEntity?.phone}:void 0,legalEntity:w.type===je.Legal?{name:w.legalEntity?.name,email:w.legalEntity?.email,externalId:w.legalEntity?.externalId,phone:w.legalEntity?.phone}:void 0};t.some(Ve=>Ve.ownerId===w.id)||n(Ve=>[...Ve,j]),u("")},e[17]=t,e[18]=n,e[19]=K):K=e[19];const z=K;let Q;e[20]!==n?(Q=w=>{n(j=>j.filter(ne=>w.ownerId?ne.ownerId!==w.ownerId:ne.clientId!==w.clientId))},e[20]=n,e[21]=Q):Q=e[21];const $=Q;let _;e[22]!==t||e[23]!==c.selectId?(_=c.selectId?t.find(w=>w.clientId===c.selectId):{},e[22]=t,e[23]=c.selectId,e[24]=_):_=e[24];const E=_;let q;e[25]!==l?(q=w=>{u(w),l||d(!0)},e[25]=l,e[26]=q):q=e[26];let J,ee;e[27]===Symbol.for("react.memo_cache_sentinel")?(J=()=>d(!0),ee=()=>u(""),e[27]=J,e[28]=ee):(J=e[27],ee=e[28]);const H=i.length>0?v:A;let V;e[29]!==z||e[30]!==U||e[31]!==i.length||e[32]!==F?.data?(V=r("div",{className:"max-h-64 overflow-auto",children:i.length>0?r(Fe,{children:F?.data?.length?p("div",{className:"py-1",children:[r("div",{className:"sticky top-0 z-10 bg-popover px-3 py-2 text-xs text-muted-foreground",children:"Résultats de recherche"}),F?.data?.map(w=>r(Yt,{item:w,onClick:j=>{z(j),d(!1)}},w.id))]}):r("div",{className:"px-3 py-4 text-sm text-muted-foreground",children:"Aucun résultat"})}):r(Fe,{children:U?.length?p("div",{className:"py-1",children:[r("div",{className:"sticky top-0 z-10 bg-popover px-3 py-2 text-xs text-muted-foreground",children:"Derniers propriétaires"}),U?.map(w=>r(Yt,{item:w,onClick:j=>{z(j),d(!1)}},w.id))]}):r("div",{className:"px-3 py-4 text-sm text-muted-foreground",children:"Aucune suggestion récente"})})}),e[29]=z,e[30]=U,e[31]=i.length,e[32]=F?.data,e[33]=V):V=e[33];let X;e[34]!==i||e[35]!==l||e[36]!==q||e[37]!==H||e[38]!==V?(X=r("div",{className:"flex-1",children:r(Ba,{value:i,onChange:q,onFocus:J,onClear:ee,showDropdown:l,onDropdownChange:d,loading:H,placeholder:"Chercher un contact",dropdownClassName:"p-0",children:V})}),e[34]=i,e[35]=l,e[36]=q,e[37]=H,e[38]=V,e[39]=X):X=e[39];let le;e[40]===Symbol.for("react.memo_cache_sentinel")?(le=r(ma,{asChild:!0,children:p(Y,{variant:"default",className:"",children:[r(ea,{className:"mr-2 h-4 w-4"}),"Nouveau propriétaire"]})}),e[40]=le):le=e[40];let ye;e[41]===Symbol.for("react.memo_cache_sentinel")?(ye=r("div",{className:"text-sm font-medium",children:"Type de propriétaire"}),e[41]=ye):ye=e[41];const G=f==="openNaturalForm"?"default":"ghost";let re,de;e[42]===Symbol.for("react.memo_cache_sentinel")?(re=()=>h("openNaturalForm"),de=r(rt,{className:"mr-2 h-4 w-4"}),e[42]=re,e[43]=de):(re=e[42],de=e[43]);let Z;e[44]!==G?(Z=p(Y,{variant:G,size:"sm",className:"w-full justify-start",onClick:re,children:[de,"Particulier"]}),e[44]=G,e[45]=Z):Z=e[45];const ue=f==="openLegalForm"?"default":"ghost";let pe,ie;e[46]===Symbol.for("react.memo_cache_sentinel")?(pe=()=>h("openLegalForm"),ie=r(Gt,{className:"mr-2 h-4 w-4"}),e[46]=pe,e[47]=ie):(pe=e[46],ie=e[47]);let se;e[48]!==ue?(se=p(Y,{variant:ue,size:"sm",className:"w-full justify-start",onClick:pe,children:[ie,"Personne morale"]}),e[48]=ue,e[49]=se):se=e[49];let te;e[50]!==Z||e[51]!==se?(te=p("div",{className:"space-y-1",children:[Z,se]}),e[50]=Z,e[51]=se,e[52]=te):te=e[52];let ae;e[53]===Symbol.for("react.memo_cache_sentinel")?(ae=r(Lt,{}),e[53]=ae):ae=e[53];let oe;e[54]!==f?(oe=r(Y,{size:"sm",className:"w-full",onClick:()=>{L(f)},children:"Ajouter"}),e[54]=f,e[55]=oe):oe=e[55];let ce;e[56]!==te||e[57]!==oe?(ce=p(fa,{children:[le,r(ha,{className:"w-56",children:p("div",{className:"space-y-2",children:[ye,te,ae,oe]})})]}),e[56]=te,e[57]=oe,e[58]=ce):ce=e[58];let fe;e[59]!==X||e[60]!==ce?(fe=r("div",{className:"space-y-4",children:p("div",{className:"flex gap-2",children:[X,ce]})}),e[59]=X,e[60]=ce,e[61]=fe):fe=e[61];let Re;e[62]!==t||e[63]!==$?(Re=t.length>0&&p("div",{className:"space-y-4",children:[p("div",{className:"text-sm font-medium text-gray-700",children:["Propriétaires (",t.length,")"]}),r("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3",children:t.map(w=>r(Ya,{owner:w,onRemove:()=>$(w),onChange:()=>{w.type===je.Legal&&L("openLegalForm"),w.type===je.Natural&&L("openNaturalForm"),o(j=>({...j,selectId:w.clientId}))}},w.ownerId||w.clientId))})]}),e[62]=t,e[63]=$,e[64]=Re):Re=e[64];let Me;e[65]!==t.length?(Me=t.length===0&&p("div",{className:"text-center py-8 text-gray-500",children:[r("div",{className:"mb-2",children:r(rt,{className:"h-12 w-12 mx-auto opacity-30"})}),r("div",{className:"text-sm",children:"Aucun propriétaire ajouté. Recherchez un propriétaire existant ou créez-en un nouveau."})]}),e[65]=t.length,e[66]=Me):Me=e[66];let Te;e[67]!==fe||e[68]!==Re||e[69]!==Me?(Te=p("div",{className:"space-y-6",children:[fe,Re,Me]}),e[67]=fe,e[68]=Re,e[69]=Me,e[70]=Te):Te=e[70];const Ye=E?.legalEntity?.name??"",Ze=E?.legalEntity?.email??"",We=E?.legalEntity?.phone?.phoneFormated??"",Pe=E?.legalEntity?.phone?.phoneContryCode??"FR";let Oe;e[71]!==We||e[72]!==Pe?(Oe={phoneNumber:We,countryCode:Pe},e[71]=We,e[72]=Pe,e[73]=Oe):Oe=e[73];let qe;e[74]!==Ye||e[75]!==Ze||e[76]!==Oe?(qe={name:Ye,email:Ze,phone:Oe},e[74]=Ye,e[75]=Ze,e[76]=Oe,e[77]=qe):qe=e[77];let ge;e[78]!==n||e[79]!==c.selectId?(ge=w=>{c.selectId?(n(j=>j.map(ne=>ne.clientId===c.selectId?{...ne,legalEntity:{name:w.name,email:w.email,phone:{phoneOrigin:w.phone?.phoneNumber,phoneContryCode:w.phone?.countryCode,phoneFormated:w.phone?.phoneNumber}}}:ne)),o(ln)):n(j=>[...j,{clientId:window.crypto.randomUUID(),type:je.Legal,legalEntity:{name:w.name,email:w.email,phone:{phoneOrigin:w.phone?.phoneNumber,phoneContryCode:w.phone?.countryCode,phoneFormated:w.phone?.phoneNumber}}}]),L("openLegalForm")},e[78]=n,e[79]=c.selectId,e[80]=ge):ge=e[80];let Ie;e[81]===Symbol.for("react.memo_cache_sentinel")?(Ie=()=>L("openLegalForm"),e[81]=Ie):Ie=e[81];let Ue;e[82]!==c.openLegalForm||e[83]!==qe||e[84]!==ge?(Ue=r(Ha,{data:qe,id:"LegalForm21",onDataChange:ge,onOpenChange:Ie,openModal:c.openLegalForm}),e[82]=c.openLegalForm,e[83]=qe,e[84]=ge,e[85]=Ue):Ue=e[85];const Le=E?.naturalEntity?.firstName??"",Je=E?.naturalEntity?.lastName??"",et=E?.naturalEntity?.email??"",tt=E?.naturalEntity?.phone?.phoneFormated??"",at=E?.naturalEntity?.phone?.phoneContryCode??"FR";let ke;e[86]!==tt||e[87]!==at?(ke={phoneNumber:tt,countryCode:at},e[86]=tt,e[87]=at,e[88]=ke):ke=e[88];let _e;e[89]!==Le||e[90]!==Je||e[91]!==et||e[92]!==ke?(_e={firstName:Le,lastName:Je,email:et,phone:ke},e[89]=Le,e[90]=Je,e[91]=et,e[92]=ke,e[93]=_e):_e=e[93];let Ge;e[94]!==n||e[95]!==c.selectId?(Ge=w=>{c.selectId?(n(j=>j.map(ne=>ne.clientId===c.selectId?{...ne,naturalEntity:{firstName:w?.firstName,lastName:w.lastName,title:1,email:w.email,phone:{phoneOrigin:w.phone?.phoneNumber,phoneContryCode:w.phone?.countryCode,phoneFormated:w.phone?.phoneNumber}}}:ne)),o(on)):n(j=>[...j,{clientId:window.crypto.randomUUID(),type:je.Natural,naturalEntity:{firstName:w?.firstName,lastName:w.lastName,title:1,email:w.email,phone:{phoneOrigin:w.phone?.phoneNumber,phoneContryCode:w.phone?.countryCode,phoneFormated:w.phone?.phoneNumber}}}]),L("openNaturalForm")},e[94]=n,e[95]=c.selectId,e[96]=Ge):Ge=e[96];let Ae;e[97]===Symbol.for("react.memo_cache_sentinel")?(Ae=()=>L("openNaturalForm"),e[97]=Ae):Ae=e[97];let Ke;e[98]!==c.openNaturalForm||e[99]!==_e||e[100]!==Ge?(Ke=r(Xa,{data:_e,id:"NaturalForm21",onDataChange:Ge,onOpenChange:Ae,openModal:c.openNaturalForm}),e[98]=c.openNaturalForm,e[99]=_e,e[100]=Ge,e[101]=Ke):Ke=e[101];let Qe;return e[102]!==Te||e[103]!==Ue||e[104]!==Ke?(Qe=p(Fe,{children:[Te,Ue,Ke]}),e[102]=Te,e[103]=Ue,e[104]=Ke,e[105]=Qe):Qe=e[105],Qe};function sn(a){return{naturalEntity:{firstName:a.naturalEntity?.firstName,lastName:a.naturalEntity?.lastName,title:a.naturalEntity?.title,birthDate:a.naturalEntity?.birthDate,email:a.naturalEntity?.email,externalId:a.naturalEntity?.externalId,phone:a.naturalEntity?.phone},legalEntity:{name:a.legalEntity?.name,email:a.legalEntity?.email,externalId:a.legalEntity?.externalId,phone:a.legalEntity?.phone},ownerId:a.id,type:a.type}}function ln(a){return{...a,selectId:""}}function on(a){return{...a,selectId:""}}const cn=me("rentalApprovals/registerRentalApprovalsUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.putRentalApprovals(a)).payload}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),ia=a=>be({mutationKey:["registerRentalApprovals"],mutationFn:async e=>await a?.(cn(e)).unwrap()});function ze(a){return String(a).toLowerCase()==="true"}const dn=a=>{const e=B(39),{onDataChange:t,id:n}=a,s=Xe(),c=Et(),o=ct();let i;e[0]!==s?(i=He({data:{},params:{}},s),e[0]=s,e[1]=i):i=e[1];const u=i,{data:l}=he(u);let d;e[2]!==s?(d=ia(s),e[2]=s,e[3]=d):d=e[3];const f=d;let h;e[4]!==t?(h=()=>{t({})},e[4]=t,e[5]=h):h=e[5];let m;e[6]!==f||e[7]!==h?(m={...f,onSuccess:h},e[6]=f,e[7]=h,e[8]=m):m=e[8];const b=ve(m);let D;e[9]!==s||e[10]!==o.ID_rentalapproval||e[11]!==l?.id?(D=dt({data:{},params:{rentalApprovalId:o.ID_rentalapproval,subscriptionId:l?.id}},s),e[9]=s,e[10]=o.ID_rentalapproval,e[11]=l?.id,e[12]=D):D=e[12];const g=D,x=!!o.ID_rentalapproval&&!!l?.id;let I;e[13]!==g||e[14]!==x?(I={...g,enabled:x},e[13]=g,e[14]=x,e[15]=I):I=e[15];const{data:S}=he(I);let C;e[16]!==b||e[17]!==o.ID_rentalapproval||e[18]!==c||e[19]!==l?.id||e[20]!==g.queryKey?(C=async E=>{await b.mutateAsync({data:{chargesAmount:E?.chargesAmount,hadConflict:ze(E.hadConflict),hasDepartureNotice:ze(E.hasDepartureNotice),hasFurnished:ze(E.hasFurnished),hasVisaleCoverage:ze(E.hasVisaleCoverage),isBalanceUpToDate:ze(E.isBalanceUpToDate),rentAmount:E.rentAmount,sittingTenant:ze(E.sittingTenant),startLeaseDate:E.startLeaseDate},params:{rentalApprovalId:o.ID_rentalapproval,subscriptionId:l?.id}}),c.invalidateQueries({queryKey:g.queryKey})},e[16]=b,e[17]=o.ID_rentalapproval,e[18]=c,e[19]=l?.id,e[20]=g.queryKey,e[21]=C):C=e[21];const F=C,v=un;let y;e[22]===Symbol.for("react.memo_cache_sentinel")?(y=new st(N.object({hasFurnished:N.enum(["true","false"]).superRefine(T({label:"Comment le lot est-il loué ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Meublé",value:"true",icon:Se},{label:"Non Meublé",value:"false",icon:Ce}]}})),sittingTenant:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({label:"S'agit-il de locataires",fieldType:"situation",inputProps:{},customData:{data:[{label:"En place",value:"true",icon:Se},{label:"Entrants",value:"false",icon:Ce}]}})),startLeaseDate:N.any().superRefine(T({shouldRender(E){return E?.sittingTenant==="true"},label:"Quand le bail a-t-il pris effet ?",fieldType:"datepicker",inputProps:{required:!1}})),rentAmount:N.number({message:"RequiredFields18362"}).superRefine(T({label:"Loyer hors charges (€)",fieldType:"currency",inputProps:{required:!1}})),chargesAmount:N.number({message:"RequiredFields18362"}).superRefine(T({label:"Charges (€)",fieldType:"currency",inputProps:{required:!1}})),isBalanceUpToDate:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(E){return v(E)},label:"Les locataires sont-ils à jour du paiement de l'ensemble des loyers et charges dûs ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),hadConflict:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(E){return v(E)},label:"Le propriétaire est-il actuellement en conflit avec ces locataires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),hasDepartureNotice:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(E){return v(E)},label:"L'un des locataires est-il en période de préavis de départ du logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),hasVisaleCoverage:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(E){return v(E)},label:"Les locataires bénéficient-ils de la Garantie Visale ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}}))})),e[22]=y):y=e[22];let P;e[23]!==F?(P=E=>{F(E)},e[23]=F,e[24]=P):P=e[24];const O=S?.businessData?.chargesAmount,R=String(S?.businessData?.hadConflict),U=String(S?.businessData?.hasDepartureNotice),A=String(S?.businessData?.hasFurnished),M=String(S?.businessData?.hasVisaleCoverage),L=String(S?.businessData?.sittingTenant),K=String(S?.businessData?.isBalanceUpToDate),z=S?.businessData?.rentAmount,Q=S?.businessData?.startLeaseDate;let $;e[25]!==O||e[26]!==R||e[27]!==U||e[28]!==A||e[29]!==M||e[30]!==L||e[31]!==K||e[32]!==z||e[33]!==Q?($={chargesAmount:O,hadConflict:R,hasDepartureNotice:U,hasFurnished:A,hasVisaleCoverage:M,sittingTenant:L,isBalanceUpToDate:K,rentAmount:z,startLeaseDate:Q},e[25]=O,e[26]=R,e[27]=U,e[28]=A,e[29]=M,e[30]=L,e[31]=K,e[32]=z,e[33]=Q,e[34]=$):$=e[34];let _;return e[35]!==n||e[36]!==P||e[37]!==$?(_=r(lt,{schema:y,onSubmit:P,defaultValues:$,id:n}),e[35]=n,e[36]=P,e[37]=$,e[38]=_):_=e[38],_};function un(a){const e=a?.sittingTenant==="true",t=new Date(a.startLeaseDate),n=new Date(t);n.setMonth(n.getMonth()+6);const s=new Date>n;return e&&s}const pn=me("rentalApprovals/registerTenantUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putTenant({data:a.data,params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),mn=a=>be({mutationKey:["registerTenant"],mutationFn:async e=>await a?.(pn(e)).unwrap()});function qt(a){return Object.keys(a).filter(e=>isNaN(Number(e))).map(e=>String(a[e]))}const fn=me("rentalApprovals/registerDeleteTenantUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.deleteTenant({data:a.data,params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),hn=a=>be({mutationKey:["registerDeleteTenant"],mutationFn:async e=>await a?.(fn(e)).unwrap()}),yn=me("rentalApprovals/registerModifyTenantUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putUpdateTenant({data:a.data,params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),gn=a=>be({mutationKey:["registerModifyTenant"],mutationFn:async e=>await a?.(yn(e)).unwrap()}),vn=me("rentalApprovals/createRentalApprovalUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.postCreateApproval({data:{},params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),oa=a=>be({mutationKey:["createRentalApproval"],mutationFn:async e=>await a?.(vn(e)).unwrap()}),bn=me("rentalApprovals/registerGuarantorUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.postAddGuarantor({data:a.data,params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),Nn=a=>be({mutationKey:["registerGuarantor"],mutationFn:async e=>await a?.(bn(e)).unwrap()}),wn=me("rentalApprovals/registerDeleteGuarantorUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.deleteGuarantor({data:{},params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),Dn=a=>be({mutationKey:["registerDeleteGuarantor"],mutationFn:async e=>await a?.(wn(e)).unwrap()}),In=me("rentalApproval/registerModifyGuarantorUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putUpdateGuarantor({data:a.data,params:a.params});return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),An=a=>be({mutationKey:["registerModifyGuarantor"],mutationFn:async e=>await a?.(In(e)).unwrap()}),xn=N.object({id:N.string(),guarantor:N.any(),professionalStatus:N.number()});N.object({id:N.string(),professionalStatus:N.number(),guarantors:N.array(xn),tenant:N.object({naturalEntity:N.object({firstName:N.string(),lastName:N.string()})})});const Sn=a=>{const e=B(100),{data:t,onDataChange:n,id:s}=a;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c={openModalAddTenant:!1,openModalAddGuarantor:!1,openDeleteProfile:!1},e[0]=c):c=e[0];const[o,i]=mt.useState(c);let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u={id:"",guarantorId:"",isUpdateForm:!1},e[1]=u):u=e[1];const[l,d]=mt.useState(u),f=Et(),h=Xe(),m=ct(),b=mn(h);let D;e[2]!==h?(D=He({data:{},params:{}},h),e[2]=h,e[3]=D):D=e[3];const g=D,x=hn(h),I=Dn(h),S=gn(h),C=Nn(h),F=An(h),v=ve({...S,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),y=ve({...F,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),P=ve({...C,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),O=ve({...x,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),R=ve({...I,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),U=ve({...b,onSuccess:()=>{f.invalidateQueries({queryKey:M.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),{data:A}=he(g),M=dt({data:{},params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id}},h),L=!!m.ID_rentalapproval&&!!A?.id;let K;e[4]!==M||e[5]!==L?(K={...M,enabled:L},e[4]=M,e[5]=L,e[6]=K):K=e[6];const{data:z}=he(K);let Q;e[7]!==U||e[8]!==m.ID_rentalapproval||e[9]!==A?.id?(Q=async W=>{await U.mutateAsync({data:W,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id}})},e[7]=U,e[8]=m.ID_rentalapproval,e[9]=A?.id,e[10]=Q):Q=e[10];const $=Q;let _;e[11]!==v||e[12]!==m.ID_rentalapproval||e[13]!==A?.id||e[14]!==l.id?(_=async W=>{await v.mutateAsync({data:W,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id,tenantId:l.id}})},e[11]=v,e[12]=m.ID_rentalapproval,e[13]=A?.id,e[14]=l.id,e[15]=_):_=e[15];const E=_;let q;e[16]!==P||e[17]!==y||e[18]!==m.ID_rentalapproval||e[19]!==A?.id||e[20]!==l.guarantorId||e[21]!==l.id||e[22]!==l.isUpdateForm?(q=async W=>l.isUpdateForm?await y.mutateAsync({data:W,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id,guarantorId:l.guarantorId}}):await P.mutateAsync({data:W,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id,tenantId:l.id}}),e[16]=P,e[17]=y,e[18]=m.ID_rentalapproval,e[19]=A?.id,e[20]=l.guarantorId,e[21]=l.id,e[22]=l.isUpdateForm,e[23]=q):q=e[23];const J=q;let ee;e[24]!==t||e[25]!==R||e[26]!==O||e[27]!==m.ID_rentalapproval||e[28]!==A?.id||e[29]!==l.guarantorId||e[30]!==l.id?(ee=async()=>l.guarantorId?await R.mutateAsync({data:t,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id,tenantId:l.id,guarantorId:l.guarantorId}}):await O.mutateAsync({data:t,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id,tenantId:l.id}}),e[24]=t,e[25]=R,e[26]=O,e[27]=m.ID_rentalapproval,e[28]=A?.id,e[29]=l.guarantorId,e[30]=l.id,e[31]=ee):ee=e[31];const H=ee;let V;e[32]===Symbol.for("react.memo_cache_sentinel")?(V=W=>{i(xe=>({...xe,[W]:!xe[W]}))},e[32]=V):V=e[32];const X=V;let le;e[33]===Symbol.for("react.memo_cache_sentinel")?(le=function(xe,bt){if(!xe||!bt)return null;for(const Nt of xe){if(Nt.id===bt)return{type:"tenant",tenant:Nt};for(const jt of Nt.guarantors)if(jt.id===bt)return{type:"guarantor",tenant:Nt,guarantor:jt}}return null},e[33]=le):le=e[33];const G=le(z?.tenants,l.guarantorId?l.guarantorId:l.id);let re;e[34]!==h?(re=oa(h),e[34]=h,e[35]=re):re=e[35];const de=re;let Z;e[36]!==n?(Z=()=>{n({})},e[36]=n,e[37]=Z):Z=e[37];let ue;e[38]!==de||e[39]!==Z?(ue={...de,onSuccess:Z},e[38]=de,e[39]=Z,e[40]=ue):ue=e[40];const pe=ve(ue);let ie;e[41]!==pe||e[42]!==m.ID_rentalapproval||e[43]!==f||e[44]!==A?.id||e[45]!==M.queryKey?(ie=async W=>{W.preventDefault(),await pe.mutateAsync({data:{},params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:A?.id}}),f.invalidateQueries({queryKey:M.queryKey})},e[41]=pe,e[42]=m.ID_rentalapproval,e[43]=f,e[44]=A?.id,e[45]=M.queryKey,e[46]=ie):ie=e[46];const se=ie;let te;e[47]===Symbol.for("react.memo_cache_sentinel")?(te=p(Y,{variant:"default",className:"mb-3 ml-auto",onClick:()=>{X("openModalAddTenant"),d({id:"",guarantorId:"",isUpdateForm:!1})},children:[r(ea,{className:"mr-2 h-4 w-4"}),"Nouveau Locataire"]}),e[47]=te):te=e[47];let ae;e[48]!==se||e[49]!==s||e[50]!==z?.tenants?(ae=p("div",{className:"flex flex-col",children:[te,z?.tenants?.length===0?p("div",{className:"text-center py-8 text-gray-500",children:[r("div",{className:"mb-2",children:r(rt,{className:"h-12 w-12 mx-auto opacity-30"})}),r("div",{className:"text-sm",children:"Aucun Locataire ajouté, créez-en un nouveau."})]}):p(Fe,{children:[r("form",{id:s,onSubmit:W=>{se(W)}}),r("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3  2xl:grid-cols-4 gap-4",children:z?.tenants.map(W=>r(Rn,{handleModalDeteleProfile:xe=>{X("openDeleteProfile"),d({id:W.id,guarantorId:xe??"",isUpdateForm:!1})},handleEdit:()=>{d(xe=>({id:W.id,guarantorId:"",isUpdateForm:!0}))},handleAddGuarantor:()=>{d(xe=>({id:W.id,guarantorId:"",isUpdateForm:!1})),X("openModalAddGuarantor")},handleEditGuarantor:xe=>{d(bt=>({id:W.id,guarantorId:xe,isUpdateForm:!0})),X("openModalAddGuarantor")},toggleModal:X,tenant:W}))})]})]}),e[48]=se,e[49]=s,e[50]=z?.tenants,e[51]=ae):ae=e[51];let oe;e[52]===Symbol.for("react.memo_cache_sentinel")?(oe=()=>X("openModalAddTenant"),e[52]=oe):oe=e[52];const ce=l.isUpdateForm?E:$,fe=G?.tenant.tenant.naturalEntity.firstName??"",Re=G?.tenant.tenant.naturalEntity.lastName??"",Me=G?.tenant.professionalStatus.toString()??"",Te=G?.tenant?.incomes!=null?String(G?.tenant?.incomes):"",Ye=G?.tenant?.tenant?.naturalEntity?.email??"",Ze=G?.tenant?.tenant?.naturalEntity?.phone?.phoneFormated??"",We=G?.tenant?.tenant?.naturalEntity?.phone?.phoneContryCode??"FR";let Pe;e[53]!==Ze||e[54]!==We?(Pe={phoneNumber:Ze,countryCode:We},e[53]=Ze,e[54]=We,e[55]=Pe):Pe=e[55];const Oe=G?.tenant.hasAdditionalIncomes===!0?"true":"false",qe=G?.tenant.incomesChangeAtLease===!0?"true":"false";let ge;e[56]!==fe||e[57]!==Re||e[58]!==Me||e[59]!==Te||e[60]!==Ye||e[61]!==Pe||e[62]!==Oe||e[63]!==qe?(ge={firstname:fe,lastName:Re,professionalStatus:Me,incomes:Te,email:Ye,phone:Pe,hasAdditionalIncomes:Oe,incomesChangeAtLease:qe},e[56]=fe,e[57]=Re,e[58]=Me,e[59]=Te,e[60]=Ye,e[61]=Pe,e[62]=Oe,e[63]=qe,e[64]=ge):ge=e[64];let Ie;e[65]!==o.openModalAddTenant||e[66]!==l.isUpdateForm||e[67]!==ce||e[68]!==ge?(Ie=r(Cn,{openModal:o.openModalAddTenant,onOpenChange:oe,handleMutation:ce,isUpdate:l.isUpdateForm,data:ge}),e[65]=o.openModalAddTenant,e[66]=l.isUpdateForm,e[67]=ce,e[68]=ge,e[69]=Ie):Ie=e[69];const Ue=En;let Le;e[70]===Symbol.for("react.memo_cache_sentinel")?(Le=()=>X("openModalAddGuarantor"),e[70]=Le):Le=e[70];const Je=G?.guarantor?.guarantor?.naturalEntity?.firstName??"",et=G?.guarantor?.guarantor.naturalEntity.lastName??"",tt=G?.guarantor?.professionalStatus.toString()??"",at=G?.guarantor?.incomes!=null?String(G?.guarantor?.incomes):"",ke=G?.guarantor?.guarantor?.naturalEntity?.email??"",_e=G?.guarantor?.guarantor?.naturalEntity?.phone?.phoneFormated??"",Ge=G?.guarantor?.guarantor?.naturalEntity?.phone?.phoneContryCode??"FR";let Ae;e[71]!==_e||e[72]!==Ge?(Ae={phoneNumber:_e,countryCode:Ge},e[71]=_e,e[72]=Ge,e[73]=Ae):Ae=e[73];const Ke=G?.guarantor?.hasAdditionalIncomes===!0?"true":"false",Qe=G?.guarantor?.incomesChangeAtLease===!0?"true":"false",w=G?.guarantor?.link.toString()??"";let j;e[74]!==Je||e[75]!==et||e[76]!==tt||e[77]!==at||e[78]!==ke||e[79]!==Ae||e[80]!==Ke||e[81]!==Qe||e[82]!==w?(j={firstname:Je,lastName:et,professionalStatus:tt,incomes:at,email:ke,phone:Ae,hasAdditionalIncomes:Ke,incomesChangeAtLease:Qe,link:w},e[74]=Je,e[75]=et,e[76]=tt,e[77]=at,e[78]=ke,e[79]=Ae,e[80]=Ke,e[81]=Qe,e[82]=w,e[83]=j):j=e[83];let ne;e[84]!==Ue||e[85]!==J||e[86]!==o.openModalAddGuarantor||e[87]!==l.isUpdateForm||e[88]!==Le||e[89]!==j?(ne=r(Ue,{openModal:o.openModalAddGuarantor,onOpenChange:Le,handleMutation:J,isUpdate:l.isUpdateForm,data:j}),e[84]=Ue,e[85]=J,e[86]=o.openModalAddGuarantor,e[87]=l.isUpdateForm,e[88]=Le,e[89]=j,e[90]=ne):ne=e[90];let Ve;e[91]===Symbol.for("react.memo_cache_sentinel")?(Ve=()=>{X("openDeleteProfile"),d({id:"",guarantorId:"",isUpdateForm:!1})},e[91]=Ve):Ve=e[91];let it;e[92]!==H||e[93]!==o.openDeleteProfile?(it=r(Fn,{handleModalDeteleProfile:Ve,openDeleteProfile:o.openDeleteProfile,handleMutation:H}),e[92]=H,e[93]=o.openDeleteProfile,e[94]=it):it=e[94];let vt;return e[95]!==ae||e[96]!==Ie||e[97]!==ne||e[98]!==it?(vt=p(Fe,{children:[ae,Ie,ne,it]}),e[95]=ae,e[96]=Ie,e[97]=ne,e[98]=it,e[99]=vt):vt=e[99],vt},Cn=a=>{const e=B(16),{data:t,openModal:n,onOpenChange:s,handleMutation:c,isUpdate:o}=a,i=o===void 0?!1:o,{t:u}=kt(),l=i?"Modifier un locataire":"Ajouter un locataire";let d;e[0]!==u?(d=u("Submit98432"),e[0]=u,e[1]=d):d=e[1];let f;e[2]!==d?(f=r(Y,{type:"submit",form:"addTenant",children:d}),e[2]=d,e[3]=f):f=e[3];let h;e[4]===Symbol.for("react.memo_cache_sentinel")?(h=new st(N.object({firstname:N.string({message:"RequiredFields18362"}).nonempty().superRefine(T({label:"Prénom",inputProps:{required:!1}})),lastName:N.string({message:"RequiredFields18362"}).nonempty().superRefine(T({label:"Nom",inputProps:{required:!1}})),professionalStatus:N.enum(qt(k)).superRefine(T({label:"Quelle est sa situation professionnelle ?",inputProps:{},customData:{data:[{label:Ne(k.PrivateCDI),key:k.PrivateCDI},{label:Ne(k.PrivateCDD),key:k.PrivateCDD},{label:Ne(k.OtherRetaite),key:k.OtherRetaite},{label:Ne(k.OtherEtudiant),key:k.OtherEtudiant},{label:"Entreprise",key:k.IndepAuto},{label:Ne(k.OtherRecherche),key:k.OtherRecherche},{label:Ne(k.OtherAllowance),key:k.OtherAllowance}]}})),incomes:N.string({message:"RequiredFields18362"}).superRefine(T({label:"Revenus nets mensuels (€)",inputProps:{type:"number",min:0,step:"1",placeholder:"ex: 2500"}})),email:N.string().email("Format e-mail invalide").superRefine(T({label:"Adresse e-mail",inputProps:{required:!1}})),phone:N.object({phoneNumber:N.string().min(6,"Numéro requis"),countryCode:N.string().min(1,"Pays requis")}).superRefine(T({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}})),hasAdditionalIncomes:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({label:"A-t-il des sources de revenus complémentaires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),incomesChangeAtLease:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(g){return[k.PrivateCDI.toString(),k.PrivateCDD.toString()].includes(g?.professionalStatus)},label:"Les revenus indiqués sur les bulletins de salaire vont-ils changer à l'entrée du locataire dans le logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}}))})),e[4]=h):h=e[4];let m;e[5]!==c?(m=g=>{c({incomesChangeAtLease:ze(g.incomesChangeAtLease),hasAdditionalIncomes:ze(g.hasAdditionalIncomes),professionalStatus:Number(g.professionalStatus),incomes:g.incomes?Number(g.incomes):void 0,naturalEntity:{firstName:g.firstname,lastName:g.lastName,title:1,email:g.email,phone:{phoneOrigin:g.phone?.phoneNumber,phoneContryCode:g.phone?.countryCode,phoneFormated:g.phone?.phoneNumber}}})},e[5]=c,e[6]=m):m=e[6];let b;e[7]!==t||e[8]!==m?(b=r(lt,{schema:h,onSubmit:m,defaultValues:t,id:"addTenant"}),e[7]=t,e[8]=m,e[9]=b):b=e[9];let D;return e[10]!==s||e[11]!==n||e[12]!==l||e[13]!==f||e[14]!==b?(D=r(xt,{open:n,onOpenChange:s,title:l,mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",footer:f,content:b}),e[10]=s,e[11]=n,e[12]=l,e[13]=f,e[14]=b,e[15]=D):D=e[15],D},En=a=>{const e=B(16),{data:t,openModal:n,onOpenChange:s,handleMutation:c,isUpdate:o}=a,i=o===void 0?!1:o,{t:u}=kt(),l=i?"Modifier un garant":"Ajouter un garant";let d;e[0]!==u?(d=u("Submit98432"),e[0]=u,e[1]=d):d=e[1];let f;e[2]!==d?(f=r(Y,{type:"submit",form:"addGuarantor",children:d}),e[2]=d,e[3]=f):f=e[3];let h;e[4]===Symbol.for("react.memo_cache_sentinel")?(h=new st(N.object({firstname:N.string({message:"RequiredFields18362"}).nonempty().superRefine(T({label:"Nom",inputProps:{required:!1}})),lastName:N.string({message:"RequiredFields18362"}).nonempty().superRefine(T({label:"Prénom",inputProps:{required:!1}})),professionalStatus:N.enum(qt(k)).superRefine(T({label:"Quelle est sa situation professionnelle ?",inputProps:{},customData:{data:[{label:Ne(k.PrivateCDI),key:k.PrivateCDI},{label:Ne(k.PrivateCDD),key:k.PrivateCDD},{label:Ne(k.OtherRetaite),key:k.OtherRetaite},{label:Ne(k.IndepAuto),key:k.IndepAuto},{label:Ne(k.OtherRecherche),key:k.OtherRecherche},{label:Ne(k.OtherAllowance),key:k.OtherAllowance}]}})),incomes:N.string({message:"RequiredFields18362"}).superRefine(T({label:"Revenus nets mensuels (€)",inputProps:{type:"number",min:0,step:"1",placeholder:"ex: 1800"}})),email:N.string().email("Format e-mail invalide").superRefine(T({label:"Adresse e-mail",inputProps:{required:!1}})),phone:N.object({phoneNumber:N.string().min(6,"Numéro requis"),countryCode:N.string().min(1,"Pays requis")}).superRefine(T({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}})),incomesChangeAtLease:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({shouldRender(g){return[k.PrivateCDI.toString(),k.PrivateCDD.toString()].includes(g?.professionalStatus)},label:"Les revenus indiqués sur les bulletins de salaire vont-ils changer à l'entrée du locataire dans le logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),hasAdditionalIncomes:N.enum(["true","false"],{message:"RequiredFields18362"}).superRefine(T({label:"A-t-il des sources de revenus complémentaires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Se},{label:"Non",value:"false",icon:Ce}]}})),link:N.enum(qt(nt)).superRefine(T({label:"Quel est son lien de parenté avec ce locataire ?",inputProps:{},customData:{data:[{label:Mt(nt.FamilyMember),key:nt.FamilyMember},{label:Mt(nt.Parent),key:nt.Parent},{label:Mt(nt.Other),key:nt.Other}]}}))})),e[4]=h):h=e[4];let m;e[5]!==c?(m=g=>{c({naturalEntity:{firstName:g.firstname,lastName:g.lastName,email:g.email,phone:{phoneOrigin:g.phone?.phoneNumber,phoneContryCode:g.phone?.countryCode,phoneFormated:g.phone?.phoneNumber}},incomes:g.incomes?Number(g.incomes):void 0,hasAdditionalIncomes:ze(g.hasAdditionalIncomes),incomesChangeAtLease:ze(g.incomesChangeAtLease),link:Number(g.link),professionalStatus:Number(g.professionalStatus)})},e[5]=c,e[6]=m):m=e[6];let b;e[7]!==t||e[8]!==m?(b=r(lt,{schema:h,onSubmit:m,defaultValues:t,id:"addGuarantor"}),e[7]=t,e[8]=m,e[9]=b):b=e[9];let D;return e[10]!==s||e[11]!==n||e[12]!==l||e[13]!==f||e[14]!==b?(D=r(xt,{open:n,onOpenChange:s,title:l,mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",footer:f,content:b}),e[10]=s,e[11]=n,e[12]=l,e[13]=f,e[14]=b,e[15]=D):D=e[15],D},Fn=a=>{const e=B(14),{openDeleteProfile:t,handleModalDeteleProfile:n,handleMutation:s}=a;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=p(ya,{children:[r(ga,{children:"Supprimer"}),r(va,{children:"Etes vous sûr de vouloir supprimer ce profile ?"})]}),e[0]=c):c=e[0];let o;e[1]!==n?(o=r(ba,{onClick:n,children:"Cancel"}),e[1]=n,e[2]=o):o=e[2];let i;e[3]!==s?(i=()=>{s()},e[3]=s,e[4]=i):i=e[4];let u;e[5]===Symbol.for("react.memo_cache_sentinel")?(u=!1,e[5]=u):u=e[5];let l;e[6]!==i?(l=p(Na,{onClick:i,disabled:!1,children:[u,"Remove"]}),e[6]=i,e[7]=l):l=e[7];let d;e[8]!==o||e[9]!==l?(d=p(wa,{children:[c,p(Da,{children:[o,l]})]}),e[8]=o,e[9]=l,e[10]=d):d=e[10];let f;return e[11]!==t||e[12]!==d?(f=r(Ia,{open:t,children:d}),e[11]=t,e[12]=d,e[13]=f):f=e[13],f},Rn=a=>{const e=B(50),{handleModalDeteleProfile:t,handleEditGuarantor:n,handleEdit:s,handleAddGuarantor:c,toggleModal:o,tenant:i}=a;let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=r(rt,{className:"h-4 w-4"}),e[0]=u):u=e[0];let l;e[1]!==i.tenant.naturalEntity.firstName||e[2]!==i.tenant.naturalEntity.lastName?(l=p(St,{className:"text-lg flex items-center gap-2",children:[u,i.tenant.naturalEntity.firstName," ",i.tenant.naturalEntity.lastName]}),e[1]=i.tenant.naturalEntity.firstName,e[2]=i.tenant.naturalEntity.lastName,e[3]=l):l=e[3];let d;e[4]!==s||e[5]!==o?(d=()=>{s(),o("openModalAddTenant")},e[4]=s,e[5]=o,e[6]=d):d=e[6];let f;e[7]===Symbol.for("react.memo_cache_sentinel")?(f=r(_t,{className:"h-3 w-3"}),e[7]=f):f=e[7];let h;e[8]!==d?(h=r(Y,{size:"sm",variant:"ghost",onClick:d,type:"button",children:f}),e[8]=d,e[9]=h):h=e[9];let m;e[10]!==t?(m=()=>t(),e[10]=t,e[11]=m):m=e[11];let b;e[12]===Symbol.for("react.memo_cache_sentinel")?(b=r(Kt,{className:"h-3 w-3"}),e[12]=b):b=e[12];let D;e[13]!==m?(D=r(Y,{size:"sm",variant:"ghost",onClick:m,type:"button",children:b}),e[13]=m,e[14]=D):D=e[14];let g;e[15]!==h||e[16]!==D?(g=p("div",{className:"flex gap-1",children:[h,D]}),e[15]=h,e[16]=D,e[17]=g):g=e[17];let x;e[18]!==l||e[19]!==g?(x=p("div",{className:"flex items-center justify-between",children:[l,g]}),e[18]=l,e[19]=g,e[20]=x):x=e[20];let I;e[21]!==i.professionalStatus?(I=sa(i.professionalStatus),e[21]=i.professionalStatus,e[22]=I):I=e[22];let S;e[23]!==I?(S=r(ot,{variant:"ocean",className:"w-fit text-xs font-normal scale-85 origin-left",children:I}),e[23]=I,e[24]=S):S=e[24];let C;e[25]!==x||e[26]!==S?(C=p(Ct,{className:"pb-3",children:[x,S]}),e[25]=x,e[26]=S,e[27]=C):C=e[27];let F;e[28]!==i.tenant.naturalEntity.phone?(F=i?.tenant?.naturalEntity?.phone?.phoneFormated&&p("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r(ft,{className:"h-3 w-3"}),i.tenant.naturalEntity.phone.phoneFormated]}),e[28]=i.tenant.naturalEntity.phone,e[29]=F):F=e[29];let v;e[30]!==i.tenant.naturalEntity.email?(v=i?.tenant?.naturalEntity?.email&&p("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r(ht,{className:"h-3 w-3"}),i.tenant.naturalEntity.email]}),e[30]=i.tenant.naturalEntity.email,e[31]=v):v=e[31];let y;e[32]!==i.incomes?(y=i?.incomes!=null&&r("div",{className:"flex items-center gap-2 text-muted-foreground",children:p("span",{className:"inline-flex items-center rounded bg-muted px-2 py-0.5 text-[11px]",children:["Revenus: ",i.incomes.toLocaleString("fr-FR")," €"]})}),e[32]=i.incomes,e[33]=y):y=e[33];let P;e[34]!==F||e[35]!==v||e[36]!==y?(P=p("div",{className:"space-y-1 text-sm",children:[F,v,y]}),e[34]=F,e[35]=v,e[36]=y,e[37]=P):P=e[37];let O;e[38]!==c||e[39]!==n||e[40]!==t||e[41]!==i.guarantors||e[42]!==i.professionalStatus?(O=i.professionalStatus===k.OtherEtudiant&&p(Fe,{children:[r(Lt,{}),p("div",{children:[p("div",{className:"flex items-center justify-between mb-2",children:[p("h4",{className:"text-sm font-medium flex items-center gap-1",children:[r(ta,{className:"h-3 w-3"}),"Garants ",i?.guarantors?.length?i?.guarantors?.length:""]}),r(Y,{size:"sm",variant:"ghost",onClick:c,type:"button",children:r(Ga,{className:"h-3 w-3"})})]}),r(Mn,{handleModalDeteleProfile:t,guarantors:i.guarantors,handleEditGuarantor:n})]})]}),e[38]=c,e[39]=n,e[40]=t,e[41]=i.guarantors,e[42]=i.professionalStatus,e[43]=O):O=e[43];let R;e[44]!==P||e[45]!==O?(R=p(yt,{className:"space-y-3",children:[P,O]}),e[44]=P,e[45]=O,e[46]=R):R=e[46];let U;return e[47]!==C||e[48]!==R?(U=p(gt,{className:"w-full h-fit",children:[C,R]}),e[47]=C,e[48]=R,e[49]=U):U=e[49],U},Mn=a=>{const e=B(4),{guarantors:t,handleModalDeteleProfile:n,handleEditGuarantor:s}=a;let c;return e[0]!==t||e[1]!==s||e[2]!==n?(c=r(Fe,{children:t?.length===0?r("p",{className:"text-xs text-muted-foreground",children:"Aucun garant"}):r("div",{className:"space-y-2",children:t?.map(o=>p("div",{children:[p("div",{className:"flex items-center justify-between p-2  rounded text-xs",children:[p("div",{children:[p("p",{className:"font-medium",children:[o?.guarantor.naturalEntity.firstName," ",o?.guarantor.naturalEntity.lastName]}),p("div",{className:"flex items-center gap-2",children:[r(ot,{variant:"ocean",className:"text-xs font-normal scale-85 origin-left",children:sa(o?.professionalStatus)}),o?.incomes!=null&&p("span",{className:"inline-flex items-center rounded bg-muted px-2 py-0.5 text-[11px] text-muted-foreground",children:[o.incomes.toLocaleString("fr-FR")," €"]})]})]}),p("div",{className:"flex gap-1",children:[r(Y,{size:"sm",variant:"ghost",onClick:()=>{s(o.id)},type:"button",children:r(_t,{className:"h-3 w-3"})}),r(Y,{size:"sm",variant:"ghost",onClick:()=>n(o.id),type:"button",children:r(Kt,{className:"h-3 w-3"})})]})]},o?.id),r(Lt,{})]}))})}),e[0]=t,e[1]=s,e[2]=n,e[3]=c):c=e[3],c},Tn=za("DOCUMENT_ADDED"),Pn=me("document/uploadDocumentUsecase",async(a,{dispatch:e,extra:t})=>{const{documentsApi:n,queryClient:s}=t,c=Ka({params:a.params}).queryKey;console.log(c,"queryKeyRetrieveDocuments");const o=(l,d,f)=>{s.setQueryData(c,h=>h&&h.map(m=>m.id===l.id?{...m,...l,status:d,progressValue:f}:m))},i=l=>{s.setQueryData(c,d=>d?[...d,{...l,status:Be.Creating,progressValue:0}]:[l])};let u="";try{const l=On(a.data.file);if(!l.isValid)throw new qn(`Fichier invalide : ${l.typeError}`);const d=s.getQueryData(c);u=crypto.randomUUID();const f=d!==void 0?d.length:0,h={id:u,ownerProfileId:"",projectId:"",name:a.data.file.name,status:0,documentType:a.data.type,ext:"",position:f+1};i(h);const m=await n.preUploadDocument({data:{contentType:a.data.file.type,documentName:a.data.file.name,documentType:a.data.type,position:f},params:a.params});o({...m.payload.document,id:u},Be.Uploading,0),await n.uploadDocument({data:{file:a.data.file},params:{documentKey:`${m.payload.document.id}${m.payload.document.ext}`,url:m.payload.url,onProgress(b){}}}),o({...m.payload.document,id:u},Be.Uploaded,90),await n.confirmUploadUrl({data:{},params:{...a.params,documentId:m.payload.document.id}}),o({...m.payload.document,id:u},Be.Uploaded,100),e(Tn({dataPreUploadDocument:m.payload,params:a.params,data:a.data})),s.invalidateQueries({queryKey:c})}catch(l){throw s.setQueryData(c,d=>d&&d?.filter(f=>f.id!==u)),l}}),On=a=>!a||a.size<=0?{isValid:!1,typeError:"fileSizeNull"}:na.includes(a.type)?a.size/1024/1024>ja?{isValid:!1,typeError:"fileSizeTooBig"}:{isValid:!0}:{isValid:!1,typeError:"fileTypeNotAccepted"};class qn extends Error{constructor(e){super(e),this.name="UploadError"}}const Un=a=>be({mutationKey:["uploadDocument"],mutationFn:async e=>await a?.(Pn(e)).unwrap()}),Ln=()=>{const a=B(2),e=mt.useRef(null);let t;a[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{e?.current&&e.current.click()},a[0]=t):t=a[0];const n=t;let s;return a[1]===Symbol.for("react.memo_cache_sentinel")?(s={openFileExplorer:n,fileInputRef:e,onFileSelected:kn,clearFileInputCache:()=>{e?.current&&(e.current.value="")}},a[1]=s):s=a[1],s};function kn(a){const{event:e,onChange:t}=a,{files:n}=e.target;if(!n||n.length===0)return;const c={file:Array.from(n),event:e};t(c)}const ca=()=>{const a=Ln(),e=Xe(),t=Un(e),n=ve({mutationKey:t.mutationKey,mutationFn:t.mutationFn,onError:()=>{Jt("Un document n'a pas été téléchargé")}}),s=async(o,i,u)=>{if(!(!o||o.length===0))try{for(let l=0;l<o.length;l++){const d=o[l];await n.mutateAsync({data:{file:d,type:i},params:u})}a.clearFileInputCache()}catch(l){console.error("Erreur lors du traitement des fichiers:",l)}};return{handleUploadDocument:({event:o,documentTypeSmartGarant:i,params:u})=>{if(o.stopPropagation(),o.preventDefault(),"dataTransfer"in o&&o.dataTransfer?.files){const l=Array.from(o.dataTransfer.files);s(l,i,u)}else"target"in o&&o.target?.files&&a.onFileSelected({event:o,onChange:async l=>{await s(l.file,i,u)}})},fileInputRef:a.fileInputRef,openFileExplorer:a}},_n=me("document/deleteDocumentUsecase",async(a,{dispatch:e,extra:t})=>{const{documentsApi:n}=t;try{await n.deleteDocument(a);return}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),Gn=a=>be({mutationKey:["deleteDocument"],mutationFn:async e=>await a?.(_n(e)).unwrap()}),Kn=a=>{const e=B(9),{data:t,onDataChange:n,id:s}=a,{validateDocuments:c}=ra();let o,i;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=new st(N.object({documents:N.any().superRefine(T({fieldType:"documentsStructure",label:"Les documents nécessaires au traitement de la demande :",inputProps:{}}))})),i={documentsStructure:jn},e[0]=o,e[1]=i):(o=e[0],i=e[1]);let u;e[2]!==n||e[3]!==c?(u=d=>{c()?n(d):Jt("Documents manquants")},e[2]=n,e[3]=c,e[4]=u):u=e[4];let l;return e[5]!==t||e[6]!==s||e[7]!==u?(l=r(lt,{schema:o,formComponents:i,onSubmit:u,defaultValues:t,id:s}),e[5]=t,e[6]=s,e[7]=u,e[8]=l):l=e[8],l},jn=a=>{const[e,t]=Ee(null),{handleUploadDocument:n}=ca(),{t:s}=kt(),c=Ft((v,y)=>{v.preventDefault(),v.stopPropagation(),t(y)},[]),o=Ft(v=>{v.preventDefault(),v.stopPropagation(),t(null)},[]),i=Et(),u=Xe(),l=ct(),d=He({data:{},params:{}},u),{data:f}=he(d),{mergeDocuments:h,documentsQueryOption:m,othersDocuments:b}=ra(),D=Gn(u),g=ve({...D}),[x,I]=Ee(0),[S,C]=Ee(h?.length===0),F=Ft(async({documentId:v,entityId:y,documentHolderType:P})=>{await g.mutateAsync({data:{},params:{subscriptionId:f?.id,rentalApprovalId:l.ID_rentalapproval,documentHolderType:P,entityId:y,documentId:v}}),i.invalidateQueries(m.queryKey)},[]);return p("div",{className:"w-full space-y-6",children:[p("div",{className:"flex gap-4 flex-wrap",children:[h.map((v,y)=>p("button",{onClick:()=>{I(y),C(!1)},type:"button",className:`
              flex flex-col items-start p-4 rounded-lg border-2 transition-all duration-200 min-w-[200px]
              ${x===y&&!S?"border-primary bg-primary/5 shadow-md":"border-border bg-card hover:border-primary/50 hover:bg-primary/2"}
            `,children:[r("div",{className:"w-full flex items-center justify-between mb-2",children:p("div",{className:"flex items-center gap-2",children:[r("div",{className:"flex items-center gap-1",children:v.person.role===ut.Guarantor?r(ta,{className:"w-4 h-4 text-primary"}):r(rt,{className:"w-4 h-4 text-muted-foreground"})}),r(ot,{variant:v.person.type?"default":"secondary",className:"text-xs",children:v.person.role===ut.Guarantor?"Garant":"Locataire"})]})}),p("div",{className:"w-full text-left",children:[p("div",{className:"font-medium text-foreground",children:[v.person.naturalEntity.firstName," ",v.person.naturalEntity.lastName]}),p("div",{className:"text-xs text-muted-foreground mt-1",children:[v.completedTypes,"/",v.totalTypes," documents"]})]}),r("div",{className:"w-full mt-3",children:r(wt,{value:v.totalRequired>0?v.totalUploaded/v.totalRequired*100:0,className:"h-2"})})]},v.person.id)),b&&b.length>0&&p("button",{onClick:()=>{C(!0)},type:"button",className:`
              flex flex-col items-start p-4 rounded-lg border-2 transition-all duration-200 min-w-[200px]
              ${S?"border-primary bg-primary/5 shadow-md":"border-border bg-card hover:border-primary/50 hover:bg-primary/2"}
            `,children:[r("div",{className:"w-full flex items-center justify-between mb-2",children:p("div",{className:"flex items-center gap-2",children:[r("div",{className:"flex items-center gap-1",children:r(Rt,{className:"w-4 h-4 text-muted-foreground"})}),r(ot,{variant:"outline",className:"text-xs",children:"Autres"})]})}),p("div",{className:"w-full text-left",children:[r("div",{className:"font-medium text-foreground",children:"Autres documents"}),p("div",{className:"text-xs text-muted-foreground mt-1",children:[b.filter(v=>v.isComplete).length,"/",b.length," documents"]})]}),r("div",{className:"w-full mt-3",children:r(wt,{value:b.length>0?b.filter(v=>v.isComplete).length/b.length*100:0,className:"h-2"})})]})]}),r("div",{className:"",children:p(Aa,{type:"multiple",className:"w-full",children:[!S&&h[x]?.requiredDocuments.map(v=>p(zt,{value:v.id,children:[r($t,{className:"text-md font-medium",children:p("div",{className:"flex justify-between w-full",children:[r("span",{children:s(v.requestedDocument.nameI18nCode)}),p(ot,{variant:"peach",className:"tracking-wider",children:[v.count,"/",v.minRequired]})]})}),p(Qt,{className:"w-full",children:[p("div",{className:`flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-md transition-colors bg-gray-50 ${e===v.id?"border-primary bg-primary/10":"border-gray-300 bg-white"}`,onDragOver:y=>c(y,v.id),onDragLeave:o,onDrop:y=>{y.preventDefault(),y.stopPropagation(),t(null),y.dataTransfer.files&&y.dataTransfer.files.length>0&&n({event:y,documentTypeSmartGarant:v.requestedDocument.type,params:{documentHolderType:h[x].person.role===ut.Guarantor?$e.MilaGuarantor:$e.MilaTenant,subscriptionId:f?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:h[x].person.id}})},children:[r("div",{className:"bg-background mb-2 flex size-11 shrink-0 items-center justify-center rounded-full border","aria-hidden":"true",children:r(Ht,{className:"size-4 opacity-60"})}),r("p",{className:"text-sm text-gray-500 mb-2",children:"Glissez et déposez vos fichiers ici, ou"}),p(Vt,{className:"cursor-pointer",children:[r(Y,{asChild:!0,children:r("span",{children:"Parcourir les fichiers"})}),r(Zt,{className:"sr-only",documentTypeSmartGarant:v.requestedDocument.type,params:{documentHolderType:h[x].person.role===ut.Guarantor?$e.MilaGuarantor:$e.MilaTenant,subscriptionId:f?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:h[x].person.id}})]})]}),r("div",{className:"mt-4 space-y-2",children:v.uploadedDocuments.map(y=>r("div",{className:"space-y-2",children:p("div",{className:It("flex items-center justify-between gap-2 rounded-xl border px-4 py-2",y?.reason?"border border-red-300 bg-red-50":""),children:[r("div",{className:"flex flex-col",children:p("div",{className:"flex items-center gap-3 overflow-hidden",children:[r(Rt,{className:"size-4 shrink-0 opacity-60","aria-hidden":"true"}),p("div",{className:"min-w-0",children:[r("p",{className:"truncate text-[13px] font-medium",children:y.name}),y.status===Be.Uploading?r(wt,{value:y?.progressValue,className:"w-full"}):null,y?.reason&&p("p",{className:"text-[12px] text-red-700 font-medium",title:y.reason,children:["Raison : ",y.reason]})]})]})}),y.status===Be.Uploading?r(Ot,{children:r(Pt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"",children:r(Bt,{})})}):r(Y,{size:"icon",variant:"ghost",type:"button",className:"text-muted-foreground/80 hover:text-foreground -me-2 size-8 hover:bg-transparent",onClick:()=>{F({documentHolderType:h[x].person.role===ut.Guarantor?$e.MilaGuarantor:$e.MilaTenant,documentId:y.id,entityId:h[x].person.id})},"aria-label":"Remove file",children:r(Xt,{className:"size-4","aria-hidden":"true"})})]})},y.id))})]})]},v.id)),S&&b.map(v=>p(zt,{value:v.id,children:[r($t,{className:"text-md font-medium",children:p("div",{className:"flex justify-between w-full",children:[r("span",{children:s(v.requestedDocument.nameI18nCode)}),p(ot,{variant:"peach",className:"tracking-wider",children:[v.count,"/",v.minRequired]})]})}),p(Qt,{className:"w-full",children:[p("div",{className:`flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-md transition-colors bg-gray-50 ${e===v.id?"border-primary bg-primary/10":"border-gray-300 bg-white"}`,onDragOver:y=>c(y,v.id),onDragLeave:o,onDrop:y=>{y.preventDefault(),y.stopPropagation(),t(null),y.dataTransfer.files&&y.dataTransfer.files.length>0&&n({event:y,documentTypeSmartGarant:v.requestedDocument.type,params:{documentHolderType:$e.MilaOther,subscriptionId:f?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:""}})},children:[r("div",{className:"bg-background mb-2 flex size-11 shrink-0 items-center justify-center rounded-full border","aria-hidden":"true",children:r(Ht,{className:"size-4 opacity-60"})}),r("p",{className:"text-sm text-gray-500 mb-2",children:"Glissez et déposez vos fichiers ici, ou"}),p(Vt,{className:"cursor-pointer",children:[r(Y,{asChild:!0,children:r("span",{children:"Parcourir les fichiers"})}),r(Zt,{className:"sr-only",documentTypeSmartGarant:v.requestedDocument.type,params:{documentHolderType:$e.MilaOther,subscriptionId:f?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:""}})]})]}),r("div",{className:"mt-4 space-y-2",children:v.uploadedDocuments.map(y=>r("div",{className:"space-y-2",children:p("div",{className:It("flex items-center justify-between gap-2 rounded-xl border px-4 py-2"),children:[p("div",{className:"flex items-center gap-3 overflow-hidden",children:[r(Rt,{className:"size-4 shrink-0 opacity-60","aria-hidden":"true"}),p("div",{className:"min-w-0",children:[r("p",{className:"truncate text-[13px] font-medium",children:y.name}),y.status===Be.Uploading?r(wt,{value:y?.progressValue,className:"w-full"}):null]})]}),y.status===Be.Uploading?r(Ot,{children:r(Pt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"",children:r(Bt,{})})}):r(Y,{size:"icon",variant:"ghost",type:"button",className:"text-muted-foreground/80 hover:text-foreground -me-2 size-8 hover:bg-transparent",onClick:()=>{F({documentHolderType:$e.MilaOther,documentId:y.id,entityId:""})},"aria-label":"Remove file",children:r(Xt,{className:"size-4","aria-hidden":"true"})})]})},y.id))})]})]},v.id))]})})]})},Zt=a=>{const e=B(9),{fileInputRef:t,handleUploadDocument:n}=ca(),s=a.className;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=na.toString(),e[0]=c):c=e[0];let o;e[1]!==n||e[2]!==a.documentTypeSmartGarant||e[3]!==a.params?(o=u=>n({event:u,documentTypeSmartGarant:a.documentTypeSmartGarant,params:a.params}),e[1]=n,e[2]=a.documentTypeSmartGarant,e[3]=a.params,e[4]=o):o=e[4];let i;return e[5]!==t||e[6]!==a.className||e[7]!==o?(i=r("input",{type:"file",multiple:!0,ref:t,className:s,accept:c,"data-testid":"file-input-document",onChange:o}),e[5]=t,e[6]=a.className,e[7]=o,e[8]=i):i=e[8],i};function zn(a){return Object.values(a).filter(e=>typeof e=="number").map(e=>e.toString())}const $n=me("rentalApprovals/registerPropertyUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putRealEstateLots({data:a.data,params:a.params})}catch(s){throw e(we({typeMessage:De.errorApi})),s}}),da=a=>be({mutationKey:["registerProperty"],mutationFn:async e=>await a?.($n(e)).unwrap()}),Qn=a=>{const e=B(41),{data:t,onDataChange:n,id:s}=a,c=Xe();let o;e[0]!==c?(o=da(c),e[0]=c,e[1]=o):o=e[1];const i=o;let u;e[2]!==n?(u=()=>{n({})},e[2]=n,e[3]=u):u=e[3];let l;e[4]!==i||e[5]!==u?(l={...i,onSuccess:u},e[4]=i,e[5]=u,e[6]=l):l=e[6];const d=ve(l),f=ct();let h;e[7]!==c?(h=He({data:{},params:{}},c),e[7]=c,e[8]=h):h=e[8];const m=h,{data:b}=he(m);let D;e[9]!==d||e[10]!==f.ID_rentalapproval||e[11]!==b?.id?(D=async q=>{await d.mutateAsync({data:q,params:{rentalApprovalId:f.ID_rentalapproval,subscriptionId:b?.id}})},e[9]=d,e[10]=f.ID_rentalapproval,e[11]=b?.id,e[12]=D):D=e[12];const g=D;let x;e[13]!==c||e[14]!==f.ID_rentalapproval||e[15]!==b?.id?(x=dt({data:{},params:{rentalApprovalId:f.ID_rentalapproval,subscriptionId:b?.id}},c),e[13]=c,e[14]=f.ID_rentalapproval,e[15]=b?.id,e[16]=x):x=e[16];const I=x,S=!!f.ID_rentalapproval&&!!b?.id;let C;e[17]!==I||e[18]!==S?(C={...I,enabled:S},e[17]=I,e[18]=S,e[19]=C):C=e[19];const{data:F}=he(C);let v;e[20]===Symbol.for("react.memo_cache_sentinel")?(v=new st(N.object({type:N.enum(zn(pt),{message:"RequiredFields18362"}).superRefine(T({label:"De quel type de bien s'agit-il ?",fieldType:"situation",customData:{data:[{label:"Appartement",value:pt.APARTMENT.toLocaleString(),icon:Se},{label:"Maison",value:pt.HOUSE.toLocaleString(),icon:Ce}]}})),surface:N.coerce.number({message:"champs requis"}).superRefine(T({label:"Surface habitable",inputProps:{required:!1}})),roomsNumber:N.coerce.number({message:"champs requis"}).superRefine(T({label:"Nombre de chambres ",inputProps:{required:!1},shouldRender(q){return Number(q?.type)===pt.APARTMENT}})),floor:N.coerce.number({message:"champs requis"}).superRefine(T({label:"Étage du bien",inputProps:{required:!1},shouldRender(q){return Number(q?.type)===pt.APARTMENT}})),address:N.object({country:N.string().min(1,"Le pays est requis"),address:N.string().min(1,"L'adresse est requise"),fullAddress:N.string(),zipCode:N.string().min(1,"Le code postal est requis"),city:N.string().min(1,"La ville est requise"),isManual:N.boolean()}).superRefine(T({label:"Adresse du logement",fieldType:"address",customData:{showActionSelectedScopeSearch:!1,searchScope:"france"}}))})),e[20]=v):v=e[20];let y;e[21]!==g?(y=async q=>{await g({realEstateLot:{address:q.address,floor:q.floor,roomsNumber:q.roomsNumber,surface:q.surface,type:Number(q.type)}})},e[21]=g,e[22]=y):y=e[22];const P=F?.realEstateLot?.address?.country??"",O=F?.realEstateLot?.address?.fullAddress??"",R=F?.realEstateLot?.address?.address??"",U=F?.realEstateLot?.address?.city??"",A=F?.realEstateLot?.address?.zipCode??"",M=F?.realEstateLot?.address?.isManual??!1;let L;e[23]!==P||e[24]!==O||e[25]!==R||e[26]!==U||e[27]!==A||e[28]!==M?(L={country:P,fullAddress:O,address:R,city:U,zipCode:A,isManual:M},e[23]=P,e[24]=O,e[25]=R,e[26]=U,e[27]=A,e[28]=M,e[29]=L):L=e[29];const K=String(F?.realEstateLot?.type),z=F?.realEstateLot?.floor,Q=F?.realEstateLot?.roomsNumber,$=F?.realEstateLot?.surface;let _;e[30]!==t||e[31]!==L||e[32]!==K||e[33]!==z||e[34]!==Q||e[35]!==$?(_={...t,address:L,type:K,floor:z,roomsNumber:Q,surface:$},e[30]=t,e[31]=L,e[32]=K,e[33]=z,e[34]=Q,e[35]=$,e[36]=_):_=e[36];let E;return e[37]!==s||e[38]!==y||e[39]!==_?(E=r(lt,{schema:v,onSubmit:y,defaultValues:_,id:s}),e[37]=s,e[38]=y,e[39]=_,e[40]=E):E=e[40],E},Vn=me("rentalApprovals/registerConfirmUsecase",async(a,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n,queryClient:s}=t;try{const c=await n.postConfirm({data:{},params:a.params}),o=He({data:{},params:{}},e),i=s.getQueryData(o.queryKey),u=dt({data:{},params:{rentalApprovalId:a.params.rentalApprovalId,subscriptionId:i?.id}},e);return s.invalidateQueries({queryKey:u.queryKey}),s.invalidateQueries({queryKey:["rentalApprovals","subscription",i?.id],exact:!1}),c.payload}catch(c){throw e(we({typeMessage:De.errorApi})),c}}),Bn=a=>be({mutationKey:["registerConfirm"],mutationFn:async e=>await a?.(Vn(e)).unwrap()}),Wt=[{name:"owner",component:nn},{name:"housing",component:Qn},{name:"lease",component:dn},{name:"tenant",component:Sn},{name:"documents",component:Kn}],Ar=function(){const e=B(42),t=mt.useRef(null),n=Xe(),s=ct(),c=ua();let o;e[0]!==n?(o=He({data:{},params:{}},n),e[0]=n,e[1]=o):o=e[1];const i=o,{data:u}=he(i);let l;e[2]!==u?.id||e[3]!==n||e[4]!==s.ID_rentalapproval?(l=dt({data:{},params:{rentalApprovalId:s.ID_rentalapproval,subscriptionId:u?.id}},n),e[2]=u?.id,e[3]=n,e[4]=s.ID_rentalapproval,e[5]=l):l=e[5];const d=l,f=!!s.ID_rentalapproval&&!!u?.id;let h;e[6]!==d||e[7]!==f?(h={...d,enabled:f},e[6]=d,e[7]=f,e[8]=h):h=e[8];const{data:m}=he(h);let b;e:{const H=m,V=H?.status;if(!V){b=0;break e}if(V===Tt.Initialized){b=0;break e}if(V===Tt.Draft){if(!H?.owners||H.owners.length===0){b=0;break e}if(!H?.realEstateLot){b=1;break e}if(!H?.businessData){b=2;break e}if(!H?.tenants||H.tenants.length>=0){b=3;break e}b=0;break e}if(V>=Tt.PendingDocument){b=4;break e}b=0}const D=b;let g;e[9]===Symbol.for("react.memo_cache_sentinel")?(g=[{step:0,title:"Propriétaire"},{step:1,title:"Logement"},{step:2,title:"Bail"},{step:3,title:"Locataires"},{step:4,title:"Documents"}],e[9]=g):g=e[9];const x=g,I=!s.ID_rentalapproval||!!m;let S;e[10]!==n?(S=Bn(n),e[10]=n,e[11]=S):S=e[11];const C=S;let F;e[12]!==c||e[13]!==s.ID_rentalapproval?(F=()=>{c({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:s.ID_rentalapproval},replace:!0})},e[12]=c,e[13]=s.ID_rentalapproval,e[14]=F):F=e[14];let v;e[15]!==C||e[16]!==F?(v={...C,onSuccess:F},e[15]=C,e[16]=F,e[17]=v):v=e[17];const y=ve(v),P=y.isPending;let O;e[18]!==n?(O=oa(n),e[18]=n,e[19]=O):O=e[19];let R;e[20]!==O.mutationKey?(R={mutationKey:O.mutationKey},e[20]=O.mutationKey,e[21]=R):R=e[21];const U=Dt(R);let A;e[22]!==n?(A=ia(n),e[22]=n,e[23]=A):A=e[23];let M;e[24]!==A.mutationKey?(M={mutationKey:A.mutationKey},e[24]=A.mutationKey,e[25]=M):M=e[25];const L=Dt(M);let K;e[26]!==n?(K=da(n),e[26]=n,e[27]=K):K=e[27];let z;e[28]!==K.mutationKey?(z={mutationKey:K.mutationKey},e[28]=K.mutationKey,e[29]=z):z=e[29];const Q=Dt(z);let $;e[30]!==n?($=la(n),e[30]=n,e[31]=$):$=e[31];let _;e[32]!==$.mutationKey?(_={mutationKey:$.mutationKey},e[32]=$.mutationKey,e[33]=_):_=e[33];const E=Dt(_),q=P||!!U||!!L||!!E||!!Q;let J;e[34]===Symbol.for("react.memo_cache_sentinel")?(J=r(xa,{}),e[34]=J):J=e[34];let ee;return e[35]!==u?.id||e[36]!==D||e[37]!==q||e[38]!==y||e[39]!==s.ID_rentalapproval||e[40]!==I?(ee=p(Sa,{children:[J,r("div",{className:"flex flex-1 flex-col overflow-hidden",children:r("div",{className:"@container/main flex flex-1 flex-col gap-2 p-4 min-h-0",children:r("div",{className:"max-w-4/5 mx-auto w-full flex flex-1 flex-col min-h-0",children:I?r(Ca,{defaultFormData:{},ref:t,steps:Wt,initialStepIndex:D,onSubmitApi:async H=>{await y.mutateAsync({data:{},params:{rentalApprovalId:s.ID_rentalapproval,subscriptionId:u?.id}})},children:H=>{const{currentForm:V,prevStep:X,isLastStep:le,currentStepIndex:ye,id:G}=H;return p("div",{className:"flex flex-col gap-2 h-full max-h-[calc(100vh-100px)]",children:[r(Ea,{value:ye,children:x.map(re=>p(Fa,{step:re.step,className:"not-last:flex-1",loading:q,children:[r(Ra,{asChild:!0,children:r(Ma,{})}),re.step<Wt.length&&r(Ta,{})]},re.step))}),p("div",{className:"flex flex-col flex-1 overflow-hidden",children:[r(Pa,{className:"flex-1 overflow-auto pe-4",children:V}),p("div",{className:"border-t px-4 py-3 flex justify-end gap-2 shrink-0 bg-white",children:[ye>0&&r(Y,{onClick:X,variant:"outline",children:"Retour"}),p(Y,{type:"submit",form:G,disabled:q,children:[q?r(Oa,{}):null,le?"Soumettre":"Suivant"]})]})]})]})}}):r(Fe,{children:r("div",{children:"Chargement..."})})})})})]}),e[35]=u?.id,e[36]=D,e[37]=q,e[38]=y,e[39]=s.ID_rentalapproval,e[40]=I,e[41]=ee):ee=e[41],ee};export{Ar as component};
