import{c as Ce,b as H,n as ge,T as je,m as Ne,d as C,e as ee,f as te,g as G,h as ye,i as se,j as t,L as Se,P as Ee,k as P,q as be,r as Y,l as Pe,o as Ie,p as ce,Z as ze,Q as Re,s as De,t as oe,v as Fe,w as _e,x as $e,S as de,y as ke,z as me,A as ue,B as pe,C as xe,D as K,E as he,F as Le,G as X,H as Te,I as ve,J as Oe,K as fe,M as Me,N as qe,U as Z,O as ae,R as ne,V as le,W as ie,X as re,Y as Be,$ as Ge,a0 as Ve,a1 as Ue,a2 as Ke,a3 as Qe,a4 as He}from"./client-snyaW0Tu.js";import{G as y}from"./RentalApproval-Bbii3zj-.js";import{B as J}from"./building-Bq2iw4zI.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Je=Ce("Ellipsis",Ze),We=H("rentalApprovals/initUsecase",async(s,{dispatch:e,extra:a})=>{const{rentalApprovalApi:n}=a;try{return(await n.postInit({data:{},params:{subscriptionId:s.params.subscriptionId}})).payload}catch(l){throw e(ge({typeMessage:je.errorApi})),l}}),Xe=s=>Ne({mutationKey:["init"],mutationFn:async e=>await s?.(We(e)).unwrap()}),Ye=()=>{const s=C.c(13),e=ee(),a=te();let n;s[0]!==e?(n=Xe(e),s[0]=e,s[1]=n):n=s[1];const l=n;let d;s[2]!==e?(d=se({data:{},params:{}},e),s[2]=e,s[3]=d):d=s[3];const i=d,{data:u}=G(i);let m;s[4]!==a||s[5]!==l?(m={...l,onSuccess(o,j,f){a({to:"/creategli/$ID_rentalapproval",params:{ID_rentalapproval:o.id}})}},s[4]=a,s[5]=l,s[6]=m):m=s[6];const c=ye(m);let p;s[7]!==u?.id||s[8]!==c?(p=async()=>{await c.mutateAsync({data:{},params:{subscriptionId:u?.id}})},s[7]=u?.id,s[8]=c,s[9]=p):p=s[9];const x=p;let v;return s[10]!==x||s[11]!==c.isPending?(v={handleInit:x,isLoading:c.isPending},s[10]=x,s[11]=c.isPending,s[12]=v):v=s[12],v},et=()=>{const s=C.c(6),{handleInit:e,isLoading:a}=Ye();let n;s[0]!==a?(n=a?t.jsx(Se,{}):t.jsx(Ee,{className:"h-4 w-4 mr-2"}),s[0]=a,s[1]=n):n=s[1];let l;return s[2]!==e||s[3]!==a||s[4]!==n?(l=t.jsx(t.Fragment,{children:t.jsxs(P,{size:"sm",onClick:e,disabled:a,children:[n,"Nouvelle demande"]})}),s[2]=e,s[3]=a,s[4]=n,s[5]=l):l=s[5],l},tt=H("rentalApprovals/retrieveRentalApprovalsUsecase",async({params:s},{dispatch:e,extra:a})=>{const{rentalApprovalApi:n}=a;try{return(await n.getRentalApprovals({data:{},params:s})).payload}catch(l){throw l}}),st=(s,e)=>be({queryKey:["rentalApprovals","subscription",s.params.subscriptionId,s.params?.limite,s.params?.pageIndex,s.params?.search,s.params?.status,s.params?.groupe],queryFn:async()=>await e?.(tt(s)).unwrap()}),at=(s,e)=>{const a=C.c(4),[n,l]=Y.useState(s);let d,i;return a[0]!==e||a[1]!==s?(d=()=>{const u=setTimeout(()=>{l(s)},e);return()=>{clearTimeout(u)}},i=[s,e],a[0]=e,a[1]=s,a[2]=d,a[3]=i):(d=a[2],i=a[3]),Y.useEffect(d,i),n};var Q=(s=>(s[s.Ongoing=1]="Ongoing",s[s.Active=2]="Active",s[s.Archived=3]="Archived",s))(Q||{});const nt=s=>{const e=C.c(43);let a;e[0]!==s?(a=s===void 0?{}:s,e[0]=s,e[1]=a):a=e[1];const{defaultPageSize:n}=a,l=n===void 0?10:n,d=te();let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={strict:!1},e[2]=i):i=e[2];const u=Pe(i),m=u.q||"",c=u.p||0,p=u.l||l,x=u.st||1;let v;e[3]!==u.sst||e[4]!==m||e[5]!==c||e[6]!==p||e[7]!==x?(v={q:m,p:c,l:p,sst:u.sst,st:x},e[3]=u.sst,e[4]=m,e[5]=c,e[6]=p,e[7]=x,e[8]=v):v=e[8];const o=v,j=at(o.q||"",300);let f;e[9]!==o||e[10]!==d?(f=A=>{const we={...o,...A},Ae=Object.entries(we).reduce(lt,{});d({search:Ae,replace:!0})},e[9]=o,e[10]=d,e[11]=f):f=e[11];const h=f;let N;e[12]!==h?(N=A=>{h({q:A,p:0})},e[12]=h,e[13]=N):N=e[13];const b=N;let R;e[14]!==h?(R=A=>{h({sst:A,p:0})},e[14]=h,e[15]=R):R=e[15];const k=R;let D;e[16]!==h?(D=A=>{h({st:A,p:0})},e[16]=h,e[17]=D):D=e[17];const L=D;let F;e[18]!==h?(F=A=>{h({p:A})},e[18]=h,e[19]=F):F=e[19];const T=F;let I;e[20]!==h?(I=A=>{h({l:A,p:0})},e[20]=h,e[21]=I):I=e[21];const _=I;let z;e[22]!==d?(z=()=>{d({search:{},replace:!0})},e[22]=d,e[23]=z):z=e[23];const $=z,w=o.p||0,S=o.q||"",V=w>0&&S===j;let O;const M=V?S:j,q=o.l||l;let r;e[24]!==w||e[25]!==o.sst||e[26]!==o.st||e[27]!==M||e[28]!==q?(r={search:M,pageIndex:w,limite:q,status:o.sst,groupe:o.st},e[24]=w,e[25]=o.sst,e[26]=o.st,e[27]=M,e[28]=q,e[29]=r):r=e[29],O=r;const g=O,W=o.l||l;let U;return e[30]!==g||e[31]!==w||e[32]!==j||e[33]!==o||e[34]!==$||e[35]!==S||e[36]!==L||e[37]!==T||e[38]!==_||e[39]!==b||e[40]!==k||e[41]!==W?(U={filters:o,search:S,status:o.sst,groupe:o.st,pageIndex:w,pageSize:W,debouncedSearch:j,setSearch:b,setStatus:k,setGroupe:L,setPageIndex:T,setPageSize:_,resetFilters:$,apiParams:g},e[30]=g,e[31]=w,e[32]=j,e[33]=o,e[34]=$,e[35]=S,e[36]=L,e[37]=T,e[38]=_,e[39]=b,e[40]=k,e[41]=W,e[42]=U):U=e[42],U};function lt(s,e){const[a,n]=e;return n!=null&&n!==""&&(s[a]=n),s}const it=H("rentalapprovals/archiveProjectUsecase",async(s,{dispatch:e,extra:a})=>{const{rentalApprovalApi:n,queryClient:l}=a;try{await n.postArchiveProject(s),l.invalidateQueries({queryKey:["rentalApprovals","subscription",s.params.subscriptionId],exact:!1});return}catch(d){throw e(ge({typeMessage:je.errorApi})),d}}),rt=s=>Ne({mutationKey:["archiveProject"],mutationFn:async e=>await s?.(it(e)).unwrap()}),ct=s=>{switch(s){case y.Initialized:return{text:"Initialisé",variant:"gray"};case y.Draft:return{text:"En cours",variant:"outline"};case y.PendingDocument:return{text:"Document en attente",variant:"yellow"};case y.Pending:return{text:"En attente",variant:"blue"};case y.Approved:return{text:"Approuvé",variant:"green"};case y.Rejected:return{text:"Rejeté",variant:"red"};case y.Cancelled:return{text:"Annulé",variant:"faintred"};case y.Active:return{text:"Actif",variant:"forest"};case y.FinishedScheduled:return{text:"Fin programmée",variant:"peach"};case y.Finished:return{text:"Terminé",variant:"ocean"};default:return{text:"Inconnu",variant:"default"}}},E=Ie(),ot=[{label:"Tous",value:void 0},{label:"En cours",value:y.Draft},{label:"Document en attente",value:y.PendingDocument},{label:"En attente",value:y.Pending},{label:"Approuvé",value:y.Approved},{label:"Rejeté",value:y.Rejected},{label:"Annulé",value:y.Cancelled},{label:"Actif",value:y.Active},{label:"Fin programmée",value:y.FinishedScheduled},{label:"Terminé",value:y.Finished}],dt=s=>{const e=C.c(7),{address:a}=s,n=a?.length>50?a.substring(0,50)+"...":a;let l;e[0]!==n?(l=t.jsx(ae,{asChild:!0,children:t.jsx("div",{className:"max-w-xs cursor-help",children:t.jsx("div",{className:"text-sm text-gray-900 font-medium truncate",children:n})})}),e[0]=n,e[1]=l):l=e[1];let d;e[2]!==a?(d=t.jsx(ne,{side:"top",className:"max-w-sm p-3",children:t.jsx("div",{className:"text-sm whitespace-pre-wrap",children:a})}),e[2]=a,e[3]=d):d=e[3];let i;return e[4]!==l||e[5]!==d?(i=t.jsx(le,{children:t.jsxs(ie,{children:[l,d]})}),e[4]=l,e[5]=d,e[6]=i):i=e[6],i},mt=s=>{const e=C.c(27),{owners:a}=s;if(!a||a?.length===0){let b;return e[0]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx("span",{className:"text-gray-400",children:"-"}),e[0]=b):b=e[0],b}const n=a?.[0],l=a?.length-1,d=xt;let i;e[1]!==n.naturalEntity?(i=n.naturalEntity?t.jsx(Z,{className:"h-3 w-3 text-blue-500 flex-shrink-0"}):t.jsx(J,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),e[1]=n.naturalEntity,e[2]=i):i=e[2];let u;e[3]!==n?(u=d(n),e[3]=n,e[4]=u):u=e[4];let m;e[5]!==u?(m=t.jsx("div",{className:"truncate text-sm font-medium",children:u}),e[5]=u,e[6]=m):m=e[6];let c;e[7]!==l?(c=l>0&&t.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[t.jsx(re,{className:"h-3 w-3 text-gray-400"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["+",l," autre",l>1?"s":""]})]}),e[7]=l,e[8]=c):c=e[8];let p;e[9]!==m||e[10]!==c?(p=t.jsxs("div",{className:"min-w-0 flex-1",children:[m,c]}),e[9]=m,e[10]=c,e[11]=p):p=e[11];let x;e[12]!==i||e[13]!==p?(x=t.jsx(ae,{asChild:!0,children:t.jsxs("div",{className:"flex items-center gap-2 cursor-help max-w-[200px]",children:[i,p]})}),e[12]=i,e[13]=p,e[14]=x):x=e[14];const v=a?.length>1?"s":"";let o;e[15]!==v?(o=t.jsxs("div",{className:"font-medium mb-2",children:["Propriétaire",v]}),e[15]=v,e[16]=o):o=e[16];let j;e[17]!==a?(j=a?.map(ht),e[17]=a,e[18]=j):j=e[18];let f;e[19]!==j?(f=t.jsx("div",{className:"space-y-2 max-w-sm",children:j}),e[19]=j,e[20]=f):f=e[20];let h;e[21]!==f||e[22]!==o?(h=t.jsx(ne,{side:"right",className:"p-3",children:t.jsxs("div",{children:[o,f]})}),e[21]=f,e[22]=o,e[23]=h):h=e[23];let N;return e[24]!==h||e[25]!==x?(N=t.jsx(le,{children:t.jsxs(ie,{children:[x,h]})}),e[24]=h,e[25]=x,e[26]=N):N=e[26],N},ut=s=>{const e=C.c(27),{tenants:a}=s;if(!a||a?.length===0){let b;return e[0]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx("span",{}),e[0]=b):b=e[0],b}const n=a?.[0],l=a?.length-1,d=vt;let i;e[1]!==n.tenant?.naturalEntity?(i=n.tenant?.naturalEntity?t.jsx(Z,{className:"h-3 w-3 text-purple-500 flex-shrink-0"}):t.jsx(J,{className:"h-3 w-3 text-orange-500 flex-shrink-0"}),e[1]=n.tenant?.naturalEntity,e[2]=i):i=e[2];let u;e[3]!==n?(u=d(n),e[3]=n,e[4]=u):u=e[4];let m;e[5]!==u?(m=t.jsx("div",{className:"truncate text-sm font-medium",children:u}),e[5]=u,e[6]=m):m=e[6];let c;e[7]!==l?(c=l>0&&t.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[t.jsx(re,{className:"h-3 w-3 text-gray-400"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["+",l," autre",l>1?"s":""]})]}),e[7]=l,e[8]=c):c=e[8];let p;e[9]!==m||e[10]!==c?(p=t.jsxs("div",{className:"min-w-0 flex-1",children:[m,c]}),e[9]=m,e[10]=c,e[11]=p):p=e[11];let x;e[12]!==i||e[13]!==p?(x=t.jsx(ae,{asChild:!0,children:t.jsxs("div",{className:"flex items-center gap-2 cursor-help max-w-[200px]",children:[i,p]})}),e[12]=i,e[13]=p,e[14]=x):x=e[14];const v=a?.length>1?"s":"";let o;e[15]!==v?(o=t.jsxs("div",{className:"font-medium mb-2",children:["Locataire",v]}),e[15]=v,e[16]=o):o=e[16];let j;e[17]!==a?(j=a?.map(ft),e[17]=a,e[18]=j):j=e[18];let f;e[19]!==j?(f=t.jsx("div",{className:"space-y-2 max-w-sm",children:j}),e[19]=j,e[20]=f):f=e[20];let h;e[21]!==f||e[22]!==o?(h=t.jsx(ne,{side:"right",className:"p-3",children:t.jsxs("div",{children:[o,f]})}),e[21]=f,e[22]=o,e[23]=h):h=e[23];let N;return e[24]!==h||e[25]!==x?(N=t.jsx(le,{children:t.jsxs(ie,{children:[x,h]})}),e[24]=h,e[25]=x,e[26]=N):N=e[26],N},pt=()=>{const s=te(),e=ee(),{search:a,status:n,pageIndex:l,pageSize:d,groupe:i,setSearch:u,setStatus:m,setPageIndex:c,setPageSize:p,resetFilters:x,setGroupe:v,apiParams:o}=nt({defaultPageSize:10}),j=se({data:{},params:{}},e),{data:f,isLoading:h}=G(j),N=st({data:{},params:{subscriptionId:f?.id||"",...o}},e),{data:b,isLoading:R,isFetching:k,isError:D}=G({...N,enabled:!!f?.id,placeholderData:Be}),L=rt(e),F=ye(L),T=async r=>{await F.mutateAsync({data:{},params:{rentalApprovalId:r,subscriptionId:f?.id||""}})},I=Y.useMemo(()=>[E.accessor("references.rentalApprovalRef",{id:"rentalApprovalRef",header:"Référence",cell:({getValue:r})=>{const g=r();return t.jsx("span",{className:"text-sm ",children:g||"-"})},enableSorting:!1,size:140}),E.accessor("owners",{id:"owners",header:"Propriétaire(s)",cell:({getValue:r})=>{const g=r();return t.jsx(mt,{owners:g})},enableSorting:!1,size:200}),E.accessor("tenants",{id:"tenants",header:"Locataire(s)",cell:({getValue:r})=>{const g=r();return t.jsx(ut,{tenants:g})},enableSorting:!1,size:200}),E.accessor("realEstateLot.address.fullAddress",{id:"address",header:"Adresse du lot",cell:({getValue:r})=>t.jsx(dt,{address:r()}),enableSorting:!1,size:220}),E.accessor("createDate",{id:"createDate",header:"Date de demande",cell:({getValue:r})=>t.jsx("span",{className:"text-sm",children:new Date(r()).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),enableSorting:!1,size:150}),E.accessor("businessData.rentAmount",{id:"rentAmount",header:"Loyer CC",cell:({getValue:r})=>{const g=r();return t.jsx("span",{className:"font-medium",children:g?`${g.toFixed(2)} €`:""})},enableSorting:!1,size:120}),E.accessor("status",{id:"status",header:"Statut de la demande",cell:({getValue:r})=>{const g=ct(r());return t.jsx("div",{className:"text-center",children:t.jsx(ce,{variant:g.variant,children:g.text})})},enableSorting:!1,size:150}),E.display({id:"actions",header:"Actions",cell:({row:r})=>t.jsx("div",{className:"text-center",children:t.jsxs(ze,{children:[t.jsx(Re,{asChild:!0,children:t.jsx(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(Je,{className:"h-4 w-4"})})}),t.jsxs(De,{align:"end",children:[t.jsx(oe,{onClick:g=>{g.stopPropagation(),s({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:r.original.id}})},children:"Voir détails"}),t.jsx(Fe,{}),t.jsx(oe,{className:"",onClick:async g=>{g.stopPropagation(),await T(r.original.id)},children:r.original.isArchived?"Désarchiver":"Archivé"})]})]})}),size:80})],[s]),_=_e({data:b?.data??[],columns:I,manualPagination:!0,manualSorting:!0,manualFiltering:!0,getCoreRowModel:$e()}),z=h||R,$=b&&b?.data?.length>0,w=b?.rowCount||0,S=Math.ceil(w/d),V=l<S-1,O=l>0,M=l*d+1,q=Math.min((l+1)*d,w);return t.jsxs("div",{className:" w-full",children:[t.jsx("div",{className:"border-b",children:t.jsx("div",{className:" px-6 py-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-semibold text-foreground",children:"Garanties GLI"}),t.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Gérez vos demandes de GLI"})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsx(et,{})})]})})}),t.jsxs("div",{className:"  px-6 py-6",children:[t.jsx("div",{className:"flex items-center gap-1 mb-6",children:[{id:"1",label:"En cours",count:7,value:Q.Ongoing},{id:"2",label:"Actives",count:12,value:Q.Active},{id:"3",label:"Archivées",count:45,value:Q.Archived}].map(r=>t.jsxs(P,{variant:i===r.value?"default":"ghost",size:"sm",onClick:()=>v(r.value),className:"justify-start",children:[r.label,t.jsx(ce,{variant:"ocean",className:"ml-2",children:r.count})]},r.id))}),t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t.jsx(ke,{placeholder:"Rechercher...",className:"pl-9 w-80",value:a,onChange:r=>u(r.target.value)})]}),t.jsxs(me,{value:n?.toString()||"all",onValueChange:r=>m(r==="all"?void 0:Number(r)),children:[t.jsx(ue,{className:"w-48",children:t.jsx(pe,{placeholder:"Statut"})}),t.jsx(xe,{children:ot.map(r=>t.jsx(K,{value:r.value?.toString()||"all",children:r.label},r.value?.toString()||"all"))})]}),t.jsxs(me,{value:d.toString(),onValueChange:r=>p(Number(r)),children:[t.jsx(ue,{className:"w-32",children:t.jsx(pe,{})}),t.jsxs(xe,{children:[t.jsx(K,{value:"10",children:"10 par page"}),t.jsx(K,{value:"25",children:"25 par page"}),t.jsx(K,{value:"50",children:"50 par page"})]})]}),(a||n)&&t.jsx(P,{variant:"outline",size:"sm",onClick:x,children:"Réinitialiser"})]}),$&&t.jsxs("div",{className:"text-sm text-muted-foreground",children:[M,"-",q," sur ",w," résultats"]})]}),z?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{children:"Chargement..."})}):D?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-red-600",children:"Erreur lors du chargement des données"})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"relative shadow-[0_0.7px_0_0_rgba(0,0,0,0.1)] shadow-bottom-only rounded-md",children:[k&&!z&&t.jsx("div",{className:"absolute top-0 left-0 right-0 z-20",children:t.jsx("div",{className:"h-1 bg-gradient-to-r from-primary via-accent to-primary animate-pulse",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-transparent via-background to-transparent opacity-30"})})}),t.jsxs("div",{className:"overflow-x-auto",children:[t.jsx(he,{className:"table-no-hover table-fixed",children:t.jsx(Le,{className:"bg-primary/10 table-header-no-hover",children:_.getHeaderGroups().map(r=>t.jsx(X,{children:r.headers.map(g=>t.jsx(Te,{className:"font-medium",style:{width:`${g.getSize()}px`},children:g.isPlaceholder?null:ve(g.column.columnDef.header,g.getContext())},g.id))},r.id))})}),t.jsx("div",{className:"max-h-[300px] 2xl:max-h-[500px] 3xl:max-h-[900px] overflow-y-auto",children:t.jsx(he,{className:"table-no-hover table-fixed",children:t.jsx(Oe,{children:$?_.getRowModel().rows.map(r=>t.jsx(X,{className:"cursor-pointer",onClick:()=>{s({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:r.original.id}})},children:r.getVisibleCells().map(g=>t.jsx(fe,{style:{width:`${g.column.getSize()}px`},className:"overflow-hidden",children:ve(g.column.columnDef.cell,g.getContext())},g.id))},r.id)):t.jsx(X,{className:"hover:bg-transparent",children:t.jsx(fe,{colSpan:I.length,className:"h-24 text-center",children:t.jsx("div",{className:"w-full",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-12 h-12 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:t.jsx(de,{className:"h-6 w-6 text-muted-foreground"})}),t.jsx("h3",{className:"font-medium mb-1",children:"Aucun résultat"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:a||n?"Aucune garantie GLI ne correspond à vos critères":"Aucune garantie GLI trouvée"})]})})})})})})})]})]}),t.jsxs("div",{className:"flex items-center justify-between mt-6",children:[t.jsx("div",{className:"text-sm text-muted-foreground",children:w>0?t.jsxs(t.Fragment,{children:["Page ",l+1," sur ",Math.max(1,S)," - ",w," résultat",w>1?"s":""]}):"Aucun résultat"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(P,{variant:"outline",size:"sm",onClick:()=>c(0),disabled:!O||w===0,children:"Premier"}),t.jsxs(P,{variant:"outline",size:"sm",onClick:()=>c(l-1),disabled:!O||w===0,children:[t.jsx(Me,{className:"h-4 w-4"}),"Précédent"]}),t.jsxs(P,{variant:"outline",size:"sm",onClick:()=>c(l+1),disabled:!V||w===0,children:["Suivant",t.jsx(qe,{className:"h-4 w-4"})]}),t.jsx(P,{variant:"outline",size:"sm",onClick:()=>c(Math.max(0,S-1)),disabled:!V||w===0,children:"Dernier"})]})]})]})]})]})};function xt(s){return s.naturalEntity?`${s.naturalEntity.firstName} ${s.naturalEntity.lastName}`:s.legalEntity?s.legalEntity.name:"Propriétaire inconnu"}function ht(s,e){return t.jsxs("div",{className:"flex items-center gap-2",children:[s.naturalEntity?t.jsx(Z,{className:"h-3 w-3"}):t.jsx(J,{className:"h-3 w-3"}),t.jsx("span",{className:"text-sm",children:s.naturalEntity?`${s.naturalEntity.firstName} ${s.naturalEntity.lastName}`:s.legalEntity?.name||"Inconnu"})]},s.id)}function vt(s){return s.tenant?.naturalEntity?`${s.tenant.naturalEntity.firstName} ${s.tenant.naturalEntity.lastName}`:s.tenant?.legalEntity?s.tenant.legalEntity.name:"Locataire inconnu"}function ft(s,e){return t.jsxs("div",{className:"flex items-center gap-2",children:[s.tenant?.naturalEntity?t.jsx(Z,{className:"h-3 w-3"}):t.jsx(J,{className:"h-3 w-3"}),t.jsx("span",{className:"text-sm",children:s.tenant?.naturalEntity?`${s.tenant.naturalEntity.firstName} ${s.tenant.naturalEntity.lastName}`:s.tenant?.legalEntity?.name||"Inconnu"})]},s.id)}const gt=H("subscriptions/retrieveKpiUsecase",async(s,{dispatch:e,extra:a})=>{const{subscriptionApi:n}=a;try{return(await n.getKpi(s)).payload}catch(l){throw l}}),jt=(s,e)=>be({queryKey:["kpi"],queryFn:async()=>await e?.(gt(s)).unwrap(),enabled:!!s.params.subscriptionId});function Nt(s){const e=C.c(21),{stats:a}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(re,{size:16,className:"text-[#8B5CF6]"}),e[0]=n):n=e[0];let l;e[1]!==a.totalCandidates?(l=t.jsx(B,{icon:n,value:a.totalCandidates,title:"Total candidats",color:"#8B5CF6"}),e[1]=a.totalCandidates,e[2]=l):l=e[2];let d;e[3]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx(Ge,{size:16,className:"text-[#3B82F6]"}),e[3]=d):d=e[3];let i;e[4]!==a.validatedFiles?(i=t.jsx(B,{icon:d,value:a.validatedFiles,title:"Dossiers validés",color:"#3B82F6"}),e[4]=a.validatedFiles,e[5]=i):i=e[5];let u;e[6]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(Ve,{size:16,className:"text-[#10B981]"}),e[6]=u):u=e[6];let m;e[7]!==a.guaranteedTenants?(m=t.jsx(B,{icon:u,value:a.guaranteedTenants,title:"Locataires garantis",color:"#10B981"}),e[7]=a.guaranteedTenants,e[8]=m):m=e[8];let c;e[9]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(Ue,{size:16,className:"text-[#EF4444]"}),e[9]=c):c=e[9];let p;e[10]!==a.openClaims?(p=t.jsx(B,{icon:c,value:a.openClaims,title:"Sinistres ouverts",color:"#EF4444"}),e[10]=a.openClaims,e[11]=p):p=e[11];let x;e[12]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx(Ke,{size:16,className:"text-[#F59E0B]"}),e[12]=x):x=e[12];let v;e[13]!==a.averageRent?(v=t.jsx(B,{icon:x,value:a.averageRent,title:"Loyer moyen garanti (€)",color:"#F59E0B"}),e[13]=a.averageRent,e[14]=v):v=e[14];let o;return e[15]!==v||e[16]!==l||e[17]!==i||e[18]!==m||e[19]!==p?(o=t.jsx("div",{className:"p-4 bg-white",children:t.jsxs("div",{className:"flex flex-wrap gap-3",children:[l,i,m,p,v]})}),e[15]=v,e[16]=l,e[17]=i,e[18]=m,e[19]=p,e[20]=o):o=e[20],o}function B(s){const e=C.c(15),{icon:a,value:n,title:l,color:d}=s,i=`${d}10`;let u;e[0]!==i?(u={backgroundColor:i},e[0]=i,e[1]=u):u=e[1];let m;e[2]!==a||e[3]!==u?(m=t.jsx("div",{style:u,className:"p-2 rounded-md",children:a}),e[2]=a,e[3]=u,e[4]=m):m=e[4];let c;e[5]!==n?(c=t.jsx("div",{className:"text-xl font-semibold text-gray-800",children:n}),e[5]=n,e[6]=c):c=e[6];let p;e[7]!==l?(p=t.jsx("div",{className:"text-xs text-gray-500",children:l}),e[7]=l,e[8]=p):p=e[8];let x;e[9]!==c||e[10]!==p?(x=t.jsxs("div",{children:[c,p]}),e[9]=c,e[10]=p,e[11]=x):x=e[11];let v;return e[12]!==m||e[13]!==x?(v=t.jsx("div",{className:"flex-1 min-w-[150px] bg-white border border-gray-100 rounded-md shadow-sm p-3",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[m,x]})}),e[12]=m,e[13]=x,e[14]=v):v=e[14],v}const At=function(){const e=C.c(15),a=ee();let n;e[0]!==a?(n=se({data:{},params:{}},a),e[0]=a,e[1]=n):n=e[1];const l=n,{data:d}=G(l);let i;e[2]!==d?.id||e[3]!==a?(i=jt({data:{},params:{subscriptionId:d?.id}},a),e[2]=d?.id,e[3]=a,e[4]=i):i=e[4];const u=i,{data:m}=G(u);let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(Qe,{}),e[5]=c):c=e[5];const p=m?.averageGuaranteedRentAmount??0,x=m?.activeRentalApprovalCount??0,v=m?.claimCount??0,o=m?.rentalApprovalCount??0,j=m?.approvedRentalApprovalCount??0;let f;e[6]!==p||e[7]!==x||e[8]!==v||e[9]!==o||e[10]!==j?(f=t.jsx("div",{className:"",children:t.jsx(Nt,{stats:{averageRent:p,guaranteedTenants:x,openClaims:v,totalCandidates:o,validatedFiles:j}})}),e[6]=p,e[7]=x,e[8]=v,e[9]=o,e[10]=j,e[11]=f):f=e[11];let h;e[12]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("div",{className:"w-full",children:t.jsx(pt,{})}),e[12]=h):h=e[12];let N;return e[13]!==f?(N=t.jsxs(He,{children:[c,t.jsx("div",{className:"flex flex-1 flex-col",children:t.jsxs("div",{className:"@container/main flex flex-1 flex-col gap-2",children:[f,h]})})]}),e[13]=f,e[14]=N):N=e[14],N};export{At as component,Nt as default};
