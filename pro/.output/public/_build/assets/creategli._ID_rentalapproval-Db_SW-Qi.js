import{aG as ct,r as $,aH as fa,aI as ha,c as gt,b as fe,n as we,T as De,m as Ne,aw as ft,d as B,aJ as It,j as a,y as ya,aK as Pt,S as ga,aL as xa,k as Y,aM as Ot,aN as qt,an as rt,ao as de,aq as L,ar as E,as as lt,at as St,a6 as xt,aO as ht,aP as yt,U as nt,a8 as Ct,aQ as Ut,aR as Lt,a5 as Ft,a9 as vt,q as aa,au as va,e as He,h as be,g as ge,i as Xe,aS as ba,P as sa,v as _t,aT as Na,aU as ja,aV as ye,aW as At,ap as Gt,a0 as Ce,aX as Kt,p as ot,aY as wa,aA as Da,ay as Ia,az as Aa,aB as Sa,aC as Ca,aE as Fa,aD as Ea,aF as Ra,aZ as Ma,a_ as na,a$ as wt,b0 as Ta,b1 as Vt,b2 as Bt,b3 as Ht,b4 as Xt,b5 as $e,b6 as Yt,b7 as Et,b8 as Pa,f as Oa,a3 as qa,a4 as ka,b9 as Ua,ba as La,bb as _a,bc as Ga,bd as Ka,be as za,bf as $a,L as Qa}from"./client-snyaW0Tu.js";import{B as zt,a as dt,r as ut,S as ra,b as Va,D as Be,A as la,c as Ba,u as ia,G as pt}from"./useMergeDocuments-VX2MlBXB.js";import{c as oa,P as q,a as je,b as st,d as Rt,R as mt,G as Mt}from"./RentalApproval-Bbii3zj-.js";function Dt(s,e){const t=ct(e);return Ha({filters:{...s,status:"pending"}},t).length}function Zt(s,e){return s.findAll(e.filters).map(t=>e.select?e.select(t):t.state)}function Ha(s={},e){const t=ct(e).getMutationCache(),n=$.useRef(s),r=$.useRef(null);return r.current||(r.current=Zt(t,s)),$.useEffect(()=>{n.current=s}),$.useSyncExternalStore($.useCallback(c=>t.subscribe(()=>{const o=fa(r.current,Zt(t,n.current));r.current!==o&&(r.current=o,ha.schedule(c))}),[t]),()=>r.current,()=>r.current)}/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Fe=gt("Key",Xa);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Tt=gt("Paperclip",Ya);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],$t=gt("Pencil",Za);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Jt=gt("Upload",Ja);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],es=gt("UserPlus",Wa),ts=fe("rentalApprovals/registerOwnersUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.putOwners(s)).payload}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),ca=s=>Ne({mutationKey:["registerOwner"],mutationFn:async e=>await s?.(ts(e)).unwrap()});var Ke=(s=>(s[s.Natural=1]="Natural",s[s.Legal=2]="Legal",s))(Ke||{});function as(s,e){const t=B.c(4),[n,r]=$.useState(s);let c,o;return t[0]!==e||t[1]!==s?(c=()=>{const i=setTimeout(()=>{r(s)},e);return()=>{clearTimeout(i)}},o=[s,e],t[0]=e,t[1]=s,t[2]=c,t[3]=o):(c=t[2],o=t[3]),$.useEffect(c,o),n}function ss(s,e){const t=B.c(4);let n,r;t[0]!==e||t[1]!==s?(n=()=>{const c=o=>{!s.current||s.current.contains(o.target)||e()};return document.addEventListener("mousedown",c),document.addEventListener("touchstart",c),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("touchstart",c)}},r=[s,e],t[0]=e,t[1]=s,t[2]=n,t[3]=r):(n=t[2],r=t[3]),$.useEffect(n,r)}const ns=ft.forwardRef((s,e)=>{const t=B.c(78);let n,r,c,o,i,u,l,d,m,f,p,x,b,y,w;t[0]!==s?({className:r,value:p,onChange:i,onDebouncedChange:l,debounceDelay:x,loading:b,onClear:u,clearable:y,children:n,dropdownClassName:c,showDropdown:w,onDropdownChange:d,onFocus:m,onBlur:o,...f}=s,t[0]=s,t[1]=n,t[2]=r,t[3]=c,t[4]=o,t[5]=i,t[6]=u,t[7]=l,t[8]=d,t[9]=m,t[10]=f,t[11]=p,t[12]=x,t[13]=b,t[14]=y,t[15]=w):(n=t[1],r=t[2],c=t[3],o=t[4],i=t[5],u=t[6],l=t[7],d=t[8],m=t[9],f=t[10],p=t[11],x=t[12],b=t[13],y=t[14],w=t[15]);const N=p===void 0?"":p,D=x===void 0?300:x,I=b===void 0?!1:b,S=y===void 0?!0:y,g=w===void 0?!1:w,[h,R]=$.useState(N),[M,C]=$.useState(!1),P=$.useRef(null),j=as(h,D);let F;t[16]!==h||t[17]!==N?(F=()=>{N!==h&&R(N)},t[16]=h,t[17]=N,t[18]=F):F=t[18];let O;t[19]!==N?(O=[N],t[19]=N,t[20]=O):O=t[20],$.useEffect(F,O);let _;t[21]!==j||t[22]!==l||t[23]!==N?(_=()=>{l&&j!==N&&l(j)},t[21]=j,t[22]=l,t[23]=N,t[24]=_):_=t[24];let K;t[25]!==j||t[26]!==l?(K=[j,l],t[25]=j,t[26]=l,t[27]=K):K=t[27],$.useEffect(_,K);const Q=d?g:M;let z;t[28]!==d?(z=()=>{d?d(!1):C(!1)},t[28]=d,t[29]=z):z=t[29],ss(P,z);let k;t[30]!==n||t[31]!==i||t[32]!==d?(k=ce=>{const he=ce.target.value;R(he),i?.(he),n&&he.length>0&&(d?d(!0):C(!0))},t[30]=n,t[31]=i,t[32]=d,t[33]=k):k=t[33];const A=k;let T;t[34]!==n||t[35]!==h||t[36]!==d||t[37]!==m?(T=ce=>{n&&h.length>0&&(d?d(!0):C(!0)),m?.(ce)},t[34]=n,t[35]=h,t[36]=d,t[37]=m,t[38]=T):T=t[38];const W=T;let ee;t[39]!==o?(ee=ce=>{o?.(ce)},t[39]=o,t[40]=ee):ee=t[40];const H=ee;let V;t[41]!==i||t[42]!==u||t[43]!==d?(V=()=>{R(""),i?.(""),u?.(),d?d(!1):C(!1)},t[41]=i,t[42]=u,t[43]=d,t[44]=V):V=t[44];const X=V,le=S&&h.length>0&&!I;let xe;t[45]===Symbol.for("react.memo_cache_sentinel")?(xe=a.jsx(ga,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t[45]=xe):xe=t[45];const U=le&&"pr-9",ne=I&&"pr-9";let ue;t[46]!==r||t[47]!==U||t[48]!==ne?(ue=It("pl-9",U,ne,r),t[46]=r,t[47]=U,t[48]=ne,t[49]=ue):ue=t[49];let Z;t[50]!==H||t[51]!==W||t[52]!==A||t[53]!==h||t[54]!==f||t[55]!==e||t[56]!==ue?(Z=a.jsx(ya,{ref:e,className:ue,value:h,onChange:A,onFocus:W,onBlur:H,...f}),t[50]=H,t[51]=W,t[52]=A,t[53]=h,t[54]=f,t[55]=e,t[56]=ue,t[57]=Z):Z=t[57];let pe;t[58]!==I?(pe=I&&a.jsx(xa,{className:"h-4 w-4 animate-spin text-muted-foreground"}),t[58]=I,t[59]=pe):pe=t[59];let me;t[60]!==X||t[61]!==le?(me=le&&a.jsx(Y,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:X,children:a.jsx(Ot,{className:"h-3 w-3"})}),t[60]=X,t[61]=le,t[62]=me):me=t[62];let ie;t[63]!==pe||t[64]!==me?(ie=a.jsxs("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[pe,me]}),t[63]=pe,t[64]=me,t[65]=ie):ie=t[65];let re;t[66]!==Z||t[67]!==ie?(re=a.jsxs("div",{className:"relative",children:[xe,Z,ie]}),t[66]=Z,t[67]=ie,t[68]=re):re=t[68];let te;t[69]!==n||t[70]!==c||t[71]!==Q?(te=Q&&n&&a.jsx(Pt.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.1},className:It("absolute top-full z-50 mt-1 w-full rounded-md border bg-popover p-0 text-popover-foreground shadow-md outline-none",c),children:n}),t[69]=n,t[70]=c,t[71]=Q,t[72]=te):te=t[72];let ae;t[73]!==te?(ae=a.jsx(qt,{children:te}),t[73]=te,t[74]=ae):ae=t[74];let oe;return t[75]!==re||t[76]!==ae?(oe=a.jsxs("div",{ref:P,className:"relative w-full",children:[re,ae]}),t[75]=re,t[76]=ae,t[77]=oe):oe=t[77],oe}),rs=s=>{const e=B.c(11),{data:t,onDataChange:n,id:r,onOpenChange:c,openModal:o}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new rt(de({name:L().superRefine(E({label:"Nom de la compagny",inputProps:{required:!1}})),email:L().email("Format e-mail invalide").superRefine(E({label:"Adresse e-mail",inputProps:{required:!1}})),phone:de({phoneNumber:L().min(6,"Numéro requis"),countryCode:L().min(1,"Pays requis")}).superRefine(E({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}}))})),e[0]=i):i=e[0];let u;e[1]!==n?(u=m=>{n(m)},e[1]=n,e[2]=u):u=e[2];let l;e[3]!==t||e[4]!==r||e[5]!==u?(l=a.jsx(lt,{schema:i,onSubmit:u,withSubmit:!0,defaultValues:t,id:r}),e[3]=t,e[4]=r,e[5]=u,e[6]=l):l=e[6];let d;return e[7]!==c||e[8]!==o||e[9]!==l?(d=a.jsx(St,{open:o,onOpenChange:c,title:"Ajouter une personne morale",mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",content:l}),e[7]=c,e[8]=o,e[9]=l,e[10]=d):d=e[10],d},ls=s=>{const e=B.c(11),{data:t,onDataChange:n,id:r,onOpenChange:c,openModal:o}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new rt(de({firstName:L().superRefine(E({label:"Prenom",inputProps:{required:!1}})),lastName:L().superRefine(E({label:"Nom",inputProps:{required:!1}})),email:L().email("Format e-mail invalide").superRefine(E({label:"Adresse e-mail",inputProps:{required:!1}})),phone:de({phoneNumber:L().min(6,"Numéro requis"),countryCode:L().min(1,"Pays requis")}).superRefine(E({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}}))})),e[0]=i):i=e[0];let u;e[1]!==n?(u=m=>{n(m)},e[1]=n,e[2]=u):u=e[2];let l;e[3]!==t||e[4]!==r||e[5]!==u?(l=a.jsx(lt,{schema:i,withSubmit:!0,onSubmit:u,defaultValues:t,id:r}),e[3]=t,e[4]=r,e[5]=u,e[6]=l):l=e[6];let d;return e[7]!==c||e[8]!==o||e[9]!==l?(d=a.jsx(St,{open:o,onOpenChange:c,title:"Ajouter un propriétaire",mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",content:l}),e[7]=c,e[8]=o,e[9]=l,e[10]=d):d=e[10],d},is=s=>{const e=B.c(29),{owner:t,onRemove:n,onChange:r}=s,c=t.type===Ke.Natural,o=t.naturalEntity,i=t.legalEntity;let u;e[0]!==c?(u=c?a.jsx(nt,{className:"h-4 w-4 text-primary"}):a.jsx(zt,{className:"h-5 w-5 text-primary"}),e[0]=c,e[1]=u):u=e[1];const l=c?`${o?.firstName??""} ${o?.lastName??""}`:i?.name??"Entité légale";let d;e[2]!==u||e[3]!==l?(d=a.jsxs(Ct,{className:"flex items-center gap-2 text-base font-medium",children:[u,l]}),e[2]=u,e[3]=l,e[4]=d):d=e[4];const m=c?o?.externalId:i?.externalId;let f;e[5]!==m?(f=a.jsxs(Ut,{className:"text-xs",children:["ID: ",m]}),e[5]=m,e[6]=f):f=e[6];let p;e[7]!==d||e[8]!==f?(p=a.jsxs("div",{children:[d,f]}),e[7]=d,e[8]=f,e[9]=p):p=e[9];let x;e[10]!==r||e[11]!==t.clientId?(x=!!t.clientId&&a.jsx(Y,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,type:"button",children:a.jsx($t,{className:"h-3 w-3"})}),e[10]=r,e[11]=t.clientId,e[12]=x):x=e[12];let b;e[13]===Symbol.for("react.memo_cache_sentinel")?(b=a.jsx(Lt,{className:"h-3 w-3"}),e[13]=b):b=e[13];let y;e[14]!==n?(y=a.jsx(Y,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:text-destructive",onClick:n,type:"button",children:b}),e[14]=n,e[15]=y):y=e[15];let w;e[16]!==x||e[17]!==y?(w=a.jsxs("div",{className:"flex gap-1",children:[x,y]}),e[16]=x,e[17]=y,e[18]=w):w=e[18];let N;e[19]!==w||e[20]!==p?(N=a.jsx(Ft,{className:"pb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[p,w]})}),e[19]=w,e[20]=p,e[21]=N):N=e[21];let D;e[22]!==c||e[23]!==i||e[24]!==o?(D=a.jsx(xt,{className:"space-y-2 text-sm text-muted-foreground",children:c?a.jsxs(a.Fragment,{children:[o?.phone?.phoneFormated&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"h-3 w-3"}),o.phone.phoneFormated]}),o?.email&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yt,{className:"h-3 w-3"}),o.email]})]}):a.jsxs(a.Fragment,{children:[i?.phone?.phoneFormated&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"h-3 w-3"}),i.phone.phoneFormated]}),i?.email&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yt,{className:"h-3 w-3"}),i.email]})]})}),e[22]=c,e[23]=i,e[24]=o,e[25]=D):D=e[25];let I;return e[26]!==N||e[27]!==D?(I=a.jsxs(vt,{className:"w-full max-w-sm transition-all hover:shadow-md hover:bg-accent/40 focus-within:ring-2 focus-within:ring-primary",children:[N,D]}),e[26]=N,e[27]=D,e[28]=I):I=e[28],I},os=fe("rentalApprovals/searchEntitiesUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.getEntities(s)).payload}catch(r){throw r}}),cs=(s,e)=>aa({queryKey:["entities",s.params?.search],queryFn:async()=>await e?.(os(s)).unwrap(),enabled:!!(s.params.subscriptionId||s.params.search)}),ds=fe("rentalApprovals/lastOwnersUsecase",async(s,{extra:e})=>{const{rentalApprovalApi:t}=e;try{return(await t.getLastOwners(s)).payload}catch(n){throw n}}),us=(s,e)=>aa({queryKey:["entities","owners","last",s.params?.subscriptionId,s.params?.count??5],queryFn:async()=>await e?.(ds(s)).unwrap(),enabled:!!s.params?.subscriptionId}),Wt=s=>{const e=B.c(11),{item:t,onClick:n}=s;let r;e[0]!==t||e[1]!==n?(r=()=>n?.(t),e[0]=t,e[1]=n,e[2]=r):r=e[2];const c=r;if(t.type===Ke.Natural&&t.naturalEntity){let i;return e[3]!==c||e[4]!==t.naturalEntity?(i=a.jsx(ps,{naturalEntity:t.naturalEntity,onClick:c}),e[3]=c,e[4]=t.naturalEntity,e[5]=i):i=e[5],i}if(t.type===Ke.Legal&&t.legalEntity){let i;return e[6]!==c||e[7]!==t.legalEntity?(i=a.jsx(ms,{legalEntity:t.legalEntity,onClick:c}),e[6]=c,e[7]=t.legalEntity,e[8]=i):i=e[8],i}let o;return e[9]!==t.id?(o=a.jsx(vt,{className:"mb-2 border-dashed",children:a.jsxs(xt,{className:"py-3 text-xs text-muted-foreground",children:["Type d'entité non reconnu (ID: ",t.id,")"]})}),e[9]=t.id,e[10]=o):o=e[10],o},ps=s=>{const e=B.c(26),{naturalEntity:t,onClick:n}=s;let r;e[0]!==n?(r=x=>(x.key==="Enter"||x.key===" ")&&n(),e[0]=n,e[1]=r):r=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=a.jsx(nt,{className:"h-4 w-4 text-primary"}),e[2]=c):c=e[2];let o;e[3]!==t.firstName||e[4]!==t.lastName?(o=a.jsxs(Ct,{className:"flex items-center gap-2 text-sm font-medium",children:[c,a.jsxs("span",{children:[t.firstName," ",t.lastName]})]}),e[3]=t.firstName,e[4]=t.lastName,e[5]=o):o=e[5];let i;e[6]!==t.externalId?(i=a.jsxs(Ut,{className:"text-xs",children:["ID: ",t.externalId]}),e[6]=t.externalId,e[7]=i):i=e[7];let u;e[8]!==o||e[9]!==i?(u=a.jsxs(Ft,{className:"pb-2",children:[o,i]}),e[8]=o,e[9]=i,e[10]=u):u=e[10];let l;e[11]!==t.birthDate?(l=t.birthDate&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(va,{className:"h-3 w-3"}),new Date(t.birthDate).toLocaleDateString("fr-FR")]}),e[11]=t.birthDate,e[12]=l):l=e[12];let d;e[13]!==t.phone?(d=t?.phone?.phoneFormated&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"h-3 w-3"}),t.phone.phoneFormated]}),e[13]=t.phone,e[14]=d):d=e[14];let m;e[15]!==t.email?(m=t.email&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yt,{className:"h-3 w-3"}),t.email]}),e[15]=t.email,e[16]=m):m=e[16];let f;e[17]!==l||e[18]!==d||e[19]!==m?(f=a.jsxs(xt,{className:"space-y-1.5 text-xs text-muted-foreground",children:[l,d,m]}),e[17]=l,e[18]=d,e[19]=m,e[20]=f):f=e[20];let p;return e[21]!==n||e[22]!==r||e[23]!==u||e[24]!==f?(p=a.jsxs(vt,{role:"button",tabIndex:0,onClick:n,onKeyDown:r,className:"mb-2 cursor-pointer transition-all hover:shadow-md hover:bg-accent/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:[u,f]}),e[21]=n,e[22]=r,e[23]=u,e[24]=f,e[25]=p):p=e[25],p},ms=s=>{const e=B.c(22),{legalEntity:t,onClick:n}=s;let r;e[0]!==n?(r=p=>(p.key==="Enter"||p.key===" ")&&n(),e[0]=n,e[1]=r):r=e[1];let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=a.jsx(zt,{className:"h-4 w-4 text-primary"}),e[2]=c):c=e[2];let o;e[3]!==t.name?(o=a.jsxs(Ct,{className:"flex items-center gap-2 text-sm font-medium",children:[c,a.jsx("span",{children:t.name})]}),e[3]=t.name,e[4]=o):o=e[4];let i;e[5]!==t.externalId?(i=a.jsxs(Ut,{className:"text-xs",children:["ID: ",t.externalId]}),e[5]=t.externalId,e[6]=i):i=e[6];let u;e[7]!==o||e[8]!==i?(u=a.jsxs(Ft,{className:"pb-2",children:[o,i]}),e[7]=o,e[8]=i,e[9]=u):u=e[9];let l;e[10]!==t.phone?(l=t?.phone?.phoneFormated&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ht,{className:"h-3 w-3"}),t.phone.phoneFormated]}),e[10]=t.phone,e[11]=l):l=e[11];let d;e[12]!==t.email?(d=t.email&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yt,{className:"h-3 w-3"}),t.email]}),e[12]=t.email,e[13]=d):d=e[13];let m;e[14]!==l||e[15]!==d?(m=a.jsxs(xt,{className:"space-y-1.5 text-xs text-muted-foreground",children:[l,d]}),e[14]=l,e[15]=d,e[16]=m):m=e[16];let f;return e[17]!==n||e[18]!==r||e[19]!==u||e[20]!==m?(f=a.jsxs(vt,{role:"button",tabIndex:0,onClick:n,onKeyDown:r,className:"mb-2 cursor-pointer transition-all hover:shadow-md hover:bg-accent/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",children:[u,m]}),e[17]=n,e[18]=r,e[19]=u,e[20]=m,e[21]=f):f=e[21],f},fs=s=>{const e=B.c(35),{onDataChange:t,id:n}=s,r=He();let c;e[0]!==r?(c=ca(r),e[0]=r,e[1]=c):c=e[1];const o=c;let i;e[2]!==t?(i=()=>{t({})},e[2]=t,e[3]=i):i=e[3];let u;e[4]!==o||e[5]!==i?(u={...o,onSuccess:i},e[4]=o,e[5]=i,e[6]=u):u=e[6];const l=be(u),d=dt();let m;e[7]!==r?(m=Xe({data:{},params:{}},r),e[7]=r,e[8]=m):m=e[8];const f=m,{data:p}=ge(f),x=ct();let b;e[9]!==r||e[10]!==d.ID_rentalapproval||e[11]!==p?.id?(b=ut({data:{},params:{rentalApprovalId:d.ID_rentalapproval,subscriptionId:p?.id}},r),e[9]=r,e[10]=d.ID_rentalapproval,e[11]=p?.id,e[12]=b):b=e[12];const y=b,w=!!d.ID_rentalapproval&&!!p?.id;let N;e[13]!==y||e[14]!==w?(N={...y,enabled:w},e[13]=y,e[14]=w,e[15]=N):N=e[15];const{data:D}=ge(N);let I;e[16]!==D?.owners?(I=D?.owners.map(ys)??[],e[16]=D?.owners,e[17]=I):I=e[17];const S=I,[g,h]=$.useState(S);let R;e[18]!==l||e[19]!==d.ID_rentalapproval||e[20]!==x||e[21]!==p?.id||e[22]!==y.queryKey?(R=async O=>{await l.mutateAsync({data:{owners:O},params:{rentalApprovalId:d.ID_rentalapproval,subscriptionId:p?.id}}),x.invalidateQueries({queryKey:y.queryKey})},e[18]=l,e[19]=d.ID_rentalapproval,e[20]=x,e[21]=p?.id,e[22]=y.queryKey,e[23]=R):R=e[23];const M=R;let C;e[24]!==M||e[25]!==g?(C=async O=>{O.preventDefault(),await M(g)},e[24]=M,e[25]=g,e[26]=C):C=e[26];let P;e[27]!==n||e[28]!==C?(P=a.jsx("form",{id:n,onSubmit:C}),e[27]=n,e[28]=C,e[29]=P):P=e[29];let j;e[30]!==g?(j=a.jsx(hs,{owners:g,setOwners:h}),e[30]=g,e[31]=j):j=e[31];let F;return e[32]!==P||e[33]!==j?(F=a.jsxs(a.Fragment,{children:[P,j]}),e[32]=P,e[33]=j,e[34]=F):F=e[34],F},hs=s=>{const e=B.c(106),{owners:t,setOwners:n}=s;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={openLegalForm:!1,openNaturalForm:!1,selectId:""},e[0]=r):r=e[0];const[c,o]=$.useState(r),[i,u]=$.useState(""),[l,d]=$.useState(!1),[m,f]=$.useState("openNaturalForm"),p=He();let x;e[1]!==p?(x=Xe({data:{},params:{}},p),e[1]=p,e[2]=x):x=e[2];const b=x,{data:y}=ge(b);let w;e[3]!==p||e[4]!==i||e[5]!==y?.id?(w=cs({data:{},params:{search:i,subscriptionId:y?.id}},p),e[3]=p,e[4]=i,e[5]=y?.id,e[6]=w):w=e[6];const N=w,D=!!y?.id&&i.length>0;let I;e[7]!==N||e[8]!==D?(I={...N,enabled:D},e[7]=N,e[8]=D,e[9]=I):I=e[9];const{data:S,isFetching:g}=ge(I);let h;e[10]!==p||e[11]!==y?.id?(h=us({data:{},params:{subscriptionId:y?.id,count:5}},p),e[10]=p,e[11]=y?.id,e[12]=h):h=e[12];const R=h,M=!!y?.id&&l&&i.length===0;let C;e[13]!==R||e[14]!==M?(C={...R,enabled:M},e[13]=R,e[14]=M,e[15]=C):C=e[15];const{data:P,isFetching:j}=ge(C);let F;e[16]===Symbol.for("react.memo_cache_sentinel")?(F=v=>{o(G=>({...G,[v]:!G[v],selectId:G[v]?"":G.selectId}))},e[16]=F):F=e[16];const O=F;let _;e[17]!==t||e[18]!==n?(_=v=>{const G={ownerId:v.id,type:v.type,naturalEntity:v.type===Ke.Natural?{firstName:v.naturalEntity?.firstName,lastName:v.naturalEntity?.lastName,title:v.naturalEntity?.title,birthDate:v.naturalEntity?.birthDate,email:v.naturalEntity?.email,externalId:v.naturalEntity?.externalId,phone:v.naturalEntity?.phone}:void 0,legalEntity:v.type===Ke.Legal?{name:v.legalEntity?.name,email:v.legalEntity?.email,externalId:v.legalEntity?.externalId,phone:v.legalEntity?.phone}:void 0};t.some(Ve=>Ve.ownerId===v.id)||n(Ve=>[...Ve,G]),u("")},e[17]=t,e[18]=n,e[19]=_):_=e[19];const K=_;let Q;e[20]!==n?(Q=v=>{n(G=>G.filter(se=>v.ownerId?se.ownerId!==v.ownerId:se.clientId!==v.clientId))},e[20]=n,e[21]=Q):Q=e[21];const z=Q;let k;e[22]!==t||e[23]!==c.selectId?(k=c.selectId?t.find(v=>v.clientId===c.selectId):{},e[22]=t,e[23]=c.selectId,e[24]=k):k=e[24];const A=k;let T;e[25]!==l?(T=v=>{u(v),l||d(!0)},e[25]=l,e[26]=T):T=e[26];let W,ee;e[27]===Symbol.for("react.memo_cache_sentinel")?(W=()=>d(!0),ee=()=>u(""),e[27]=W,e[28]=ee):(W=e[27],ee=e[28]);const H=i.length>0?g:j;let V;e[29]!==K||e[30]!==P||e[31]!==i.length||e[32]!==S?.data?(V=a.jsx("div",{className:"max-h-64 overflow-auto",children:i.length>0?a.jsx(a.Fragment,{children:S?.data?.length?a.jsxs("div",{className:"py-1",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-popover px-3 py-2 text-xs text-muted-foreground",children:"Résultats de recherche"}),S?.data?.map(v=>a.jsx(Wt,{item:v,onClick:G=>{K(G),d(!1)}},v.id))]}):a.jsx("div",{className:"px-3 py-4 text-sm text-muted-foreground",children:"Aucun résultat"})}):a.jsx(a.Fragment,{children:P?.length?a.jsxs("div",{className:"py-1",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-popover px-3 py-2 text-xs text-muted-foreground",children:"Derniers propriétaires"}),P?.map(v=>a.jsx(Wt,{item:v,onClick:G=>{K(G),d(!1)}},v.id))]}):a.jsx("div",{className:"px-3 py-4 text-sm text-muted-foreground",children:"Aucune suggestion récente"})})}),e[29]=K,e[30]=P,e[31]=i.length,e[32]=S?.data,e[33]=V):V=e[33];let X;e[34]!==i||e[35]!==l||e[36]!==T||e[37]!==H||e[38]!==V?(X=a.jsx("div",{className:"flex-1",children:a.jsx(ns,{value:i,onChange:T,onFocus:W,onClear:ee,showDropdown:l,onDropdownChange:d,loading:H,placeholder:"Chercher un contact",dropdownClassName:"p-0",children:V})}),e[34]=i,e[35]=l,e[36]=T,e[37]=H,e[38]=V,e[39]=X):X=e[39];let le;e[40]===Symbol.for("react.memo_cache_sentinel")?(le=a.jsx(ba,{asChild:!0,children:a.jsxs(Y,{variant:"default",className:"",children:[a.jsx(sa,{className:"mr-2 h-4 w-4"}),"Nouveau propriétaire"]})}),e[40]=le):le=e[40];let xe;e[41]===Symbol.for("react.memo_cache_sentinel")?(xe=a.jsx("div",{className:"text-sm font-medium",children:"Type de propriétaire"}),e[41]=xe):xe=e[41];const U=m==="openNaturalForm"?"default":"ghost";let ne,ue;e[42]===Symbol.for("react.memo_cache_sentinel")?(ne=()=>f("openNaturalForm"),ue=a.jsx(nt,{className:"mr-2 h-4 w-4"}),e[42]=ne,e[43]=ue):(ne=e[42],ue=e[43]);let Z;e[44]!==U?(Z=a.jsxs(Y,{variant:U,size:"sm",className:"w-full justify-start",onClick:ne,children:[ue,"Particulier"]}),e[44]=U,e[45]=Z):Z=e[45];const pe=m==="openLegalForm"?"default":"ghost";let me,ie;e[46]===Symbol.for("react.memo_cache_sentinel")?(me=()=>f("openLegalForm"),ie=a.jsx(zt,{className:"mr-2 h-4 w-4"}),e[46]=me,e[47]=ie):(me=e[46],ie=e[47]);let re;e[48]!==pe?(re=a.jsxs(Y,{variant:pe,size:"sm",className:"w-full justify-start",onClick:me,children:[ie,"Personne morale"]}),e[48]=pe,e[49]=re):re=e[49];let te;e[50]!==Z||e[51]!==re?(te=a.jsxs("div",{className:"space-y-1",children:[Z,re]}),e[50]=Z,e[51]=re,e[52]=te):te=e[52];let ae;e[53]===Symbol.for("react.memo_cache_sentinel")?(ae=a.jsx(_t,{}),e[53]=ae):ae=e[53];let oe;e[54]!==m?(oe=a.jsx(Y,{size:"sm",className:"w-full",onClick:()=>{O(m)},children:"Ajouter"}),e[54]=m,e[55]=oe):oe=e[55];let ce;e[56]!==te||e[57]!==oe?(ce=a.jsxs(Na,{children:[le,a.jsx(ja,{className:"w-56",children:a.jsxs("div",{className:"space-y-2",children:[xe,te,ae,oe]})})]}),e[56]=te,e[57]=oe,e[58]=ce):ce=e[58];let he;e[59]!==X||e[60]!==ce?(he=a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"flex gap-2",children:[X,ce]})}),e[59]=X,e[60]=ce,e[61]=he):he=e[61];let Ee;e[62]!==t||e[63]!==z?(Ee=t.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["Propriétaires (",t.length,")"]}),a.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3",children:t.map(v=>a.jsx(is,{owner:v,onRemove:()=>z(v),onChange:()=>{v.type===Ke.Legal&&O("openLegalForm"),v.type===Ke.Natural&&O("openNaturalForm"),o(G=>({...G,selectId:v.clientId}))}},v.ownerId||v.clientId))})]}),e[62]=t,e[63]=z,e[64]=Ee):Ee=e[64];let Re;e[65]!==t.length?(Re=t.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"mb-2",children:a.jsx(nt,{className:"h-12 w-12 mx-auto opacity-30"})}),a.jsx("div",{className:"text-sm",children:"Aucun propriétaire ajouté. Recherchez un propriétaire existant ou créez-en un nouveau."})]}),e[65]=t.length,e[66]=Re):Re=e[66];let Me;e[67]!==he||e[68]!==Ee||e[69]!==Re?(Me=a.jsxs("div",{className:"space-y-6",children:[he,Ee,Re]}),e[67]=he,e[68]=Ee,e[69]=Re,e[70]=Me):Me=e[70];const Ye=A?.legalEntity?.name??"",Ze=A?.legalEntity?.email??"",Je=A?.legalEntity?.phone?.phoneFormated??"",Te=A?.legalEntity?.phone?.phoneContryCode??"FR";let Pe;e[71]!==Je||e[72]!==Te?(Pe={phoneNumber:Je,countryCode:Te},e[71]=Je,e[72]=Te,e[73]=Pe):Pe=e[73];let Oe;e[74]!==Ye||e[75]!==Ze||e[76]!==Pe?(Oe={name:Ye,email:Ze,phone:Pe},e[74]=Ye,e[75]=Ze,e[76]=Pe,e[77]=Oe):Oe=e[77];let ve;e[78]!==n||e[79]!==c.selectId?(ve=v=>{c.selectId?(n(G=>G.map(se=>se.clientId===c.selectId?{...se,legalEntity:{name:v.name,email:v.email,phone:{phoneOrigin:v.phone?.phoneNumber,phoneContryCode:v.phone?.countryCode,phoneFormated:v.phone?.phoneNumber}}}:se)),o(gs)):n(G=>[...G,{clientId:window.crypto.randomUUID(),type:Ke.Legal,legalEntity:{name:v.name,email:v.email,phone:{phoneOrigin:v.phone?.phoneNumber,phoneContryCode:v.phone?.countryCode,phoneFormated:v.phone?.phoneNumber}}}]),O("openLegalForm")},e[78]=n,e[79]=c.selectId,e[80]=ve):ve=e[80];let Ie;e[81]===Symbol.for("react.memo_cache_sentinel")?(Ie=()=>O("openLegalForm"),e[81]=Ie):Ie=e[81];let qe;e[82]!==c.openLegalForm||e[83]!==Oe||e[84]!==ve?(qe=a.jsx(rs,{data:Oe,id:"LegalForm21",onDataChange:ve,onOpenChange:Ie,openModal:c.openLegalForm}),e[82]=c.openLegalForm,e[83]=Oe,e[84]=ve,e[85]=qe):qe=e[85];const ke=A?.naturalEntity?.firstName??"",We=A?.naturalEntity?.lastName??"",et=A?.naturalEntity?.email??"",tt=A?.naturalEntity?.phone?.phoneFormated??"",at=A?.naturalEntity?.phone?.phoneContryCode??"FR";let Ue;e[86]!==tt||e[87]!==at?(Ue={phoneNumber:tt,countryCode:at},e[86]=tt,e[87]=at,e[88]=Ue):Ue=e[88];let Le;e[89]!==ke||e[90]!==We||e[91]!==et||e[92]!==Ue?(Le={firstName:ke,lastName:We,email:et,phone:Ue},e[89]=ke,e[90]=We,e[91]=et,e[92]=Ue,e[93]=Le):Le=e[93];let _e;e[94]!==n||e[95]!==c.selectId?(_e=v=>{c.selectId?(n(G=>G.map(se=>se.clientId===c.selectId?{...se,naturalEntity:{firstName:v?.firstName,lastName:v.lastName,title:1,email:v.email,phone:{phoneOrigin:v.phone?.phoneNumber,phoneContryCode:v.phone?.countryCode,phoneFormated:v.phone?.phoneNumber}}}:se)),o(xs)):n(G=>[...G,{clientId:window.crypto.randomUUID(),type:Ke.Natural,naturalEntity:{firstName:v?.firstName,lastName:v.lastName,title:1,email:v.email,phone:{phoneOrigin:v.phone?.phoneNumber,phoneContryCode:v.phone?.countryCode,phoneFormated:v.phone?.phoneNumber}}}]),O("openNaturalForm")},e[94]=n,e[95]=c.selectId,e[96]=_e):_e=e[96];let Ae;e[97]===Symbol.for("react.memo_cache_sentinel")?(Ae=()=>O("openNaturalForm"),e[97]=Ae):Ae=e[97];let Ge;e[98]!==c.openNaturalForm||e[99]!==Le||e[100]!==_e?(Ge=a.jsx(ls,{data:Le,id:"NaturalForm21",onDataChange:_e,onOpenChange:Ae,openModal:c.openNaturalForm}),e[98]=c.openNaturalForm,e[99]=Le,e[100]=_e,e[101]=Ge):Ge=e[101];let Qe;return e[102]!==Me||e[103]!==qe||e[104]!==Ge?(Qe=a.jsxs(a.Fragment,{children:[Me,qe,Ge]}),e[102]=Me,e[103]=qe,e[104]=Ge,e[105]=Qe):Qe=e[105],Qe};function ys(s){return{naturalEntity:{firstName:s.naturalEntity?.firstName,lastName:s.naturalEntity?.lastName,title:s.naturalEntity?.title,birthDate:s.naturalEntity?.birthDate,email:s.naturalEntity?.email,externalId:s.naturalEntity?.externalId,phone:s.naturalEntity?.phone},legalEntity:{name:s.legalEntity?.name,email:s.legalEntity?.email,externalId:s.legalEntity?.externalId,phone:s.legalEntity?.phone},ownerId:s.id,type:s.type}}function gs(s){return{...s,selectId:""}}function xs(s){return{...s,selectId:""}}const vs=fe("rentalApprovals/registerRentalApprovalsUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{return(await n.putRentalApprovals(s)).payload}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),da=s=>Ne({mutationKey:["registerRentalApprovals"],mutationFn:async e=>await s?.(vs(e)).unwrap()});function ze(s){return String(s).toLowerCase()==="true"}const bs=s=>{const e=B.c(39),{onDataChange:t,id:n}=s,r=He(),c=ct(),o=dt();let i;e[0]!==r?(i=Xe({data:{},params:{}},r),e[0]=r,e[1]=i):i=e[1];const u=i,{data:l}=ge(u);let d;e[2]!==r?(d=da(r),e[2]=r,e[3]=d):d=e[3];const m=d;let f;e[4]!==t?(f=()=>{t({})},e[4]=t,e[5]=f):f=e[5];let p;e[6]!==m||e[7]!==f?(p={...m,onSuccess:f},e[6]=m,e[7]=f,e[8]=p):p=e[8];const x=be(p);let b;e[9]!==r||e[10]!==o.ID_rentalapproval||e[11]!==l?.id?(b=ut({data:{},params:{rentalApprovalId:o.ID_rentalapproval,subscriptionId:l?.id}},r),e[9]=r,e[10]=o.ID_rentalapproval,e[11]=l?.id,e[12]=b):b=e[12];const y=b,w=!!o.ID_rentalapproval&&!!l?.id;let N;e[13]!==y||e[14]!==w?(N={...y,enabled:w},e[13]=y,e[14]=w,e[15]=N):N=e[15];const{data:D}=ge(N);let I;e[16]!==x||e[17]!==o.ID_rentalapproval||e[18]!==c||e[19]!==l?.id||e[20]!==y.queryKey?(I=async A=>{await x.mutateAsync({data:{chargesAmount:A?.chargesAmount,hadConflict:ze(A.hadConflict),hasDepartureNotice:ze(A.hasDepartureNotice),hasFurnished:ze(A.hasFurnished),hasVisaleCoverage:ze(A.hasVisaleCoverage),isBalanceUpToDate:ze(A.isBalanceUpToDate),rentAmount:A.rentAmount,sittingTenant:ze(A.sittingTenant),startLeaseDate:A.startLeaseDate},params:{rentalApprovalId:o.ID_rentalapproval,subscriptionId:l?.id}}),c.invalidateQueries({queryKey:y.queryKey})},e[16]=x,e[17]=o.ID_rentalapproval,e[18]=c,e[19]=l?.id,e[20]=y.queryKey,e[21]=I):I=e[21];const S=I,g=Ns;let h;e[22]===Symbol.for("react.memo_cache_sentinel")?(h=new rt(de({hasFurnished:ye(["true","false"]).superRefine(E({label:"Comment le lot est-il loué ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Meublé",value:"true",icon:Ce},{label:"Non Meublé",value:"false",icon:Fe}]}})),sittingTenant:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({label:"S'agit-il de locataires",fieldType:"situation",inputProps:{},customData:{data:[{label:"En place",value:"true",icon:Ce},{label:"Entrants",value:"false",icon:Fe}]}})),startLeaseDate:Gt().superRefine(E({shouldRender(A){return A?.sittingTenant==="true"},label:"Quand le bail a-t-il pris effet ?",fieldType:"datepicker",inputProps:{required:!1}})),rentAmount:At({message:"RequiredFields18362"}).superRefine(E({label:"Loyer hors charges (€)",fieldType:"currency",inputProps:{required:!1}})),chargesAmount:At({message:"RequiredFields18362"}).superRefine(E({label:"Charges (€)",fieldType:"currency",inputProps:{required:!1}})),isBalanceUpToDate:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(A){return g(A)},label:"Les locataires sont-ils à jour du paiement de l'ensemble des loyers et charges dûs ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),hadConflict:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(A){return g(A)},label:"Le propriétaire est-il actuellement en conflit avec ces locataires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),hasDepartureNotice:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(A){return g(A)},label:"L'un des locataires est-il en période de préavis de départ du logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),hasVisaleCoverage:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(A){return g(A)},label:"Les locataires bénéficient-ils de la Garantie Visale ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}}))})),e[22]=h):h=e[22];let R;e[23]!==S?(R=A=>{S(A)},e[23]=S,e[24]=R):R=e[24];const M=D?.businessData?.chargesAmount,C=String(D?.businessData?.hadConflict),P=String(D?.businessData?.hasDepartureNotice),j=String(D?.businessData?.hasFurnished),F=String(D?.businessData?.hasVisaleCoverage),O=String(D?.businessData?.sittingTenant),_=String(D?.businessData?.isBalanceUpToDate),K=D?.businessData?.rentAmount,Q=D?.businessData?.startLeaseDate;let z;e[25]!==M||e[26]!==C||e[27]!==P||e[28]!==j||e[29]!==F||e[30]!==O||e[31]!==_||e[32]!==K||e[33]!==Q?(z={chargesAmount:M,hadConflict:C,hasDepartureNotice:P,hasFurnished:j,hasVisaleCoverage:F,sittingTenant:O,isBalanceUpToDate:_,rentAmount:K,startLeaseDate:Q},e[25]=M,e[26]=C,e[27]=P,e[28]=j,e[29]=F,e[30]=O,e[31]=_,e[32]=K,e[33]=Q,e[34]=z):z=e[34];let k;return e[35]!==n||e[36]!==R||e[37]!==z?(k=a.jsx(lt,{schema:h,onSubmit:R,defaultValues:z,id:n}),e[35]=n,e[36]=R,e[37]=z,e[38]=k):k=e[38],k};function Ns(s){const e=s?.sittingTenant==="true",t=new Date(s.startLeaseDate),n=new Date(t);n.setMonth(n.getMonth()+6);const r=new Date>n;return e&&r}const js=fe("rentalApprovals/registerTenantUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putTenant({data:s.data,params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),ws=s=>Ne({mutationKey:["registerTenant"],mutationFn:async e=>await s?.(js(e)).unwrap()});function kt(s){return Object.keys(s).filter(e=>isNaN(Number(e))).map(e=>String(s[e]))}const Ds=fe("rentalApprovals/registerDeleteTenantUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.deleteTenant({data:s.data,params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Is=s=>Ne({mutationKey:["registerDeleteTenant"],mutationFn:async e=>await s?.(Ds(e)).unwrap()}),As=fe("rentalApprovals/registerModifyTenantUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putUpdateTenant({data:s.data,params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Ss=s=>Ne({mutationKey:["registerModifyTenant"],mutationFn:async e=>await s?.(As(e)).unwrap()}),Cs=fe("rentalApprovals/createRentalApprovalUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.postCreateApproval({data:{},params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),ua=s=>Ne({mutationKey:["createRentalApproval"],mutationFn:async e=>await s?.(Cs(e)).unwrap()}),Fs=fe("rentalApprovals/registerGuarantorUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.postAddGuarantor({data:s.data,params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Es=s=>Ne({mutationKey:["registerGuarantor"],mutationFn:async e=>await s?.(Fs(e)).unwrap()}),Rs=fe("rentalApprovals/registerDeleteGuarantorUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.deleteGuarantor({data:{},params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Ms=s=>Ne({mutationKey:["registerDeleteGuarantor"],mutationFn:async e=>await s?.(Rs(e)).unwrap()}),Ts=fe("rentalApproval/registerModifyGuarantorUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putUpdateGuarantor({data:s.data,params:s.params});return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Ps=s=>Ne({mutationKey:["registerModifyGuarantor"],mutationFn:async e=>await s?.(Ts(e)).unwrap()}),Os=de({id:L(),guarantor:Gt(),professionalStatus:At()});de({id:L(),professionalStatus:At(),guarantors:wa(Os),tenant:de({naturalEntity:de({firstName:L(),lastName:L()})})});const qs=s=>{const e=B.c(100),{data:t,onDataChange:n,id:r}=s;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c={openModalAddTenant:!1,openModalAddGuarantor:!1,openDeleteProfile:!1},e[0]=c):c=e[0];const[o,i]=ft.useState(c);let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u={id:"",guarantorId:"",isUpdateForm:!1},e[1]=u):u=e[1];const[l,d]=ft.useState(u),m=ct(),f=He(),p=dt(),x=ws(f);let b;e[2]!==f?(b=Xe({data:{},params:{}},f),e[2]=f,e[3]=b):b=e[3];const y=b,w=Is(f),N=Ms(f),D=Ss(f),I=Es(f),S=Ps(f),g=be({...D,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),h=be({...S,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),R=be({...I,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),M=be({...w,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),C=be({...N,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),P=be({...x,onSuccess:()=>{m.invalidateQueries({queryKey:F.queryKey}),i({openDeleteProfile:!1,openModalAddGuarantor:!1,openModalAddTenant:!1})}}),{data:j}=ge(y),F=ut({data:{},params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id}},f),O=!!p.ID_rentalapproval&&!!j?.id;let _;e[4]!==F||e[5]!==O?(_={...F,enabled:O},e[4]=F,e[5]=O,e[6]=_):_=e[6];const{data:K}=ge(_);let Q;e[7]!==P||e[8]!==p.ID_rentalapproval||e[9]!==j?.id?(Q=async J=>{await P.mutateAsync({data:J,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id}})},e[7]=P,e[8]=p.ID_rentalapproval,e[9]=j?.id,e[10]=Q):Q=e[10];const z=Q;let k;e[11]!==g||e[12]!==p.ID_rentalapproval||e[13]!==j?.id||e[14]!==l.id?(k=async J=>{await g.mutateAsync({data:J,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id,tenantId:l.id}})},e[11]=g,e[12]=p.ID_rentalapproval,e[13]=j?.id,e[14]=l.id,e[15]=k):k=e[15];const A=k;let T;e[16]!==R||e[17]!==h||e[18]!==p.ID_rentalapproval||e[19]!==j?.id||e[20]!==l.guarantorId||e[21]!==l.id||e[22]!==l.isUpdateForm?(T=async J=>l.isUpdateForm?await h.mutateAsync({data:J,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id,guarantorId:l.guarantorId}}):await R.mutateAsync({data:J,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id,tenantId:l.id}}),e[16]=R,e[17]=h,e[18]=p.ID_rentalapproval,e[19]=j?.id,e[20]=l.guarantorId,e[21]=l.id,e[22]=l.isUpdateForm,e[23]=T):T=e[23];const W=T;let ee;e[24]!==t||e[25]!==C||e[26]!==M||e[27]!==p.ID_rentalapproval||e[28]!==j?.id||e[29]!==l.guarantorId||e[30]!==l.id?(ee=async()=>l.guarantorId?await C.mutateAsync({data:t,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id,tenantId:l.id,guarantorId:l.guarantorId}}):await M.mutateAsync({data:t,params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id,tenantId:l.id}}),e[24]=t,e[25]=C,e[26]=M,e[27]=p.ID_rentalapproval,e[28]=j?.id,e[29]=l.guarantorId,e[30]=l.id,e[31]=ee):ee=e[31];const H=ee;let V;e[32]===Symbol.for("react.memo_cache_sentinel")?(V=J=>{i(Se=>({...Se,[J]:!Se[J]}))},e[32]=V):V=e[32];const X=V;let le;e[33]===Symbol.for("react.memo_cache_sentinel")?(le=function(Se,Nt){if(!Se||!Nt)return null;for(const jt of Se){if(jt.id===Nt)return{type:"tenant",tenant:jt};for(const Qt of jt.guarantors)if(Qt.id===Nt)return{type:"guarantor",tenant:jt,guarantor:Qt}}return null},e[33]=le):le=e[33];const U=le(K?.tenants,l.guarantorId?l.guarantorId:l.id);let ne;e[34]!==f?(ne=ua(f),e[34]=f,e[35]=ne):ne=e[35];const ue=ne;let Z;e[36]!==n?(Z=()=>{n({})},e[36]=n,e[37]=Z):Z=e[37];let pe;e[38]!==ue||e[39]!==Z?(pe={...ue,onSuccess:Z},e[38]=ue,e[39]=Z,e[40]=pe):pe=e[40];const me=be(pe);let ie;e[41]!==me||e[42]!==p.ID_rentalapproval||e[43]!==m||e[44]!==j?.id||e[45]!==F.queryKey?(ie=async J=>{J.preventDefault(),await me.mutateAsync({data:{},params:{rentalApprovalId:p.ID_rentalapproval,subscriptionId:j?.id}}),m.invalidateQueries({queryKey:F.queryKey})},e[41]=me,e[42]=p.ID_rentalapproval,e[43]=m,e[44]=j?.id,e[45]=F.queryKey,e[46]=ie):ie=e[46];const re=ie;let te;e[47]===Symbol.for("react.memo_cache_sentinel")?(te=a.jsxs(Y,{variant:"default",className:"mb-3 ml-auto",onClick:()=>{X("openModalAddTenant"),d({id:"",guarantorId:"",isUpdateForm:!1})},children:[a.jsx(sa,{className:"mr-2 h-4 w-4"}),"Nouveau Locataire"]}),e[47]=te):te=e[47];let ae;e[48]!==re||e[49]!==r||e[50]!==K?.tenants?(ae=a.jsxs("div",{className:"flex flex-col",children:[te,K?.tenants?.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"mb-2",children:a.jsx(nt,{className:"h-12 w-12 mx-auto opacity-30"})}),a.jsx("div",{className:"text-sm",children:"Aucun Locataire ajouté, créez-en un nouveau."})]}):a.jsxs(a.Fragment,{children:[a.jsx("form",{id:r,onSubmit:J=>{re(J)}}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3  2xl:grid-cols-4 gap-4",children:K?.tenants.map(J=>a.jsx(_s,{handleModalDeteleProfile:Se=>{X("openDeleteProfile"),d({id:J.id,guarantorId:Se??"",isUpdateForm:!1})},handleEdit:()=>{d(Se=>({id:J.id,guarantorId:"",isUpdateForm:!0}))},handleAddGuarantor:()=>{d(Se=>({id:J.id,guarantorId:"",isUpdateForm:!1})),X("openModalAddGuarantor")},handleEditGuarantor:Se=>{d(Nt=>({id:J.id,guarantorId:Se,isUpdateForm:!0})),X("openModalAddGuarantor")},toggleModal:X,tenant:J}))})]})]}),e[48]=re,e[49]=r,e[50]=K?.tenants,e[51]=ae):ae=e[51];let oe;e[52]===Symbol.for("react.memo_cache_sentinel")?(oe=()=>X("openModalAddTenant"),e[52]=oe):oe=e[52];const ce=l.isUpdateForm?A:z,he=U?.tenant.tenant.naturalEntity.firstName??"",Ee=U?.tenant.tenant.naturalEntity.lastName??"",Re=U?.tenant.professionalStatus.toString()??"",Me=U?.tenant?.incomes!=null?String(U?.tenant?.incomes):"",Ye=U?.tenant?.tenant?.naturalEntity?.email??"",Ze=U?.tenant?.tenant?.naturalEntity?.phone?.phoneFormated??"",Je=U?.tenant?.tenant?.naturalEntity?.phone?.phoneContryCode??"FR";let Te;e[53]!==Ze||e[54]!==Je?(Te={phoneNumber:Ze,countryCode:Je},e[53]=Ze,e[54]=Je,e[55]=Te):Te=e[55];const Pe=U?.tenant.hasAdditionalIncomes===!0?"true":"false",Oe=U?.tenant.incomesChangeAtLease===!0?"true":"false";let ve;e[56]!==he||e[57]!==Ee||e[58]!==Re||e[59]!==Me||e[60]!==Ye||e[61]!==Te||e[62]!==Pe||e[63]!==Oe?(ve={firstname:he,lastName:Ee,professionalStatus:Re,incomes:Me,email:Ye,phone:Te,hasAdditionalIncomes:Pe,incomesChangeAtLease:Oe},e[56]=he,e[57]=Ee,e[58]=Re,e[59]=Me,e[60]=Ye,e[61]=Te,e[62]=Pe,e[63]=Oe,e[64]=ve):ve=e[64];let Ie;e[65]!==o.openModalAddTenant||e[66]!==l.isUpdateForm||e[67]!==ce||e[68]!==ve?(Ie=a.jsx(ks,{openModal:o.openModalAddTenant,onOpenChange:oe,handleMutation:ce,isUpdate:l.isUpdateForm,data:ve}),e[65]=o.openModalAddTenant,e[66]=l.isUpdateForm,e[67]=ce,e[68]=ve,e[69]=Ie):Ie=e[69];const qe=Us;let ke;e[70]===Symbol.for("react.memo_cache_sentinel")?(ke=()=>X("openModalAddGuarantor"),e[70]=ke):ke=e[70];const We=U?.guarantor?.guarantor?.naturalEntity?.firstName??"",et=U?.guarantor?.guarantor.naturalEntity.lastName??"",tt=U?.guarantor?.professionalStatus.toString()??"",at=U?.guarantor?.incomes!=null?String(U?.guarantor?.incomes):"",Ue=U?.guarantor?.guarantor?.naturalEntity?.email??"",Le=U?.guarantor?.guarantor?.naturalEntity?.phone?.phoneFormated??"",_e=U?.guarantor?.guarantor?.naturalEntity?.phone?.phoneContryCode??"FR";let Ae;e[71]!==Le||e[72]!==_e?(Ae={phoneNumber:Le,countryCode:_e},e[71]=Le,e[72]=_e,e[73]=Ae):Ae=e[73];const Ge=U?.guarantor?.hasAdditionalIncomes===!0?"true":"false",Qe=U?.guarantor?.incomesChangeAtLease===!0?"true":"false",v=U?.guarantor?.link.toString()??"";let G;e[74]!==We||e[75]!==et||e[76]!==tt||e[77]!==at||e[78]!==Ue||e[79]!==Ae||e[80]!==Ge||e[81]!==Qe||e[82]!==v?(G={firstname:We,lastName:et,professionalStatus:tt,incomes:at,email:Ue,phone:Ae,hasAdditionalIncomes:Ge,incomesChangeAtLease:Qe,link:v},e[74]=We,e[75]=et,e[76]=tt,e[77]=at,e[78]=Ue,e[79]=Ae,e[80]=Ge,e[81]=Qe,e[82]=v,e[83]=G):G=e[83];let se;e[84]!==qe||e[85]!==W||e[86]!==o.openModalAddGuarantor||e[87]!==l.isUpdateForm||e[88]!==ke||e[89]!==G?(se=a.jsx(qe,{openModal:o.openModalAddGuarantor,onOpenChange:ke,handleMutation:W,isUpdate:l.isUpdateForm,data:G}),e[84]=qe,e[85]=W,e[86]=o.openModalAddGuarantor,e[87]=l.isUpdateForm,e[88]=ke,e[89]=G,e[90]=se):se=e[90];let Ve;e[91]===Symbol.for("react.memo_cache_sentinel")?(Ve=()=>{X("openDeleteProfile"),d({id:"",guarantorId:"",isUpdateForm:!1})},e[91]=Ve):Ve=e[91];let it;e[92]!==H||e[93]!==o.openDeleteProfile?(it=a.jsx(Ls,{handleModalDeteleProfile:Ve,openDeleteProfile:o.openDeleteProfile,handleMutation:H}),e[92]=H,e[93]=o.openDeleteProfile,e[94]=it):it=e[94];let bt;return e[95]!==ae||e[96]!==Ie||e[97]!==se||e[98]!==it?(bt=a.jsxs(a.Fragment,{children:[ae,Ie,se,it]}),e[95]=ae,e[96]=Ie,e[97]=se,e[98]=it,e[99]=bt):bt=e[99],bt},ks=s=>{const e=B.c(16),{data:t,openModal:n,onOpenChange:r,handleMutation:c,isUpdate:o}=s,i=o===void 0?!1:o,{t:u}=Kt(),l=i?"Modifier un locataire":"Ajouter un locataire";let d;e[0]!==u?(d=u("Submit98432"),e[0]=u,e[1]=d):d=e[1];let m;e[2]!==d?(m=a.jsx(Y,{type:"submit",form:"addTenant",children:d}),e[2]=d,e[3]=m):m=e[3];let f;e[4]===Symbol.for("react.memo_cache_sentinel")?(f=new rt(de({firstname:L({message:"RequiredFields18362"}).nonempty().superRefine(E({label:"Prénom",inputProps:{required:!1}})),lastName:L({message:"RequiredFields18362"}).nonempty().superRefine(E({label:"Nom",inputProps:{required:!1}})),professionalStatus:ye(kt(q)).superRefine(E({label:"Quelle est sa situation professionnelle ?",inputProps:{},customData:{data:[{label:je(q.PrivateCDI),key:q.PrivateCDI},{label:je(q.PrivateCDD),key:q.PrivateCDD},{label:je(q.OtherRetaite),key:q.OtherRetaite},{label:je(q.OtherEtudiant),key:q.OtherEtudiant},{label:"Entreprise",key:q.IndepAuto},{label:je(q.OtherRecherche),key:q.OtherRecherche},{label:je(q.OtherAllowance),key:q.OtherAllowance}]}})),incomes:L({message:"RequiredFields18362"}).superRefine(E({label:"Revenus nets mensuels (€)",inputProps:{type:"number",min:0,step:"1",placeholder:"ex: 2500"}})),email:L().email("Format e-mail invalide").superRefine(E({label:"Adresse e-mail",inputProps:{required:!1}})),phone:de({phoneNumber:L().min(6,"Numéro requis"),countryCode:L().min(1,"Pays requis")}).superRefine(E({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}})),hasAdditionalIncomes:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({label:"A-t-il des sources de revenus complémentaires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),incomesChangeAtLease:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(y){return[q.PrivateCDI.toString(),q.PrivateCDD.toString()].includes(y?.professionalStatus)},label:"Les revenus indiqués sur les bulletins de salaire vont-ils changer à l'entrée du locataire dans le logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}}))})),e[4]=f):f=e[4];let p;e[5]!==c?(p=y=>{c({incomesChangeAtLease:ze(y.incomesChangeAtLease),hasAdditionalIncomes:ze(y.hasAdditionalIncomes),professionalStatus:Number(y.professionalStatus),incomes:y.incomes?Number(y.incomes):void 0,naturalEntity:{firstName:y.firstname,lastName:y.lastName,title:1,email:y.email,phone:{phoneOrigin:y.phone?.phoneNumber,phoneContryCode:y.phone?.countryCode,phoneFormated:y.phone?.phoneNumber}}})},e[5]=c,e[6]=p):p=e[6];let x;e[7]!==t||e[8]!==p?(x=a.jsx(lt,{schema:f,onSubmit:p,defaultValues:t,id:"addTenant"}),e[7]=t,e[8]=p,e[9]=x):x=e[9];let b;return e[10]!==r||e[11]!==n||e[12]!==l||e[13]!==m||e[14]!==x?(b=a.jsx(St,{open:n,onOpenChange:r,title:l,mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",footer:m,content:x}),e[10]=r,e[11]=n,e[12]=l,e[13]=m,e[14]=x,e[15]=b):b=e[15],b},Us=s=>{const e=B.c(16),{data:t,openModal:n,onOpenChange:r,handleMutation:c,isUpdate:o}=s,i=o===void 0?!1:o,{t:u}=Kt(),l=i?"Modifier un garant":"Ajouter un garant";let d;e[0]!==u?(d=u("Submit98432"),e[0]=u,e[1]=d):d=e[1];let m;e[2]!==d?(m=a.jsx(Y,{type:"submit",form:"addGuarantor",children:d}),e[2]=d,e[3]=m):m=e[3];let f;e[4]===Symbol.for("react.memo_cache_sentinel")?(f=new rt(de({firstname:L({message:"RequiredFields18362"}).nonempty().superRefine(E({label:"Nom",inputProps:{required:!1}})),lastName:L({message:"RequiredFields18362"}).nonempty().superRefine(E({label:"Prénom",inputProps:{required:!1}})),professionalStatus:ye(kt(q)).superRefine(E({label:"Quelle est sa situation professionnelle ?",inputProps:{},customData:{data:[{label:je(q.PrivateCDI),key:q.PrivateCDI},{label:je(q.PrivateCDD),key:q.PrivateCDD},{label:je(q.OtherRetaite),key:q.OtherRetaite},{label:je(q.IndepAuto),key:q.IndepAuto},{label:je(q.OtherRecherche),key:q.OtherRecherche},{label:je(q.OtherAllowance),key:q.OtherAllowance}]}})),incomes:L({message:"RequiredFields18362"}).superRefine(E({label:"Revenus nets mensuels (€)",inputProps:{type:"number",min:0,step:"1",placeholder:"ex: 1800"}})),email:L().email("Format e-mail invalide").superRefine(E({label:"Adresse e-mail",inputProps:{required:!1}})),phone:de({phoneNumber:L().min(6,"Numéro requis"),countryCode:L().min(1,"Pays requis")}).superRefine(E({label:"Numéro de téléphone",fieldType:"phone",inputProps:{required:!1}})),incomesChangeAtLease:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({shouldRender(y){return[q.PrivateCDI.toString(),q.PrivateCDD.toString()].includes(y?.professionalStatus)},label:"Les revenus indiqués sur les bulletins de salaire vont-ils changer à l'entrée du locataire dans le logement ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),hasAdditionalIncomes:ye(["true","false"],{message:"RequiredFields18362"}).superRefine(E({label:"A-t-il des sources de revenus complémentaires ?",fieldType:"situation",inputProps:{},customData:{data:[{label:"Oui",value:"true",icon:Ce},{label:"Non",value:"false",icon:Fe}]}})),link:ye(kt(st)).superRefine(E({label:"Quel est son lien de parenté avec ce locataire ?",inputProps:{},customData:{data:[{label:Rt(st.FamilyMember),key:st.FamilyMember},{label:Rt(st.Parent),key:st.Parent},{label:Rt(st.Other),key:st.Other}]}}))})),e[4]=f):f=e[4];let p;e[5]!==c?(p=y=>{c({naturalEntity:{firstName:y.firstname,lastName:y.lastName,email:y.email,phone:{phoneOrigin:y.phone?.phoneNumber,phoneContryCode:y.phone?.countryCode,phoneFormated:y.phone?.phoneNumber}},incomes:y.incomes?Number(y.incomes):void 0,hasAdditionalIncomes:ze(y.hasAdditionalIncomes),incomesChangeAtLease:ze(y.incomesChangeAtLease),link:Number(y.link),professionalStatus:Number(y.professionalStatus)})},e[5]=c,e[6]=p):p=e[6];let x;e[7]!==t||e[8]!==p?(x=a.jsx(lt,{schema:f,onSubmit:p,defaultValues:t,id:"addGuarantor"}),e[7]=t,e[8]=p,e[9]=x):x=e[9];let b;return e[10]!==r||e[11]!==n||e[12]!==l||e[13]!==m||e[14]!==x?(b=a.jsx(St,{open:n,onOpenChange:r,title:l,mobileHeight:"auto",mobileModalSide:"bottom",size:"xl",height:"auto",padding:"xl",footer:m,content:x}),e[10]=r,e[11]=n,e[12]=l,e[13]=m,e[14]=x,e[15]=b):b=e[15],b},Ls=s=>{const e=B.c(14),{openDeleteProfile:t,handleModalDeteleProfile:n,handleMutation:r}=s;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=a.jsxs(Da,{children:[a.jsx(Ia,{children:"Supprimer"}),a.jsx(Aa,{children:"Etes vous sûr de vouloir supprimer ce profile ?"})]}),e[0]=c):c=e[0];let o;e[1]!==n?(o=a.jsx(Sa,{onClick:n,children:"Cancel"}),e[1]=n,e[2]=o):o=e[2];let i;e[3]!==r?(i=()=>{r()},e[3]=r,e[4]=i):i=e[4];let u;e[5]===Symbol.for("react.memo_cache_sentinel")?(u=!1,e[5]=u):u=e[5];let l;e[6]!==i?(l=a.jsxs(Ca,{onClick:i,disabled:!1,children:[u,"Remove"]}),e[6]=i,e[7]=l):l=e[7];let d;e[8]!==o||e[9]!==l?(d=a.jsxs(Fa,{children:[c,a.jsxs(Ea,{children:[o,l]})]}),e[8]=o,e[9]=l,e[10]=d):d=e[10];let m;return e[11]!==t||e[12]!==d?(m=a.jsx(Ra,{open:t,children:d}),e[11]=t,e[12]=d,e[13]=m):m=e[13],m},_s=s=>{const e=B.c(50),{handleModalDeteleProfile:t,handleEditGuarantor:n,handleEdit:r,handleAddGuarantor:c,toggleModal:o,tenant:i}=s;let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=a.jsx(nt,{className:"h-4 w-4"}),e[0]=u):u=e[0];let l;e[1]!==i.tenant.naturalEntity.firstName||e[2]!==i.tenant.naturalEntity.lastName?(l=a.jsxs(Ct,{className:"text-lg flex items-center gap-2",children:[u,i.tenant.naturalEntity.firstName," ",i.tenant.naturalEntity.lastName]}),e[1]=i.tenant.naturalEntity.firstName,e[2]=i.tenant.naturalEntity.lastName,e[3]=l):l=e[3];let d;e[4]!==r||e[5]!==o?(d=()=>{r(),o("openModalAddTenant")},e[4]=r,e[5]=o,e[6]=d):d=e[6];let m;e[7]===Symbol.for("react.memo_cache_sentinel")?(m=a.jsx($t,{className:"h-3 w-3"}),e[7]=m):m=e[7];let f;e[8]!==d?(f=a.jsx(Y,{size:"sm",variant:"ghost",onClick:d,type:"button",children:m}),e[8]=d,e[9]=f):f=e[9];let p;e[10]!==t?(p=()=>t(),e[10]=t,e[11]=p):p=e[11];let x;e[12]===Symbol.for("react.memo_cache_sentinel")?(x=a.jsx(Lt,{className:"h-3 w-3"}),e[12]=x):x=e[12];let b;e[13]!==p?(b=a.jsx(Y,{size:"sm",variant:"ghost",onClick:p,type:"button",children:x}),e[13]=p,e[14]=b):b=e[14];let y;e[15]!==f||e[16]!==b?(y=a.jsxs("div",{className:"flex gap-1",children:[f,b]}),e[15]=f,e[16]=b,e[17]=y):y=e[17];let w;e[18]!==l||e[19]!==y?(w=a.jsxs("div",{className:"flex items-center justify-between",children:[l,y]}),e[18]=l,e[19]=y,e[20]=w):w=e[20];let N;e[21]!==i.professionalStatus?(N=oa(i.professionalStatus),e[21]=i.professionalStatus,e[22]=N):N=e[22];let D;e[23]!==N?(D=a.jsx(ot,{variant:"ocean",className:"w-fit text-xs font-normal scale-85 origin-left",children:N}),e[23]=N,e[24]=D):D=e[24];let I;e[25]!==w||e[26]!==D?(I=a.jsxs(Ft,{className:"pb-3",children:[w,D]}),e[25]=w,e[26]=D,e[27]=I):I=e[27];let S;e[28]!==i.tenant.naturalEntity.phone?(S=i?.tenant?.naturalEntity?.phone?.phoneFormated&&a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[a.jsx(ht,{className:"h-3 w-3"}),i.tenant.naturalEntity.phone.phoneFormated]}),e[28]=i.tenant.naturalEntity.phone,e[29]=S):S=e[29];let g;e[30]!==i.tenant.naturalEntity.email?(g=i?.tenant?.naturalEntity?.email&&a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[a.jsx(yt,{className:"h-3 w-3"}),i.tenant.naturalEntity.email]}),e[30]=i.tenant.naturalEntity.email,e[31]=g):g=e[31];let h;e[32]!==i.incomes?(h=i?.incomes!=null&&a.jsx("div",{className:"flex items-center gap-2 text-muted-foreground",children:a.jsxs("span",{className:"inline-flex items-center rounded bg-muted px-2 py-0.5 text-[11px]",children:["Revenus: ",i.incomes.toLocaleString("fr-FR")," €"]})}),e[32]=i.incomes,e[33]=h):h=e[33];let R;e[34]!==S||e[35]!==g||e[36]!==h?(R=a.jsxs("div",{className:"space-y-1 text-sm",children:[S,g,h]}),e[34]=S,e[35]=g,e[36]=h,e[37]=R):R=e[37];let M;e[38]!==c||e[39]!==n||e[40]!==t||e[41]!==i.guarantors||e[42]!==i.professionalStatus?(M=i.professionalStatus===q.OtherEtudiant&&a.jsxs(a.Fragment,{children:[a.jsx(_t,{}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h4",{className:"text-sm font-medium flex items-center gap-1",children:[a.jsx(ra,{className:"h-3 w-3"}),"Garants ",i?.guarantors?.length?i?.guarantors?.length:""]}),a.jsx(Y,{size:"sm",variant:"ghost",onClick:c,type:"button",children:a.jsx(es,{className:"h-3 w-3"})})]}),a.jsx(Gs,{handleModalDeteleProfile:t,guarantors:i.guarantors,handleEditGuarantor:n})]})]}),e[38]=c,e[39]=n,e[40]=t,e[41]=i.guarantors,e[42]=i.professionalStatus,e[43]=M):M=e[43];let C;e[44]!==R||e[45]!==M?(C=a.jsxs(xt,{className:"space-y-3",children:[R,M]}),e[44]=R,e[45]=M,e[46]=C):C=e[46];let P;return e[47]!==I||e[48]!==C?(P=a.jsxs(vt,{className:"w-full h-fit",children:[I,C]}),e[47]=I,e[48]=C,e[49]=P):P=e[49],P},Gs=s=>{const e=B.c(4),{guarantors:t,handleModalDeteleProfile:n,handleEditGuarantor:r}=s;let c;return e[0]!==t||e[1]!==r||e[2]!==n?(c=a.jsx(a.Fragment,{children:t?.length===0?a.jsx("p",{className:"text-xs text-muted-foreground",children:"Aucun garant"}):a.jsx("div",{className:"space-y-2",children:t?.map(o=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between p-2  rounded text-xs",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:[o?.guarantor.naturalEntity.firstName," ",o?.guarantor.naturalEntity.lastName]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ot,{variant:"ocean",className:"text-xs font-normal scale-85 origin-left",children:oa(o?.professionalStatus)}),o?.incomes!=null&&a.jsxs("span",{className:"inline-flex items-center rounded bg-muted px-2 py-0.5 text-[11px] text-muted-foreground",children:[o.incomes.toLocaleString("fr-FR")," €"]})]})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(Y,{size:"sm",variant:"ghost",onClick:()=>{r(o.id)},type:"button",children:a.jsx($t,{className:"h-3 w-3"})}),a.jsx(Y,{size:"sm",variant:"ghost",onClick:()=>n(o.id),type:"button",children:a.jsx(Lt,{className:"h-3 w-3"})})]})]},o?.id),a.jsx(_t,{})]}))})}),e[0]=t,e[1]=r,e[2]=n,e[3]=c):c=e[3],c},Ks=Ma("DOCUMENT_ADDED"),zs=fe("document/uploadDocumentUsecase",async(s,{dispatch:e,extra:t})=>{const{documentsApi:n,queryClient:r}=t,c=Va({params:s.params}).queryKey;console.log(c,"queryKeyRetrieveDocuments");const o=(l,d,m)=>{r.setQueryData(c,f=>f&&f.map(p=>p.id===l.id?{...p,...l,status:d,progressValue:m}:p))},i=l=>{r.setQueryData(c,d=>d?[...d,{...l,status:Be.Creating,progressValue:0}]:[l])};let u="";try{const l=$s(s.data.file);if(!l.isValid)throw new Qs(`Fichier invalide : ${l.typeError}`);const d=r.getQueryData(c);u=crypto.randomUUID();const m=d!==void 0?d.length:0,f={id:u,ownerProfileId:"",projectId:"",name:s.data.file.name,status:0,documentType:s.data.type,ext:"",position:m+1};i(f);const p=await n.preUploadDocument({data:{contentType:s.data.file.type,documentName:s.data.file.name,documentType:s.data.type,position:m},params:s.params});o({...p.payload.document,id:u},Be.Uploading,0),await n.uploadDocument({data:{file:s.data.file},params:{documentKey:`${p.payload.document.id}${p.payload.document.ext}`,url:p.payload.url,onProgress(x){}}}),o({...p.payload.document,id:u},Be.Uploaded,90),await n.confirmUploadUrl({data:{},params:{...s.params,documentId:p.payload.document.id}}),o({...p.payload.document,id:u},Be.Uploaded,100),e(Ks({dataPreUploadDocument:p.payload,params:s.params,data:s.data})),r.invalidateQueries({queryKey:c})}catch(l){throw r.setQueryData(c,d=>d&&d?.filter(m=>m.id!==u)),l}}),$s=s=>!s||s.size<=0?{isValid:!1,typeError:"fileSizeNull"}:la.includes(s.type)?s.size/1024/1024>Ba?{isValid:!1,typeError:"fileSizeTooBig"}:{isValid:!0}:{isValid:!1,typeError:"fileTypeNotAccepted"};class Qs extends Error{constructor(e){super(e),this.name="UploadError"}}const Vs=s=>Ne({mutationKey:["uploadDocument"],mutationFn:async e=>await s?.(zs(e)).unwrap()}),Bs=()=>{const s=B.c(2),e=ft.useRef(null);let t;s[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{e?.current&&e.current.click()},s[0]=t):t=s[0];const n=t;let r;return s[1]===Symbol.for("react.memo_cache_sentinel")?(r={openFileExplorer:n,fileInputRef:e,onFileSelected:Hs,clearFileInputCache:()=>{e?.current&&(e.current.value="")}},s[1]=r):r=s[1],r};function Hs(s){const{event:e,onChange:t}=s,{files:n}=e.target;if(!n||n.length===0)return;const c={file:Array.from(n),event:e};t(c)}const pa=()=>{const s=Bs(),e=He(),t=Vs(e),n=be({mutationKey:t.mutationKey,mutationFn:t.mutationFn,onError:()=>{na("Un document n'a pas été téléchargé")}}),r=async(o,i,u)=>{if(!(!o||o.length===0))try{for(let l=0;l<o.length;l++){const d=o[l];await n.mutateAsync({data:{file:d,type:i},params:u})}s.clearFileInputCache()}catch(l){console.error("Erreur lors du traitement des fichiers:",l)}};return{handleUploadDocument:({event:o,documentTypeSmartGarant:i,params:u})=>{if(o.stopPropagation(),o.preventDefault(),"dataTransfer"in o&&o.dataTransfer?.files){const l=Array.from(o.dataTransfer.files);r(l,i,u)}else"target"in o&&o.target?.files&&s.onFileSelected({event:o,onChange:async l=>{await r(l.file,i,u)}})},fileInputRef:s.fileInputRef,openFileExplorer:s}},Xs=fe("document/deleteDocumentUsecase",async(s,{dispatch:e,extra:t})=>{const{documentsApi:n}=t;try{await n.deleteDocument(s);return}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),Ys=s=>Ne({mutationKey:["deleteDocument"],mutationFn:async e=>await s?.(Xs(e)).unwrap()}),Zs=s=>{const e=B.c(9),{data:t,onDataChange:n,id:r}=s,{validateDocuments:c}=ia();let o,i;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=new rt(de({documents:Gt().superRefine(E({fieldType:"documentsStructure",label:"Les documents nécessaires au traitement de la demande :",inputProps:{}}))})),i={documentsStructure:Js},e[0]=o,e[1]=i):(o=e[0],i=e[1]);let u;e[2]!==n||e[3]!==c?(u=d=>{c()?n(d):na("Documents manquants")},e[2]=n,e[3]=c,e[4]=u):u=e[4];let l;return e[5]!==t||e[6]!==r||e[7]!==u?(l=a.jsx(lt,{schema:o,formComponents:i,onSubmit:u,defaultValues:t,id:r}),e[5]=t,e[6]=r,e[7]=u,e[8]=l):l=e[8],l},Js=s=>{const[e,t]=$.useState(null),{handleUploadDocument:n}=pa(),{t:r}=Kt(),c=$.useCallback((g,h)=>{g.preventDefault(),g.stopPropagation(),t(h)},[]),o=$.useCallback(g=>{g.preventDefault(),g.stopPropagation(),t(null)},[]),i=ct(),u=He(),l=dt(),d=Xe({data:{},params:{}},u),{data:m}=ge(d),{mergeDocuments:f,documentsQueryOption:p,othersDocuments:x}=ia(),b=Ys(u),y=be({...b}),[w,N]=$.useState(0),[D,I]=$.useState(f?.length===0),S=$.useCallback(async({documentId:g,entityId:h,documentHolderType:R})=>{await y.mutateAsync({data:{},params:{subscriptionId:m?.id,rentalApprovalId:l.ID_rentalapproval,documentHolderType:R,entityId:h,documentId:g}}),i.invalidateQueries(p.queryKey)},[]);return a.jsxs("div",{className:"w-full space-y-6",children:[a.jsxs("div",{className:"flex gap-4 flex-wrap",children:[f.map((g,h)=>a.jsxs("button",{onClick:()=>{N(h),I(!1)},type:"button",className:`
              flex flex-col items-start p-4 rounded-lg border-2 transition-all duration-200 min-w-[200px]
              ${w===h&&!D?"border-primary bg-primary/5 shadow-md":"border-border bg-card hover:border-primary/50 hover:bg-primary/2"}
            `,children:[a.jsx("div",{className:"w-full flex items-center justify-between mb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex items-center gap-1",children:g.person.role===pt.Guarantor?a.jsx(ra,{className:"w-4 h-4 text-primary"}):a.jsx(nt,{className:"w-4 h-4 text-muted-foreground"})}),a.jsx(ot,{variant:g.person.type?"default":"secondary",className:"text-xs",children:g.person.role===pt.Guarantor?"Garant":"Locataire"})]})}),a.jsxs("div",{className:"w-full text-left",children:[a.jsxs("div",{className:"font-medium text-foreground",children:[g.person.naturalEntity.firstName," ",g.person.naturalEntity.lastName]}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[g.completedTypes,"/",g.totalTypes," documents"]})]}),a.jsx("div",{className:"w-full mt-3",children:a.jsx(wt,{value:g.totalRequired>0?g.totalUploaded/g.totalRequired*100:0,className:"h-2"})})]},g.person.id)),x&&x.length>0&&a.jsxs("button",{onClick:()=>{I(!0)},type:"button",className:`
              flex flex-col items-start p-4 rounded-lg border-2 transition-all duration-200 min-w-[200px]
              ${D?"border-primary bg-primary/5 shadow-md":"border-border bg-card hover:border-primary/50 hover:bg-primary/2"}
            `,children:[a.jsx("div",{className:"w-full flex items-center justify-between mb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex items-center gap-1",children:a.jsx(Tt,{className:"w-4 h-4 text-muted-foreground"})}),a.jsx(ot,{variant:"outline",className:"text-xs",children:"Autres"})]})}),a.jsxs("div",{className:"w-full text-left",children:[a.jsx("div",{className:"font-medium text-foreground",children:"Autres documents"}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[x.filter(g=>g.isComplete).length,"/",x.length," documents"]})]}),a.jsx("div",{className:"w-full mt-3",children:a.jsx(wt,{value:x.length>0?x.filter(g=>g.isComplete).length/x.length*100:0,className:"h-2"})})]})]}),a.jsx("div",{className:"",children:a.jsxs(Ta,{type:"multiple",className:"w-full",children:[!D&&f[w]?.requiredDocuments.map(g=>a.jsxs(Vt,{value:g.id,children:[a.jsx(Bt,{className:"text-md font-medium",children:a.jsxs("div",{className:"flex justify-between w-full",children:[a.jsx("span",{children:r(g.requestedDocument.nameI18nCode)}),a.jsxs(ot,{variant:"peach",className:"tracking-wider",children:[g.count,"/",g.minRequired]})]})}),a.jsxs(Ht,{className:"w-full",children:[a.jsxs("div",{className:`flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-md transition-colors bg-gray-50 ${e===g.id?"border-primary bg-primary/10":"border-gray-300 bg-white"}`,onDragOver:h=>c(h,g.id),onDragLeave:o,onDrop:h=>{h.preventDefault(),h.stopPropagation(),t(null),h.dataTransfer.files&&h.dataTransfer.files.length>0&&n({event:h,documentTypeSmartGarant:g.requestedDocument.type,params:{documentHolderType:f[w].person.role===pt.Guarantor?$e.MilaGuarantor:$e.MilaTenant,subscriptionId:m?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:f[w].person.id}})},children:[a.jsx("div",{className:"bg-background mb-2 flex size-11 shrink-0 items-center justify-center rounded-full border","aria-hidden":"true",children:a.jsx(Jt,{className:"size-4 opacity-60"})}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Glissez et déposez vos fichiers ici, ou"}),a.jsxs(Xt,{className:"cursor-pointer",children:[a.jsx(Y,{asChild:!0,children:a.jsx("span",{children:"Parcourir les fichiers"})}),a.jsx(ea,{className:"sr-only",documentTypeSmartGarant:g.requestedDocument.type,params:{documentHolderType:f[w].person.role===pt.Guarantor?$e.MilaGuarantor:$e.MilaTenant,subscriptionId:m?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:f[w].person.id}})]})]}),a.jsx("div",{className:"mt-4 space-y-2",children:g.uploadedDocuments.map(h=>a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:It("flex items-center justify-between gap-2 rounded-xl border px-4 py-2",h?.reason?"border border-red-300 bg-red-50":""),children:[a.jsx("div",{className:"flex flex-col",children:a.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[a.jsx(Tt,{className:"size-4 shrink-0 opacity-60","aria-hidden":"true"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"truncate text-[13px] font-medium",children:h.name}),h.status===Be.Uploading?a.jsx(wt,{value:h?.progressValue,className:"w-full"}):null,h?.reason&&a.jsxs("p",{className:"text-[12px] text-red-700 font-medium",title:h.reason,children:["Raison : ",h.reason]})]})]})}),h.status===Be.Uploading?a.jsx(qt,{children:a.jsx(Pt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"",children:a.jsx(Yt,{})})}):a.jsx(Y,{size:"icon",variant:"ghost",type:"button",className:"text-muted-foreground/80 hover:text-foreground -me-2 size-8 hover:bg-transparent",onClick:()=>{S({documentHolderType:f[w].person.role===pt.Guarantor?$e.MilaGuarantor:$e.MilaTenant,documentId:h.id,entityId:f[w].person.id})},"aria-label":"Remove file",children:a.jsx(Ot,{className:"size-4","aria-hidden":"true"})})]})},h.id))})]})]},g.id)),D&&x.map(g=>a.jsxs(Vt,{value:g.id,children:[a.jsx(Bt,{className:"text-md font-medium",children:a.jsxs("div",{className:"flex justify-between w-full",children:[a.jsx("span",{children:r(g.requestedDocument.nameI18nCode)}),a.jsxs(ot,{variant:"peach",className:"tracking-wider",children:[g.count,"/",g.minRequired]})]})}),a.jsxs(Ht,{className:"w-full",children:[a.jsxs("div",{className:`flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-md transition-colors bg-gray-50 ${e===g.id?"border-primary bg-primary/10":"border-gray-300 bg-white"}`,onDragOver:h=>c(h,g.id),onDragLeave:o,onDrop:h=>{h.preventDefault(),h.stopPropagation(),t(null),h.dataTransfer.files&&h.dataTransfer.files.length>0&&n({event:h,documentTypeSmartGarant:g.requestedDocument.type,params:{documentHolderType:$e.MilaOther,subscriptionId:m?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:""}})},children:[a.jsx("div",{className:"bg-background mb-2 flex size-11 shrink-0 items-center justify-center rounded-full border","aria-hidden":"true",children:a.jsx(Jt,{className:"size-4 opacity-60"})}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Glissez et déposez vos fichiers ici, ou"}),a.jsxs(Xt,{className:"cursor-pointer",children:[a.jsx(Y,{asChild:!0,children:a.jsx("span",{children:"Parcourir les fichiers"})}),a.jsx(ea,{className:"sr-only",documentTypeSmartGarant:g.requestedDocument.type,params:{documentHolderType:$e.MilaOther,subscriptionId:m?.id,rentalApprovalId:l.ID_rentalapproval,selectId:l.ID_rentalapproval,entityId:""}})]})]}),a.jsx("div",{className:"mt-4 space-y-2",children:g.uploadedDocuments.map(h=>a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:It("flex items-center justify-between gap-2 rounded-xl border px-4 py-2"),children:[a.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[a.jsx(Tt,{className:"size-4 shrink-0 opacity-60","aria-hidden":"true"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"truncate text-[13px] font-medium",children:h.name}),h.status===Be.Uploading?a.jsx(wt,{value:h?.progressValue,className:"w-full"}):null]})]}),h.status===Be.Uploading?a.jsx(qt,{children:a.jsx(Pt.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"",children:a.jsx(Yt,{})})}):a.jsx(Y,{size:"icon",variant:"ghost",type:"button",className:"text-muted-foreground/80 hover:text-foreground -me-2 size-8 hover:bg-transparent",onClick:()=>{S({documentHolderType:$e.MilaOther,documentId:h.id,entityId:""})},"aria-label":"Remove file",children:a.jsx(Ot,{className:"size-4","aria-hidden":"true"})})]})},h.id))})]})]},g.id))]})})]})},ea=s=>{const e=B.c(9),{fileInputRef:t,handleUploadDocument:n}=pa(),r=s.className;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=la.toString(),e[0]=c):c=e[0];let o;e[1]!==n||e[2]!==s.documentTypeSmartGarant||e[3]!==s.params?(o=u=>n({event:u,documentTypeSmartGarant:s.documentTypeSmartGarant,params:s.params}),e[1]=n,e[2]=s.documentTypeSmartGarant,e[3]=s.params,e[4]=o):o=e[4];let i;return e[5]!==t||e[6]!==s.className||e[7]!==o?(i=a.jsx("input",{type:"file",multiple:!0,ref:t,className:r,accept:c,"data-testid":"file-input-document",onChange:o}),e[5]=t,e[6]=s.className,e[7]=o,e[8]=i):i=e[8],i};function Ws(s){return Object.values(s).filter(e=>typeof e=="number").map(e=>e.toString())}const en=fe("rentalApprovals/registerPropertyUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n}=t;try{await n.putRealEstateLots({data:s.data,params:s.params})}catch(r){throw e(we({typeMessage:De.errorApi})),r}}),ma=s=>Ne({mutationKey:["registerProperty"],mutationFn:async e=>await s?.(en(e)).unwrap()}),tn=s=>{const e=B.c(41),{data:t,onDataChange:n,id:r}=s,c=He();let o;e[0]!==c?(o=ma(c),e[0]=c,e[1]=o):o=e[1];const i=o;let u;e[2]!==n?(u=()=>{n({})},e[2]=n,e[3]=u):u=e[3];let l;e[4]!==i||e[5]!==u?(l={...i,onSuccess:u},e[4]=i,e[5]=u,e[6]=l):l=e[6];const d=be(l),m=dt();let f;e[7]!==c?(f=Xe({data:{},params:{}},c),e[7]=c,e[8]=f):f=e[8];const p=f,{data:x}=ge(p);let b;e[9]!==d||e[10]!==m.ID_rentalapproval||e[11]!==x?.id?(b=async T=>{await d.mutateAsync({data:T,params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:x?.id}})},e[9]=d,e[10]=m.ID_rentalapproval,e[11]=x?.id,e[12]=b):b=e[12];const y=b;let w;e[13]!==c||e[14]!==m.ID_rentalapproval||e[15]!==x?.id?(w=ut({data:{},params:{rentalApprovalId:m.ID_rentalapproval,subscriptionId:x?.id}},c),e[13]=c,e[14]=m.ID_rentalapproval,e[15]=x?.id,e[16]=w):w=e[16];const N=w,D=!!m.ID_rentalapproval&&!!x?.id;let I;e[17]!==N||e[18]!==D?(I={...N,enabled:D},e[17]=N,e[18]=D,e[19]=I):I=e[19];const{data:S}=ge(I);let g;e[20]===Symbol.for("react.memo_cache_sentinel")?(g=new rt(de({type:ye(Ws(mt),{message:"RequiredFields18362"}).superRefine(E({label:"De quel type de bien s'agit-il ?",fieldType:"situation",customData:{data:[{label:"Appartement",value:mt.APARTMENT.toLocaleString(),icon:Ce},{label:"Maison",value:mt.HOUSE.toLocaleString(),icon:Fe}]}})),surface:Et.number({message:"champs requis"}).superRefine(E({label:"Surface habitable",inputProps:{required:!1}})),roomsNumber:Et.number({message:"champs requis"}).superRefine(E({label:"Nombre de chambres ",inputProps:{required:!1},shouldRender(T){return Number(T?.type)===mt.APARTMENT}})),floor:Et.number({message:"champs requis"}).superRefine(E({label:"Étage du bien",inputProps:{required:!1},shouldRender(T){return Number(T?.type)===mt.APARTMENT}})),address:de({country:L().min(1,"Le pays est requis"),address:L().min(1,"L'adresse est requise"),fullAddress:L(),zipCode:L().min(1,"Le code postal est requis"),city:L().min(1,"La ville est requise"),isManual:Pa()}).superRefine(E({label:"Adresse du logement",fieldType:"address",customData:{showActionSelectedScopeSearch:!1,searchScope:"france"}}))})),e[20]=g):g=e[20];let h;e[21]!==y?(h=async T=>{await y({realEstateLot:{address:T.address,floor:T.floor,roomsNumber:T.roomsNumber,surface:T.surface,type:Number(T.type)}})},e[21]=y,e[22]=h):h=e[22];const R=S?.realEstateLot?.address?.country??"",M=S?.realEstateLot?.address?.fullAddress??"",C=S?.realEstateLot?.address?.address??"",P=S?.realEstateLot?.address?.city??"",j=S?.realEstateLot?.address?.zipCode??"",F=S?.realEstateLot?.address?.isManual??!1;let O;e[23]!==R||e[24]!==M||e[25]!==C||e[26]!==P||e[27]!==j||e[28]!==F?(O={country:R,fullAddress:M,address:C,city:P,zipCode:j,isManual:F},e[23]=R,e[24]=M,e[25]=C,e[26]=P,e[27]=j,e[28]=F,e[29]=O):O=e[29];const _=String(S?.realEstateLot?.type),K=S?.realEstateLot?.floor,Q=S?.realEstateLot?.roomsNumber,z=S?.realEstateLot?.surface;let k;e[30]!==t||e[31]!==O||e[32]!==_||e[33]!==K||e[34]!==Q||e[35]!==z?(k={...t,address:O,type:_,floor:K,roomsNumber:Q,surface:z},e[30]=t,e[31]=O,e[32]=_,e[33]=K,e[34]=Q,e[35]=z,e[36]=k):k=e[36];let A;return e[37]!==r||e[38]!==h||e[39]!==k?(A=a.jsx(lt,{schema:g,onSubmit:h,defaultValues:k,id:r}),e[37]=r,e[38]=h,e[39]=k,e[40]=A):A=e[40],A},an=fe("rentalApprovals/registerConfirmUsecase",async(s,{dispatch:e,extra:t})=>{const{rentalApprovalApi:n,queryClient:r}=t;try{const c=await n.postConfirm({data:{},params:s.params}),o=Xe({data:{},params:{}},e),i=r.getQueryData(o.queryKey),u=ut({data:{},params:{rentalApprovalId:s.params.rentalApprovalId,subscriptionId:i?.id}},e);return r.invalidateQueries({queryKey:u.queryKey}),r.invalidateQueries({queryKey:["rentalApprovals","subscription",i?.id],exact:!1}),c.payload}catch(c){throw e(we({typeMessage:De.errorApi})),c}}),sn=s=>Ne({mutationKey:["registerConfirm"],mutationFn:async e=>await s?.(an(e)).unwrap()}),ta=[{name:"owner",component:fs},{name:"housing",component:tn},{name:"lease",component:bs},{name:"tenant",component:qs},{name:"documents",component:Zs}],on=function(){const e=B.c(42),t=ft.useRef(null),n=He(),r=dt(),c=Oa();let o;e[0]!==n?(o=Xe({data:{},params:{}},n),e[0]=n,e[1]=o):o=e[1];const i=o,{data:u}=ge(i);let l;e[2]!==u?.id||e[3]!==n||e[4]!==r.ID_rentalapproval?(l=ut({data:{},params:{rentalApprovalId:r.ID_rentalapproval,subscriptionId:u?.id}},n),e[2]=u?.id,e[3]=n,e[4]=r.ID_rentalapproval,e[5]=l):l=e[5];const d=l,m=!!r.ID_rentalapproval&&!!u?.id;let f;e[6]!==d||e[7]!==m?(f={...d,enabled:m},e[6]=d,e[7]=m,e[8]=f):f=e[8];const{data:p}=ge(f);let x;e:{const H=p,V=H?.status;if(!V){x=0;break e}if(V===Mt.Initialized){x=0;break e}if(V===Mt.Draft){if(!H?.owners||H.owners.length===0){x=0;break e}if(!H?.realEstateLot){x=1;break e}if(!H?.businessData){x=2;break e}if(!H?.tenants||H.tenants.length>=0){x=3;break e}x=0;break e}if(V>=Mt.PendingDocument){x=4;break e}x=0}const b=x;let y;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=[{step:0,title:"Propriétaire"},{step:1,title:"Logement"},{step:2,title:"Bail"},{step:3,title:"Locataires"},{step:4,title:"Documents"}],e[9]=y):y=e[9];const w=y,N=!r.ID_rentalapproval||!!p;let D;e[10]!==n?(D=sn(n),e[10]=n,e[11]=D):D=e[11];const I=D;let S;e[12]!==c||e[13]!==r.ID_rentalapproval?(S=()=>{c({to:"/gli/$ID_rentalapproval",params:{ID_rentalapproval:r.ID_rentalapproval},replace:!0})},e[12]=c,e[13]=r.ID_rentalapproval,e[14]=S):S=e[14];let g;e[15]!==I||e[16]!==S?(g={...I,onSuccess:S},e[15]=I,e[16]=S,e[17]=g):g=e[17];const h=be(g),R=h.isPending;let M;e[18]!==n?(M=ua(n),e[18]=n,e[19]=M):M=e[19];let C;e[20]!==M.mutationKey?(C={mutationKey:M.mutationKey},e[20]=M.mutationKey,e[21]=C):C=e[21];const P=Dt(C);let j;e[22]!==n?(j=da(n),e[22]=n,e[23]=j):j=e[23];let F;e[24]!==j.mutationKey?(F={mutationKey:j.mutationKey},e[24]=j.mutationKey,e[25]=F):F=e[25];const O=Dt(F);let _;e[26]!==n?(_=ma(n),e[26]=n,e[27]=_):_=e[27];let K;e[28]!==_.mutationKey?(K={mutationKey:_.mutationKey},e[28]=_.mutationKey,e[29]=K):K=e[29];const Q=Dt(K);let z;e[30]!==n?(z=ca(n),e[30]=n,e[31]=z):z=e[31];let k;e[32]!==z.mutationKey?(k={mutationKey:z.mutationKey},e[32]=z.mutationKey,e[33]=k):k=e[33];const A=Dt(k),T=R||!!P||!!O||!!A||!!Q;let W;e[34]===Symbol.for("react.memo_cache_sentinel")?(W=a.jsx(qa,{}),e[34]=W):W=e[34];let ee;return e[35]!==u?.id||e[36]!==b||e[37]!==T||e[38]!==h||e[39]!==r.ID_rentalapproval||e[40]!==N?(ee=a.jsxs(ka,{children:[W,a.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:a.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-4 min-h-0",children:a.jsx("div",{className:"max-w-4/5 mx-auto w-full flex flex-1 flex-col min-h-0",children:N?a.jsx(Ua,{defaultFormData:{},ref:t,steps:ta,initialStepIndex:b,onSubmitApi:async H=>{await h.mutateAsync({data:{},params:{rentalApprovalId:r.ID_rentalapproval,subscriptionId:u?.id}})},children:H=>{const{currentForm:V,prevStep:X,isLastStep:le,currentStepIndex:xe,id:U}=H;return a.jsxs("div",{className:"flex flex-col gap-2 h-full max-h-[calc(100vh-100px)]",children:[a.jsx(La,{value:xe,children:w.map(ne=>a.jsxs(_a,{step:ne.step,className:"not-last:flex-1",loading:T,children:[a.jsx(Ga,{asChild:!0,children:a.jsx(Ka,{})}),ne.step<ta.length&&a.jsx(za,{})]},ne.step))}),a.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[a.jsx($a,{className:"flex-1 overflow-auto pe-4",children:V}),a.jsxs("div",{className:"border-t px-4 py-3 flex justify-end gap-2 shrink-0 bg-white",children:[xe>0&&a.jsx(Y,{onClick:X,variant:"outline",children:"Retour"}),a.jsxs(Y,{type:"submit",form:U,disabled:T,children:[T?a.jsx(Qa,{}):null,le?"Soumettre":"Suivant"]})]})]})]})}}):a.jsx(a.Fragment,{children:a.jsx("div",{children:"Chargement..."})})})})})]}),e[35]=u?.id,e[36]=b,e[37]=T,e[38]=h,e[39]=r.ID_rentalapproval,e[40]=N,e[41]=ee):ee=e[41],ee};export{on as component};
